!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("jquery"));else if("function"==typeof define&&define.amd)define(["jquery"],e);else{var a="object"==typeof exports?e(require("jquery")):e(t.$);for(var r in a)("object"==typeof exports?exports:t)[r]=a[r]}}("undefined"!=typeof self?self:this,function(__WEBPACK_EXTERNAL_MODULE_19__){return function(t){var e={};function a(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=t,a.c=e,a.d=function(t,e,r){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=20)}([function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChartManager=void 0;var r=a(8),n=a(21),i=p(a(25)),s=p(a(18)),o=p(a(7)),l=p(a(2)),u=a(4),h=p(a(12)),c=p(a(6)),d=p(a(11)),f=p(a(10)),g=p(a(13)),_=a(5);function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}function m(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._dataSources={},this._dataSourceCache={},this._dataProviders={},this._frames={},this._areas={},this._timelines={},this._ranges={},this._plotters={},this._themes={},this._titles={},this._frameMousePos={},this._dsChartStyle={},this._dragStarted=!1,this._oldX=0,this._fakeIndicators={},this._captureMouseWheelDirectly=!0,this._chart={},this._chart.defaultFrame=new n.Chart,this._drawingTool=t.DrawingTool.CrossCursor,this._beforeDrawingTool=this._drawingTool,this._language="zh-cn",this._mainCanvas=null,this._overlayCanvas=null,this._mainContext=null,this._overlayContext=null,t.created||(t.instance=this,t.created=!0),t.instance}var e,a,p;return e=t,(a=[{key:"redraw",value:function(t,e){(void 0===t||e)&&(t="All"),"All"!==t&&"MainCanvas"!==t||(e&&this.getFrame("frame0").setChanged(!0),this.layout(this._mainContext,"frame0",0,0,this._mainCanvas.width,this._mainCanvas.height),this.drawMain("frame0",this._mainContext)),"All"!==t&&"OverlayCanvas"!==t||(this._overlayContext.clearRect(0,0,this._overlayCanvas.width,this._overlayCanvas.height),this.drawOverlay("frame0",this._overlayContext))}},{key:"bindCanvas",value:function(t,e){"main"===t?(this._mainCanvas=e,this._mainContext=e.getContext("2d")):"overlay"===t&&(this._overlayCanvas=e,this._overlayContext=e.getContext("2d"),this._captureMouseWheelDirectly&&$(this._overlayCanvas).bind("mousewheel",r.Control.mouseWheel))}},{key:"getCaptureMouseWheelDirectly",value:function(){return this._captureMouseWheelDirectly}},{key:"setCaptureMouseWheelDirectly",value:function(t){this._captureMouseWheelDirectly=t,t?$(this._overlayCanvas).bind("mousewheel",r.Control.mouseWheel):$(this._overlayCanvas).unbind("mousewheel")}},{key:"getChart",value:function(t){return this._chart.defaultFrame}},{key:"init",value:function(){delete this._ranges["frame0.k0.indic1"],delete this._ranges["frame0.k0.indic1Range"],delete this._areas["frame0.k0.indic1"],delete this._areas["frame0.k0.indic1Range"],o.DefaultTemplate.loadTemplate("frame0.k0",""),this.redraw("All",!0)}},{key:"setCurrentDrawingTool",value:function(e){this._drawingTool=t.DrawingTool[e],this.setRunningMode(this._drawingTool)}},{key:"getLanguage",value:function(){return this._language}},{key:"setLanguage",value:function(t){this._language=t}},{key:"setThemeName",value:function(t,e){var a;switch(void 0===e&&(e="Dark"),e){case"Light":a=new c.LightTheme;break;default:e="Dark",a=new c.DarkTheme}this._themeName=e,this.setTheme(t,a),this.getFrame(t).setChanged(!0)}},{key:"getChartStyle",value:function(t){var e=this._dsChartStyle[t];return void 0===e?"CandleStick":e}},{key:"setChartStyle",value:function(t,e){if(this._dsChartStyle[t]!==e){var a,r,n=t+".main",s=n+".main",o=n+".main";switch(e){case"CandleStick":case"CandleStickHLC":case"OHLC":switch(void 0!==(a=this.getDataProvider(s))&&_.Util.isInstance(a,h.MainDataProvider)||(a=new h.MainDataProvider(s),this.setDataProvider(s,a),a.updateData()),this.setMainIndicator(t,u.ChartSettings.get().charts.mIndic),e){case"CandleStick":r=new d.CandlestickPlotter(o);break;case"CandleStickHLC":r=new d.CandlestickHLCPlotter(o);break;case"OHLC":r=new d.OHLCPlotter(o)}this.setPlotter(o,r),r=new d.MinMaxPlotter(n+".decoration"),this.setPlotter(r.getName(),r);break;case"Line":a=new h.IndicatorDataProvider(s),this.setDataProvider(a.getName(),a),a.setIndicator(new i.HLCIndicator),this.removeMainIndicator(t),r=new d.IndicatorPlotter(o),this.setPlotter(o,r),this.removePlotter(n+".decoration")}this.getArea(r.getAreaName()).setChanged(!0),this._dsChartStyle[t]=e}}},{key:"setNormalMode",value:function(){this._drawingTool=this._beforeDrawingTool,$(".chart_dropdown_data").removeClass("chart_dropdown-hover"),$("#chart_toolpanel .chart_toolpanel_button").removeClass("selected"),$("#chart_CrossCursor").parent().addClass("selected"),this._drawingTool===t.DrawingTool.Cursor?(this.showCursor(),$("#mode a").removeClass("selected"),$("#chart_toolpanel .chart_toolpanel_button").removeClass("selected"),$("#chart_Cursor").parent().addClass("selected")):this.hideCursor()}},{key:"setRunningMode",value:function(e){var a=this.getDataSource("frame0.k0"),r=a.getCurrentToolObject();if(null!==r&&r.state!==f.CToolObject.state.AfterDraw&&a.delToolObject(),a.getToolObjectCount()>10)this.setNormalMode();else switch(this._drawingTool=e,e===t.DrawingTool.Cursor&&this.showCursor(),e){case t.DrawingTool.Cursor:this._beforeDrawingTool=e;break;case t.DrawingTool.ArrowLine:a.addToolObject(new f.CArrowLineObject("frame0.k0"));break;case t.DrawingTool.BandLine:a.addToolObject(new f.CBandLineObject("frame0.k0"));break;case t.DrawingTool.BiParallelLine:a.addToolObject(new f.CBiParallelLineObject("frame0.k0"));break;case t.DrawingTool.BiParallelRayLine:a.addToolObject(new f.CBiParallelRayLineObject("frame0.k0"));break;case t.DrawingTool.CrossCursor:this._beforeDrawingTool=e;break;case t.DrawingTool.DrawFibFans:a.addToolObject(new f.CFibFansObject("frame0.k0"));break;case t.DrawingTool.DrawFibRetrace:a.addToolObject(new f.CFibRetraceObject("frame0.k0"));break;case t.DrawingTool.DrawLines:a.addToolObject(new f.CStraightLineObject("frame0.k0"));break;case t.DrawingTool.HoriRayLine:a.addToolObject(new f.CHoriRayLineObject("frame0.k0"));break;case t.DrawingTool.HoriSegLine:a.addToolObject(new f.CHoriSegLineObject("frame0.k0"));break;case t.DrawingTool.HoriStraightLine:a.addToolObject(new f.CHoriStraightLineObject("frame0.k0"));break;case t.DrawingTool.PriceLine:a.addToolObject(new f.CPriceLineObject("frame0.k0"));break;case t.DrawingTool.RayLine:a.addToolObject(new f.CRayLineObject("frame0.k0"));break;case t.DrawingTool.SegLine:a.addToolObject(new f.CSegLineObject("frame0.k0"));break;case t.DrawingTool.StraightLine:a.addToolObject(new f.CStraightLineObject("frame0.k0"));break;case t.DrawingTool.TriParallelLine:a.addToolObject(new f.CTriParallelLineObject("frame0.k0"));break;case t.DrawingTool.VertiStraightLine:a.addToolObject(new f.CVertiStraightLineObject("frame0.k0"))}}},{key:"getTitle",value:function(t){return this._titles[t]}},{key:"setTitle",value:function(t,e){this._titles[t]=e}},{key:"setCurrentDataSource",value:function(t,e){var a=this.getCachedDataSource(e);void 0!==a&&null!==a?this.setDataSource(t,a,!0):(a=new l.MainDataSource(e),this.setDataSource(t,a,!0),this.setCachedDataSource(e,a))}},{key:"getDataSource",value:function(t){return this._dataSources[t]}},{key:"setDataSource",value:function(t,e,a){this._dataSources[t]=e,a&&this.updateData(t,null)}},{key:"getCachedDataSource",value:function(t){return this._dataSourceCache[t]}},{key:"setCachedDataSource",value:function(t,e){this._dataSourceCache[t]=e}},{key:"getDataProvider",value:function(t){return this._dataProviders[t]}},{key:"setDataProvider",value:function(t,e){this._dataProviders[t]=e}},{key:"removeDataProvider",value:function(t){delete this._dataProviders[t]}},{key:"getFrame",value:function(t){return this._frames[t]}},{key:"setFrame",value:function(t,e){this._frames[t]=e}},{key:"removeFrame",value:function(t){delete this._frames[t]}},{key:"getArea",value:function(t){return this._areas[t]}},{key:"setArea",value:function(t,e){this._areas[t]=e}},{key:"removeArea",value:function(t){delete this._areas[t]}},{key:"getTimeline",value:function(t){return this._timelines[t]}},{key:"setTimeline",value:function(t,e){this._timelines[t]=e}},{key:"removeTimeline",value:function(t){delete this._timelines[t]}},{key:"getRange",value:function(t){return this._ranges[t]}},{key:"setRange",value:function(t,e){this._ranges[t]=e}},{key:"removeRange",value:function(t){delete this._ranges[t]}},{key:"getPlotter",value:function(t){return this._plotters[t]}},{key:"setPlotter",value:function(t,e){this._plotters[t]=e}},{key:"removePlotter",value:function(t){delete this._plotters[t]}},{key:"getTheme",value:function(t){return this._themes[t]}},{key:"setTheme",value:function(t,e){this._themes[t]=e}},{key:"getFrameMousePos",value:function(t,e){void 0!==this._frameMousePos[t]?(e.x=this._frameMousePos[t].x,e.y=this._frameMousePos[t].y):(e.x=-1,e.y=-1)}},{key:"setFrameMousePos",value:function(t,e,a){this._frameMousePos[t]={x:e,y:a}}},{key:"drawArea",value:function(t,e,a){var r=e.getNameObject().getCompAt(2);if("timeline"===r){if(e.getHeight()<20)return}else if(e.getHeight()<30)return;if(!(e.getWidth()<30)){var n;r=e.getName();var i,s=a.length;for(i=0;i<s;i++)void 0!==(n=this._plotters[r+a[i]])&&n.Draw(t)}}},{key:"drawAreaMain",value:function(t,e){var a;a=this._dataSources[e.getDataSourceName()].getDataCount()<1?[".background"]:[".background",".grid",".main",".secondary"],this.drawArea(t,e,a),e.setChanged(!1)}},{key:"drawAreaOverlay",value:function(t,e){var a;a=this._dataSources[e.getDataSourceName()].getDataCount()<1?[".selection"]:[".decoration",".selection",".info",".tool"],this.drawArea(t,e,a)}},{key:"drawMain",value:function(t,e){var a;for(var r in this._areas)this._areas[r].getFrameName()!==t||_.Util.isInstance(this._areas[r],g.ChartAreaGroup)||this.drawAreaMain(e,this._areas[r]);for(var n in this._timelines)(a=this._timelines[n]).getFrameName()===t&&a.setUpdated(!1);for(var i in this._ranges)(a=this._ranges[i]).getFrameName()===t&&a.setUpdated(!1);for(var s in this._areas)(a=this._areas[s]).getFrameName()===t&&a.setChanged(!1)}},{key:"drawOverlay",value:function(t,e){for(var a in this._areas){var r=this._areas[a];_.Util.isInstance(r,g.ChartAreaGroup)&&r.getFrameName()===t&&r.drawGrid(e)}for(var n in this._areas){var i=this._areas[n];!1===_.Util.isInstance(i,g.ChartAreaGroup)&&i.getFrameName()===t&&this.drawAreaOverlay(e,i)}}},{key:"updateData",value:function(t,e){var a=this.getDataSource(t);if(void 0!==a&&null!==a){if(void 0!==e&&null!==e){if(!a.update(e))return!1;if(a.getUpdateMode()===l.DataSource.UpdateMode.DoNothing)return!0}else a.setUpdateMode(l.DataSource.UpdateMode.Refresh);var r=this.getTimeline(t);if(void 0!==r&&null!==r&&r.update(),a.getDataCount()<1)return!0;var n,i,s=[".main",".secondary"];for(var o in this._areas)if(n=this._areas[o],!_.Util.isInstance(n,g.ChartAreaGroup)&&n.getDataSourceName()===t){i=n.getName();for(var u=0;u<s.length;u++){var h=this.getDataProvider(i+s[u]);void 0!==h&&null!==h&&h.updateData()}}return!0}}},{key:"updateRange",value:function(t){if(!(this.getDataSource(t).getDataCount()<1)){var e,a,r=[".main",".secondary"];for(var n in this._areas)if(e=this._areas[n],!_.Util.isInstance(e,g.ChartAreaGroup)&&e.getDataSourceName()===t){a=e.getName();for(var i=0;i<r.length;i++){var s=this.getDataProvider(a+r[i]);void 0!==s&&null!==s&&s.updateRange()}var o=this.getTimeline(t);if(void 0!==o&&o.getMaxItemCount()>0){var l=this.getRange(a);void 0!==l&&null!==l&&l.update()}}}}},{key:"layout",value:function(t,e,a,r,n,i){var s=this.getFrame(e);for(var o in s.measure(t,n-a,i-r),s.layout(a,r,n,i),this._timelines){var l=this._timelines[o];l.getFrameName()===e&&l.onLayout()}for(var u in this._dataSources)u.substring(0,e.length)===e&&this.updateRange(u)}},{key:"SelectRange",value:function(t,e){for(var a in this._ranges){this._ranges[a].getAreaName()===t.getName()?this._ranges[a].selectAt(e):this._ranges[a].unselect()}}},{key:"scale",value:function(t){if(null!==this._highlightedFrame){var e=this._highlightedFrame.getHighlightedArea();if(void 0!==this.getRange(e.getName())){var a=e.getDataSourceName(),r=this.getTimeline(a);null!==r&&(r.scale(t),this.updateRange(a))}}}},{key:"showCursor",value:function(t){void 0===t&&(t="default"),this._mainCanvas.style.cursor=t,this._overlayCanvas.style.cursor=t}},{key:"hideCursor",value:function(){this._mainCanvas.style.cursor="none",this._overlayCanvas.style.cursor="none"}},{key:"showCrossCursor",value:function(t,e,a){var r=this.getRange(t.getName());return!(void 0===r||(r.selectAt(a),void 0===(r=this.getTimeline(t.getDataSourceName()))||!r.selectAt(e)))}},{key:"hideCrossCursor",value:function(t){if(null!==t&&void 0!==t)for(var e in this._timelines){var a=this._timelines[e];a!==t&&a.unselect()}else for(var r in this._timelines)this._timelines[r].unselect();for(var n in this._ranges)this._ranges[n].unselect()}},{key:"clearHighlight",value:function(){null!==this._highlightedFrame&&void 0!==this._highlightedFrame&&(this._highlightedFrame.highlight(null),this._highlightedFrame=null)}},{key:"onToolMouseMove",value:function(t,e,a){var r=!1;for(var n in t+=".",this._dataSources)if(0===n.indexOf(t)){var i=this._dataSources[n];_.Util.isInstance(i,l.MainDataSource)&&i.toolManager.acceptMouseMoveEvent(e,a)&&(r=!0)}return r}},{key:"onToolMouseDown",value:function(t,e,a){var r=!1;for(var n in t+=".",this._dataSources)if(0===n.indexOf(t)){var i=this._dataSources[n];_.Util.isInstance(i,l.MainDataSource)&&i.toolManager.acceptMouseDownEvent(e,a)&&(r=!0)}return r}},{key:"onToolMouseUp",value:function(t,e,a){var r=!1;for(var n in t+=".",this._dataSources)if(0===n.indexOf(t)){var i=this._dataSources[n];_.Util.isInstance(i,l.MainDataSource)&&i.toolManager.acceptMouseUpEvent(e,a)&&(r=!0)}return r}},{key:"onToolMouseDrag",value:function(t,e,a){var r=!1;for(var n in t+=".",this._dataSources)if(0===n.indexOf(t)){var i=this._dataSources[n];_.Util.isInstance(i,l.MainDataSource)&&i.toolManager.acceptMouseDownMoveEvent(e,a)&&(r=!0)}return r}},{key:"onMouseMove",value:function(t,e,a,r){var n=this.getFrame(t);if(void 0!==n)if(this.setFrameMousePos(t,e,a),this.hideCrossCursor(),this._highlightedFrame!==n&&this.clearHighlight(),null===this._capturingMouseArea||void 0===this._capturingMouseArea){var i,s,o=n.contains(e,a);if(null!==o)for(s=o.length-1;s>=0;s--)if(null!==(i=(i=o[s]).onMouseMove(e,a)))return void(_.Util.isInstance(i,g.ChartAreaGroup)||(n.highlight(i),this._highlightedFrame=n))}else this._capturingMouseArea.onMouseMove(e,a)}},{key:"onMouseLeave",value:function(t,e,a,r){void 0!==this.getFrame(t)&&(this.setFrameMousePos(t,e,a),this.hideCrossCursor(),this.clearHighlight(),null!==this._capturingMouseArea&&void 0!==this._capturingMouseArea&&(this._capturingMouseArea.onMouseLeave(e,a),this._capturingMouseArea=null),this._dragStarted=!1)}},{key:"onMouseDown",value:function(t,e,a){var r=this.getFrame(t);if(void 0!==r){var n,i,s=r.contains(e,a);if(null!==s)for(i=s.length-1;i>=0;i--)if(null!==(n=(n=s[i]).onMouseDown(e,a)))return void(this._capturingMouseArea=n)}}},{key:"onMouseUp",value:function(t,e,a){var n=this.getFrame(t);void 0!==n&&this._capturingMouseArea&&(null===this._capturingMouseArea.onMouseUp(e,a)&&!1===this._dragStarted&&(null!==this._selectedFrame&&void 0!==this._selectedFrame&&this._selectedFrame!==n&&this._selectedFrame.select(null),this._capturingMouseArea.isSelected()?(this._captureMouseWheelDirectly||$(this._overlayCanvas).unbind("mousewheel"),n.select(null),this._selectedFrame=null):(this._selectedFrame!==n&&(this._captureMouseWheelDirectly||$(this._overlayCanvas).bind("mousewheel",r.Control.mouseWheel)),n.select(this._capturingMouseArea),this._selectedFrame=n)),this._capturingMouseArea=null,this._dragStarted=!1)}},{key:"deleteToolObject",value:function(){var t=this.getDataSource("frame0.k0");null!==t.getSelectToolObjcet()&&t.delSelectToolObject();var e=t.getCurrentToolObject();null!==e&&e.getState()!==f.CToolObject.state.AfterDraw&&t.delToolObject(),this.setNormalMode()}},{key:"unloadTemplate",value:function(t){if(void 0!==this.getFrame(t)){for(var e in this._dataSources)e.match(t+".")&&delete this._dataSources[e];for(var a in this._dataProviders)this._dataProviders[a].getFrameName()===t&&delete this._dataProviders[a];for(var r in delete this._frames[t],this._areas)this._areas[r].getFrameName()===t&&delete this._areas[r];for(var n in this._timelines)this._timelines[n].getFrameName()===t&&delete this._timelines[n];for(var i in this._ranges)this._ranges[i].getFrameName()===t&&delete this._ranges[i];for(var s in this._plotters)this._plotters[s].getFrameName()===t&&delete this._plotters[s];delete this._themes[t],delete this._frameMousePos[t]}}},{key:"createIndicatorAndRange",value:function(t,e,a){var r,n;switch(e){case"MA":r=new i.MAIndicator,n=new s.PositiveRange(t);break;case"EMA":r=new i.EMAIndicator,n=new s.PositiveRange(t);break;case"VOLUME":r=new i.VOLUMEIndicator,n=new s.ZeroBasedPositiveRange(t);break;case"MACD":r=new i.MACDIndicator,n=new s.ZeroCenteredRange(t);break;case"DMI":r=new i.DMIIndicator,n=new s.PercentageRange(t);break;case"DMA":r=new i.DMAIndicator,n=new s.Range(t);break;case"TRIX":r=new i.TRIXIndicator,n=new s.Range(t);break;case"BRAR":r=new i.BRARIndicator,n=new s.Range(t);break;case"VR":r=new i.VRIndicator,n=new s.Range(t);break;case"OBV":r=new i.OBVIndicator,n=new s.Range(t);break;case"EMV":r=new i.EMVIndicator,n=new s.Range(t);break;case"RSI":r=new i.RSIIndicator,n=new s.PercentageRange(t);break;case"WR":r=new i.WRIndicator,n=new s.PercentageRange(t);break;case"SAR":r=new i.SARIndicator,n=new s.PositiveRange(t);break;case"KDJ":r=new i.KDJIndicator,n=new s.PercentageRange(t);break;case"ROC":r=new i.ROCIndicator,n=new s.Range(t);break;case"MTM":r=new i.MTMIndicator,n=new s.Range(t);break;case"BOLL":r=new i.BOLLIndicator,n=new s.Range(t);break;case"PSY":r=new i.PSYIndicator,n=new s.Range(t);break;case"StochRSI":r=new i.STOCHRSIIndicator,n=new s.PercentageRange(t);break;default:return null}return a||r.setParameters(u.ChartSettings.get().indics[e]),{indic:r,range:n}}},{key:"setMainIndicator",value:function(t,e){var a,r=t+".main",n=this.getDataProvider(r+".main");if(void 0===n||!_.Util.isInstance(n,h.MainDataProvider))return!1;switch(e){case"MA":a=new i.MAIndicator;break;case"EMA":a=new i.EMAIndicator;break;case"BOLL":a=new i.BOLLIndicator;break;case"SAR":a=new i.SARIndicator;break;default:return!1}a.setParameters(u.ChartSettings.get().indics[e]);var s=r+".secondary",o=this.getDataProvider(s);void 0===o&&(o=new h.IndicatorDataProvider(s),this.setDataProvider(o.getName(),o)),o.setIndicator(a);var l=this.getPlotter(s);return void 0===l&&(l=new d.IndicatorPlotter(s),this.setPlotter(l.getName(),l)),this.getArea(r).setChanged(!0),!0}},{key:"setIndicator",value:function(t,e){var a=this.getArea(t);if(null===a||void 0===a||"main"===a.getNameObject().getCompAt(2))return!1;var r=this.getDataProvider(t+".secondary");if(null===r||void 0===r||!_.Util.isInstance(r,h.IndicatorDataProvider))return!1;var n=this.createIndicatorAndRange(t,e);if(null===n||void 0===n)return!1;var s=n.indic,o=n.range;if(this.removeDataProvider(t+".main"),this.removePlotter(t+".main"),this.removeRange(t),this.removePlotter(t+"Range.decoration"),r.setIndicator(s),this.setRange(t,o),o.setPaddingTop(20),o.setPaddingBottom(4),o.setMinInterval(20),_.Util.isInstance(s,i.VOLUMEIndicator)){var l=new d.LastVolumePlotter(t+"Range.decoration");this.setPlotter(l.getName(),l)}else if(_.Util.isInstance(s,i.BOLLIndicator)||_.Util.isInstance(s,i.SARIndicator)){var u=new h.MainDataProvider(t+".main");this.setDataProvider(u.getName(),u),u.updateData();var c=new d.OHLCPlotter(t+".main");this.setPlotter(c.getName(),c)}return!0}},{key:"removeMainIndicator",value:function(t){var e=t+".main",a=e+".secondary",r=this.getDataProvider(a);void 0!==r&&_.Util.isInstance(r,h.IndicatorDataProvider)&&(this.removeDataProvider(a),this.removePlotter(a),this.getArea(e).setChanged(!0))}},{key:"removeIndicator",value:function(t){var e=this.getArea(t);if(void 0!==e&&"main"!==e.getNameObject().getCompAt(2)){var a=this.getDataProvider(t+".secondary");if(void 0!==a&&_.Util.isInstance(a,h.IndicatorDataProvider)){var r=t+"Range",n=this.getArea(r);if(void 0!==n){var i=this.getArea(e.getDataSourceName()+".charts");if(void 0!==i){for(var s in i.removeArea(e),this.removeArea(t),i.removeArea(n),this.removeArea(r),this._dataProviders)this._dataProviders[s].getAreaName()===t&&this.removeDataProvider(s);for(var o in this._ranges)this._ranges[o].getAreaName()===t&&this.removeRange(o);for(var l in this._plotters)this._plotters[l].getAreaName()===t&&this.removePlotter(l);for(var u in this._plotters)this._plotters[u].getAreaName()===r&&this.removePlotter(u)}}}}}},{key:"getIndicatorParameters",value:function(t){var e=this._fakeIndicators[t];if(void 0===e){var a=this.createIndicatorAndRange("",t);if(null===a)return null;this._fakeIndicators[t]=e=a.indic}var r,n=[],i=e.getParameterCount();for(r=0;r<i;r++)n.push(e.getParameterAt(r));return n}},{key:"setIndicatorParameters",value:function(t,e){var a,r;for(a in this._dataProviders){var n=this._dataProviders[a];!1!==_.Util.isInstance(n,h.IndicatorDataProvider)&&((r=n.getIndicator()).getName()===t&&(r.setParameters(e),n.refresh(),this.getArea(n.getAreaName()).setChanged(!0)))}if(void 0===(r=this._fakeIndicators[t])){var i=this.createIndicatorAndRange("",t,!0);if(null===i)return;this._fakeIndicators[t]=r=i.indic}r.setParameters(e)}},{key:"getIndicatorAreaName",value:function(t,e){var a=this.getArea(t+".charts"),r=a.getAreaCount()>>1;return e<0||e>=r?"":a.getAreaAt(e<<1).getName()}}])&&m(e.prototype,a),p&&m(e,p),t}();e.ChartManager=v,v.DrawingTool={Cursor:0,CrossCursor:1,DrawLines:2,DrawFibRetrace:3,DrawFibFans:4,SegLine:5,StraightLine:6,ArrowLine:7,RayLine:8,HoriStraightLine:9,HoriRayLine:10,HoriSegLine:11,VertiStraightLine:12,PriceLine:13,BiParallelLine:14,BiParallelRayLine:15,TriParallelLine:16,BandLine:17},v.created=!1,v.instance=null},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NamedObject=void 0;var r=a(15);function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._nameObj=new r.CName(e)}var e,a,i;return e=t,(a=[{key:"getFrameName",value:function(){return this._nameObj.getName(0)}},{key:"getDataSourceName",value:function(){return this._nameObj.getName(1)}},{key:"getAreaName",value:function(){return this._nameObj.getName(2)}},{key:"getName",value:function(){return this._nameObj.getName(-1)}},{key:"getNameObject",value:function(){return this._nameObj}},{key:"getRectCrossPt",value:function(t,e,a){var r={x:-1,y:-1},n={x:-1,y:-1},i=a.x-e.x,s=a.y-e.y;if(Math.abs(i)<2)return[r={x:e.x,y:t.top},n={x:a.x,y:t.bottom}];var o=s/i;return n.x=t.right,n.y=e.y+(t.right-e.x)*o,r.x=t.left,r.y=e.y+(t.left-e.x)*o,[r,n]}}])&&n(e.prototype,a),i&&n(e,i),t}();e.NamedObject=i},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MainDataSource=e.DataSource=void 0;var r,n=a(1),i=a(22),s=(r=a(3))&&r.__esModule?r:{default:r};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,a){return e&&u(t.prototype,e),a&&u(t,a),t}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){function e(t){return l(this,e),c(this,d(e).call(this,t))}return f(e,n.NamedObject),h(e,[{key:"getUpdateMode",value:function(){return this._updateMode}},{key:"setUpdateMode",value:function(t){this._updateMode=t}},{key:"getCacheSize",value:function(){return 0}},{key:"getDataCount",value:function(){return 0}},{key:"getDataAt",value:function(t){return this._dataItems[t]}}]),e}();e.DataSource=_,_.UpdateMode={DoNothing:0,Refresh:1,Update:2,Append:3};var p=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._erasedCount=0,a._dataItems=[],a._decimalDigits=0,a.toolManager=new i.CToolManager(t),a}return f(e,_),h(e,[{key:"getCacheSize",value:function(){return this._dataItems.length}},{key:"getDataCount",value:function(){return this._dataItems.length}},{key:"getUpdatedCount",value:function(){return this._updatedCount}},{key:"getAppendedCount",value:function(){return this._appendedCount}},{key:"getErasedCount",value:function(){return this._erasedCount}},{key:"getDecimalDigits",value:function(){return this._decimalDigits}},{key:"calcDecimalDigits",value:function(t){var e=""+t,a=e.indexOf(".");return a<0?0:e.length-1-a}},{key:"getLastDate",value:function(){var t=this.getDataCount();return t<1?-1:this.getDataAt(t-1).date}},{key:"getDataAt",value:function(t){return this._dataItems[t]}},{key:"update",value:function(t){this._updatedCount=0,this._appendedCount=0,this._erasedCount=0;var e=this._dataItems.length;if(e>0){var a,r,n=e-1,i=this._dataItems[n],o=t.length;for(r=0;r<o;r++)if((a=t[r])[0]===i.date){if(i.open===a[1]&&i.high===a[2]&&i.low===a[3]&&i.close===a[4]&&i.volume===a[5]?this.setUpdateMode(_.UpdateMode.DoNothing):(this.setUpdateMode(_.UpdateMode.Update),this._dataItems[n]={date:a[0],open:a[1],high:a[2],low:a[3],close:a[4],volume:a[5]},this._updatedCount++),++r<o)for(this.setUpdateMode(_.UpdateMode.Append);r<o;r++,this._appendedCount++)a=t[r],this._dataItems.push({date:a[0],open:a[1],high:a[2],low:a[3],close:a[4],volume:a[5]});return!0}if(o<s.default.instance.limit)return this.setUpdateMode(_.UpdateMode.DoNothing),!1}this.setUpdateMode(_.UpdateMode.Refresh),this._dataItems=[];var l,u,h,c,d=t.length;for(c=0;c<d;c++){for(h=t[c],u=1;u<=4;u++)l=this.calcDecimalDigits(h[u]),this._decimalDigits<l&&(this._decimalDigits=l);this._dataItems.push({date:h[0],open:h[1],high:h[2],low:h[3],close:h[4],volume:h[5]})}return!0}},{key:"select",value:function(t){this.toolManager.selecedObject=t}},{key:"unselect",value:function(){this.toolManager.selecedObject=-1}},{key:"addToolObject",value:function(t){this.toolManager.addToolObject(t)}},{key:"delToolObject",value:function(){this.toolManager.delCurrentObject()}},{key:"getToolObject",value:function(t){return this.toolManager.getToolObject(t)}},{key:"getToolObjectCount",value:function(){return this.toolManager.toolObjects.length}},{key:"getCurrentToolObject",value:function(){return this.toolManager.getCurrentObject()}},{key:"getSelectToolObjcet",value:function(){return this.toolManager.getSelectedObject()}},{key:"delSelectToolObject",value:function(){this.toolManager.delSelectedObject()}}]),e}();e.MainDataSource=p},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(8),n=a(14),i=a(0),s=a(4),o=a(7),l=h(a(26)),u=h(a(19));function h(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function t(e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element="#kline_container",this.chartMgr=null,this.G_HTTP_REQUEST=null,this.timer=null,this.buttonDown=!1,this.init=!1,this.requestParam="",this.data={},this.width=1200,this.height=650,this.symbol="",this.symbolName="",this.range=null,this.url="",this.limit=1e3,this.type="poll",this.subscribePath="",this.sendPath="",this.stompClient=null,this.intervalTime=5e3,this.debug=!0,this.language="zh-cn",this.theme="dark",this.ranges=["1w","1d","1h","30m","15m","5m","1m","line"],this.showTrade=!0,this.tradeWidth=250,this.socketConnected=!1,this.reverseColor=!1,this.isSized=!1,this.paused=!1,this.subscribed=null,this.periodMap={"01w":6048e5,"03d":2592e5,"01d":864e5,"12h":432e5,"06h":216e5,"04h":144e5,"02h":72e5,"01h":36e5,"30m":18e5,"15m":9e5,"05m":3e5,"03m":18e4,"01m":6e4,line:6e4},this.tagMapPeriod={"1w":"01w","3d":"03d","1d":"01d","12h":"12h","6h":"06h","4h":"04h","2h":"02h","1h":"01h","30m":"30m","15m":"15m","5m":"05m","3m":"03m","1m":"01m",line:"line"},Object.assign(this,e),t.created||(t.instance=this,t.created=!0),t.instance}var e,a,h;return e=t,(a=[{key:"draw",value:function(){t.trade=new n.KlineTrade,t.chartMgr=new i.ChartManager;var e=u.default.parseHTML(l.default);for(var a in this.ranges){(0,u.default)(e).find('[name="'+this.ranges[a]+'"]').each(function(t,e){(0,u.default)(e).attr("style","display:inline-block")})}(0,u.default)(this.element).html(e),setInterval(r.Control.refreshFunction,this.intervalTime),"stomp"===this.type&&r.Control.socketConnect(),this.registerMouseEvent(),i.ChartManager.instance.bindCanvas("main",document.getElementById("chart_mainCanvas")),i.ChartManager.instance.bindCanvas("overlay",document.getElementById("chart_overlayCanvas")),r.Control.refreshTemplate(),r.Control.onSize(this.width,this.height),r.Control.readCookie(),this.setTheme(this.theme),this.setLanguage(this.language),(0,u.default)(this.element).css({visibility:"visible"})}},{key:"resize",value:function(t,e){this.width=t,this.height=e,r.Control.onSize(this.width,this.height)}},{key:"setSymbol",value:function(t,e){this.symbol=t,this.symbolName=e,r.Control.switchSymbol(t),this.onSymbolChange(t,e)}},{key:"setTheme",value:function(t){this.theme=t,r.Control.switchTheme(t)}},{key:"setLanguage",value:function(t){this.language=t,r.Control.chartSwitchLanguage(t)}},{key:"setShowTrade",value:function(t){this.showTrade=t,t?(0,u.default)(".trade_container").show():(0,u.default)(".trade_container").hide(),r.Control.onSize(this.width,this.height)}},{key:"toggleTrade",value:function(){this.showTrade?(this.showTrade=!1,(0,u.default)(".trade_container").hide()):(this.showTrade=!0,(0,u.default)(".trade_container").show()),r.Control.onSize(this.width,this.height)}},{key:"setIntervalTime",value:function(t){this.intervalTime=t,this.debug&&console.log("DEBUG: interval time changed to "+t)}},{key:"pause",value:function(){this.debug&&console.log("DEBUG: kline paused"),this.paused=!0}},{key:"resend",value:function(){this.debug&&console.log("DEBUG: kline continue"),this.paused=!1,r.Control.requestData(!0)}},{key:"connect",value:function(){"stomp"===this.type?r.Control.socketConnect():this.debug&&console.log("DEBUG: this is for stomp type")}},{key:"disconnect",value:function(){"stomp"===this.type?(this.stompClient&&(this.stompClient.disconnect(),this.socketConnected=!1),this.debug&&console.log("DEBUG: socket disconnected")):this.debug&&console.log("DEBUG: this is for stomp type")}},{key:"onResize",value:function(t,e){this.debug&&console.log("DEBUG: chart resized to width: "+t+" height: "+e)}},{key:"onLangChange",value:function(t){this.debug&&console.log("DEBUG: language changed to "+t)}},{key:"onSymbolChange",value:function(t,e){this.debug&&console.log("DEBUG: symbol changed to "+t+" "+e)}},{key:"onThemeChange",value:function(t){this.debug&&console.log("DEBUG: themes changed to : "+t)}},{key:"onRangeChange",value:function(t){this.debug&&console.log("DEBUG: range changed to "+t)}},{key:"registerMouseEvent",value:function(){(0,u.default)(document).ready(function(){(0,u.default)("#chart_overlayCanvas").bind("contextmenu",function(t){return t.cancelBubble=!0,t.returnValue=!1,t.preventDefault(),t.stopPropagation(),!1}),(0,u.default)(".chart_container .chart_dropdown .chart_dropdown_t").mouseover(function(){var t=(0,u.default)(".chart_container"),e=(0,u.default)(this),a=e.next(),r=t.offset().left,n=e.offset().left,i=t.width(),s=e.width(),o=(a.width()-s)/2<<0;n-o<r+4?o=n-r-4:o+=n+s+o>r+i-4?n+s+o-(r+i-4)+19:4,a.css({"margin-left":-o}),e.addClass("chart_dropdown-hover"),a.addClass("chart_dropdown-hover")}).mouseout(function(){(0,u.default)(this).next().removeClass("chart_dropdown-hover"),(0,u.default)(this).removeClass("chart_dropdown-hover")}),(0,u.default)(".chart_dropdown_data").mouseover(function(){(0,u.default)(this).addClass("chart_dropdown-hover"),(0,u.default)(this).prev().addClass("chart_dropdown-hover")}).mouseout(function(){(0,u.default)(this).prev().removeClass("chart_dropdown-hover"),(0,u.default)(this).removeClass("chart_dropdown-hover")}),(0,u.default)("#chart_btn_parameter_settings").click(function(){(0,u.default)("#chart_parameter_settings").addClass("clicked"),(0,u.default)(".chart_dropdown_data").removeClass("chart_dropdown-hover"),(0,u.default)("#chart_parameter_settings").find("th").each(function(){var t=(0,u.default)(this).html(),e=0,a=s.ChartSettings.get().indics[t];(0,u.default)(this.nextElementSibling).find("input").each(function(){null!==a&&e<a.length&&(0,u.default)(this).val(a[e]),e++})})}),(0,u.default)("#close_settings").click(function(){(0,u.default)("#chart_parameter_settings").removeClass("clicked")}),(0,u.default)(".chart_container .chart_toolbar_tabgroup a").click(function(){r.Control.switchPeriod((0,u.default)(this).parent().attr("name"))}),(0,u.default)("#chart_toolbar_periods_vert ul a").click(function(){r.Control.switchPeriod((0,u.default)(this).parent().attr("name"))}),(0,u.default)(".market_chooser ul a").click(function(){r.Control.switchSymbol((0,u.default)(this).attr("name"))}),(0,u.default)("#chart_show_tools").click(function(){(0,u.default)(this).hasClass("selected")?r.Control.switchTools("off"):r.Control.switchTools("on")}),(0,u.default)("#chart_toolpanel .chart_toolpanel_button").click(function(){(0,u.default)(".chart_dropdown_data").removeClass("chart_dropdown-hover"),(0,u.default)("#chart_toolpanel .chart_toolpanel_button").removeClass("selected"),(0,u.default)(this).addClass("selected");var e=(0,u.default)(this).children().attr("name");t.instance.chartMgr.setRunningMode(i.ChartManager.DrawingTool[e])}),(0,u.default)("#chart_show_indicator").click(function(){(0,u.default)(this).hasClass("selected")?r.Control.switchIndic("off"):r.Control.switchIndic("on")}),(0,u.default)("#chart_tabbar li a").click(function(){(0,u.default)("#chart_tabbar li a").removeClass("selected"),(0,u.default)(this).addClass("selected");var t=(0,u.default)(this).attr("name");s.ChartSettings.get().charts.indics[1]=t,s.ChartSettings.save(),!1===o.Template.displayVolume?i.ChartManager.instance.getChart().setIndicator(1,t):i.ChartManager.instance.getChart().setIndicator(2,t)}),(0,u.default)("#chart_select_chart_style a").click(function(){(0,u.default)("#chart_select_chart_style a").removeClass("selected"),(0,u.default)(this).addClass("selected"),s.ChartSettings.get().charts.chartStyle=(0,u.default)(this)[0].innerHTML,s.ChartSettings.save();var t=i.ChartManager.instance;t.setChartStyle("frame0.k0",(0,u.default)(this).html()),t.redraw()}),(0,u.default)("#chart_dropdown_themes li").click(function(){(0,u.default)("#chart_dropdown_themes li a").removeClass("selected");var t=(0,u.default)(this).attr("name");"chart_themes_dark"===t?r.Control.switchTheme("dark"):"chart_themes_light"===t&&r.Control.switchTheme("light")}),(0,u.default)("#chart_select_main_indicator a").click(function(){(0,u.default)("#chart_select_main_indicator a").removeClass("selected"),(0,u.default)(this).addClass("selected");var t=(0,u.default)(this).attr("name");s.ChartSettings.get().charts.mIndic=t,s.ChartSettings.save();var e=i.ChartManager.instance;e.setMainIndicator("frame0.k0",t)||e.removeMainIndicator("frame0.k0"),e.redraw()}),(0,u.default)("#chart_toolbar_theme a").click(function(){(0,u.default)("#chart_toolbar_theme a").removeClass("selected"),"dark"===(0,u.default)(this).attr("name")?r.Control.switchTheme("dark"):"light"===(0,u.default)(this).attr("name")&&r.Control.switchTheme("light")}),(0,u.default)("#chart_select_theme li a").click(function(){(0,u.default)("#chart_select_theme a").removeClass("selected"),"dark"===(0,u.default)(this).attr("name")?r.Control.switchTheme("dark"):"light"===(0,u.default)(this).attr("name")&&r.Control.switchTheme("light")}),(0,u.default)("#chart_enable_tools li a").click(function(){(0,u.default)("#chart_enable_tools a").removeClass("selected"),"on"===(0,u.default)(this).attr("name")?r.Control.switchTools("on"):"off"===(0,u.default)(this).attr("name")&&r.Control.switchTools("off")}),(0,u.default)("#chart_enable_indicator li a").click(function(){(0,u.default)("#chart_enable_indicator a").removeClass("selected"),"on"===(0,u.default)(this).attr("name")?r.Control.switchIndic("on"):"off"===(0,u.default)(this).attr("name")&&r.Control.switchIndic("off")}),(0,u.default)("#chart_language_setting_div li a").click(function(){(0,u.default)("#chart_language_setting_div a").removeClass("selected"),"zh-cn"===(0,u.default)(this).attr("name")?r.Control.chartSwitchLanguage("zh-cn"):"en-us"===(0,u.default)(this).attr("name")?r.Control.chartSwitchLanguage("en-us"):"zh-tw"===(0,u.default)(this).attr("name")&&r.Control.chartSwitchLanguage("zh-tw")}),(0,u.default)(document).keyup(function(t){46===t.keyCode&&(i.ChartManager.instance.deleteToolObject(),i.ChartManager.instance.redraw("OverlayCanvas",!1))}),(0,u.default)("#clearCanvas").click(function(){for(var t=i.ChartManager.instance.getDataSource("frame0.k0"),e=t.getToolObjectCount(),a=0;a<e;a++)t.delToolObject();i.ChartManager.instance.redraw("OverlayCanvas",!1)}),(0,u.default)("#chart_overlayCanvas").mousemove(function(e){var a=e.target.getBoundingClientRect(),r=e.clientX-a.left,n=e.clientY-a.top,s=i.ChartManager.instance;!0===t.instance.buttonDown?(s.onMouseMove("frame0",r,n,!0),s.redraw("All",!1)):(s.onMouseMove("frame0",r,n,!1),s.redraw("OverlayCanvas"))}).mouseleave(function(t){var e=t.target.getBoundingClientRect(),a=t.clientX-e.left,r=t.clientY-e.top,n=i.ChartManager.instance;n.onMouseLeave("frame0",a,r,!1),n.redraw("OverlayCanvas")}).mouseup(function(e){if(1===e.which){t.instance.buttonDown=!1;var a=e.target.getBoundingClientRect(),r=e.clientX-a.left,n=e.clientY-a.top,s=i.ChartManager.instance;s.onMouseUp("frame0",r,n),s.redraw("All")}}).mousedown(function(e){if(1!==e.which)return i.ChartManager.instance.deleteToolObject(),void i.ChartManager.instance.redraw("OverlayCanvas",!1);t.instance.buttonDown=!0;var a=e.target.getBoundingClientRect(),r=e.clientX-a.left,n=e.clientY-a.top;i.ChartManager.instance.onMouseDown("frame0",r,n)}),(0,u.default)("#chart_parameter_settings :input").change(function(){var t=(0,u.default)(this).attr("name"),e=0,a=[],r=i.ChartManager.instance;if((0,u.default)("#chart_parameter_settings :input").each(function(){if((0,u.default)(this).attr("name")===t){if(""!==(0,u.default)(this).val()&&null!==(0,u.default)(this).val()&&void 0!==(0,u.default)(this).val()){var r=parseInt((0,u.default)(this).val());a.push(r)}e++}}),0!==a.length){r.setIndicatorParameters(t,a);var n=r.getIndicatorParameters(t),o=[];e=0,(0,u.default)("#chart_parameter_settings :input").each(function(){(0,u.default)(this).attr("name")===t&&(""!==(0,u.default)(this).val()&&null!==(0,u.default)(this).val()&&void 0!==(0,u.default)(this).val()&&((0,u.default)(this).val(n[e].getValue()),o.push(n[e].getValue())),e++)}),s.ChartSettings.get().indics[t]=o,s.ChartSettings.save(),r.redraw("All",!1)}}),(0,u.default)("#chart_parameter_settings button").click(function(){var t=(0,u.default)(this).parents("tr").children("th").html(),e=0,a=i.ChartManager.instance.getIndicatorParameters(t),r=[];(0,u.default)(this).parent().prev().children("input").each(function(){null!==a&&e<a.length&&((0,u.default)(this).val(a[e].getDefaultValue()),r.push(a[e].getDefaultValue())),e++}),i.ChartManager.instance.setIndicatorParameters(t,r),s.ChartSettings.get().indics[t]=r,s.ChartSettings.save(),i.ChartManager.instance.redraw("All",!1)}),(0,u.default)("body").on("click","#sizeIcon",function(){t.instance.isSized=!t.instance.isSized,t.instance.isSized?((0,u.default)(t.instance.element).css({position:"fixed",left:"0",right:"0",top:"0",bottom:"0",width:"100%",height:"100%",zIndex:"10000"}),r.Control.onSize(),(0,u.default)("html,body").css({width:"100%",height:"100%",overflow:"hidden"})):((0,u.default)(t.instance.element).attr("style",""),(0,u.default)("html,body").attr("style",""),r.Control.onSize(t.instance.width,t.instance.height),(0,u.default)(t.instance.element).css({visibility:"visible",height:t.instance.height+"px"}))})})}}])&&c(e.prototype,a),h&&c(e,h),t}();e.default=d,d.created=!1,d.instance=null},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChartSettings=void 0;var r=a(0);function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,a,i;return e=t,i=[{key:"checkVersion",value:function(){if(t._data.ver<2){t._data.ver=2;var e=t._data.charts;e.period_weight={},e.period_weight.line=8,e.period_weight["1min"]=7,e.period_weight["5min"]=6,e.period_weight["15min"]=5,e.period_weight["30min"]=4,e.period_weight["1hour"]=3,e.period_weight["1day"]=2,e.period_weight["1week"]=1,e.period_weight["3min"]=0,e.period_weight["2hour"]=0,e.period_weight["4hour"]=0,e.period_weight["6hour"]=0,e.period_weight["12hour"]=0,e.period_weight["3day"]=0}t._data.ver<3&&(t._data.ver=3,t._data.charts.areaHeight=[])}},{key:"get",value:function(){return void 0===t._data&&(t.init(),t.load(),t.checkVersion()),t._data}},{key:"init",value:function(){for(var e={},a=["MA","EMA","VOLUME","MACD","KDJ","StochRSI","RSI","DMI","OBV","BOLL","DMA","TRIX","BRAR","VR","EMV","WR","ROC","MTM","PSY"],n=0;n<a.length;n++){var i=r.ChartManager.instance.createIndicatorAndRange("",a[n],!0);if(null!==i){e[a[n]]=[];for(var s=i.indic.getParameters(),o=0;o<s.length;o++)e[a[n]].push(s[o])}}var l={chartStyle:"CandleStick",mIndic:"MA",indics:["VOLUME","MACD"],indicsStatus:"open",period:"15m"};t._data={ver:1,charts:l,indics:e,theme:"Dark"},t.checkVersion()}},{key:"load",value:function(){if(!(document.cookie.length<=0)){var e=document.cookie.indexOf("chartSettings=");if(!(e<0)){e+="chartSettings=".length;var a=document.cookie.indexOf(";",e);a<0&&(a=document.cookie.length);var r=unescape(document.cookie.substring(e,a));t._data=JSON.parse(r)}}}},{key:"save",value:function(){var e=new Date;e.setDate(e.getDate()+2),document.cookie="chartSettings="+escape(JSON.stringify(t._data))+";expires="+e.toGMTString()}}],(a=null)&&n(e.prototype,a),i&&n(e,i),t}();e.ChartSettings=i},function(t,e,a){"use strict";function r(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.Util=void 0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,a,n;return e=t,n=[{key:"fromFloat",value:function(t,e){for(var a=t.toFixed(e),r=a.length-1;r>=0;r--){if("."===a[r])return a.substring(0,r);if("0"!==a[r])return a.substring(0,r+1)}}},{key:"formatTime",value:function(t){return t<10?"0"+t.toString():t.toString()}},{key:"isInstance",value:function(t,e){return null!==t&&void 0!==t&&t instanceof e}}],(a=null)&&r(e.prototype,a),n&&r(e,n),t}();e.Util=n},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LightTheme=e.DarkTheme=e.Theme=void 0;var r,n=(r=a(3))&&r.__esModule?r:{default:r};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function t(){h(this,t),this.getFont=function(t){return this._fonts[t]}}var e,a,r;return e=t,(a=[{key:"getColor",value:function(t){return this._colors[t]}}])&&c(e.prototype,a),r&&c(e,r),t}();e.Theme=d,d.theme_color_id=0,d.theme_font_id=0,d.Color={Positive:d.theme_color_id++,Negative:d.theme_color_id++,PositiveDark:d.theme_color_id++,NegativeDark:d.theme_color_id++,Unchanged:d.theme_color_id++,Background:d.theme_color_id++,Cursor:d.theme_color_id++,RangeMark:d.theme_color_id++,Indicator0:d.theme_color_id++,Indicator1:d.theme_color_id++,Indicator2:d.theme_color_id++,Indicator3:d.theme_color_id++,Indicator4:d.theme_color_id++,Indicator5:d.theme_color_id++,Grid0:d.theme_color_id++,Grid1:d.theme_color_id++,Grid2:d.theme_color_id++,Grid3:d.theme_color_id++,Grid4:d.theme_color_id++,TextPositive:d.theme_color_id++,TextNegative:d.theme_color_id++,Text0:d.theme_color_id++,Text1:d.theme_color_id++,Text2:d.theme_color_id++,Text3:d.theme_color_id++,Text4:d.theme_color_id++,LineColorNormal:d.theme_color_id++,LineColorSelected:d.theme_color_id++,CircleColorFill:d.theme_color_id++,CircleColorStroke:d.theme_color_id++},d.Font={Default:d.theme_font_id++};var f=function(t){function e(){var t;return h(this,e),(t=s(this,o(e).call(this)))._colors=[],n.default.instance.reverseColor?(t._colors[d.Color.Positive]="#990e0e",t._colors[d.Color.Negative]="#19b34c",t._colors[d.Color.PositiveDark]="#3b0e08",t._colors[d.Color.NegativeDark]="#004718"):(t._colors[d.Color.Positive]="#19b34c",t._colors[d.Color.Negative]="#990e0e",t._colors[d.Color.PositiveDark]="#004718",t._colors[d.Color.NegativeDark]="#3b0e08"),t._colors[d.Color.Unchanged]="#fff",t._colors[d.Color.Background]="#0a0a0a",t._colors[d.Color.Cursor]="#aaa",t._colors[d.Color.RangeMark]="#f9ee30",t._colors[d.Color.Indicator0]="#ddd",t._colors[d.Color.Indicator1]="#f9ee30",t._colors[d.Color.Indicator2]="#f600ff",t._colors[d.Color.Indicator3]="#6bf",t._colors[d.Color.Indicator4]="#a5cf81",t._colors[d.Color.Indicator5]="#e18b89",t._colors[d.Color.Grid0]="#333",t._colors[d.Color.Grid1]="#444",t._colors[d.Color.Grid2]="#666",t._colors[d.Color.Grid3]="#888",t._colors[d.Color.Grid4]="#aaa",t._colors[d.Color.TextPositive]="#1bd357",t._colors[d.Color.TextNegative]="#ff6f5e",t._colors[d.Color.Text0]="#444",t._colors[d.Color.Text1]="#666",t._colors[d.Color.Text2]="#888",t._colors[d.Color.Text3]="#aaa",t._colors[d.Color.Text4]="#ccc",t._colors[d.Color.LineColorNormal]="#a6a6a6",t._colors[d.Color.LineColorSelected]="#ffffff",t._colors[d.Color.CircleColorFill]="#000000",t._colors[d.Color.CircleColorStroke]="#ffffff",t._fonts=[],t._fonts[d.Font.Default]="12px Tahoma",t}return l(e,d),e}();e.DarkTheme=f;var g=function(t){function e(){var t;return h(this,e),(t=s(this,o(e).call(this)))._colors=[],n.default.instance.reverseColor?(t._colors[d.Color.Positive]="#db5542",t._colors[d.Color.Negative]="#53b37b",t._colors[d.Color.PositiveDark]="#ffadaa",t._colors[d.Color.NegativeDark]="#66d293"):(t._colors[d.Color.Positive]="#53b37b",t._colors[d.Color.Negative]="#db5542",t._colors[d.Color.PositiveDark]="#66d293",t._colors[d.Color.NegativeDark]="#ffadaa"),t._colors[d.Color.Unchanged]="#fff",t._colors[d.Color.Background]="#fff",t._colors[d.Color.Cursor]="#aaa",t._colors[d.Color.RangeMark]="#f27935",t._colors[d.Color.Indicator0]="#2fd2b2",t._colors[d.Color.Indicator1]="#ffb400",t._colors[d.Color.Indicator2]="#e849b9",t._colors[d.Color.Indicator3]="#1478c8",t._colors[d.Color.Grid0]="#eee",t._colors[d.Color.Grid1]="#afb1b3",t._colors[d.Color.Grid2]="#ccc",t._colors[d.Color.Grid3]="#bbb",t._colors[d.Color.Grid4]="#aaa",t._colors[d.Color.TextPositive]="#53b37b",t._colors[d.Color.TextNegative]="#db5542",t._colors[d.Color.Text0]="#ccc",t._colors[d.Color.Text1]="#aaa",t._colors[d.Color.Text2]="#888",t._colors[d.Color.Text3]="#666",t._colors[d.Color.Text4]="#444",t._colors[d.Color.LineColorNormal]="#8c8c8c",t._colors[d.Color.LineColorSelected]="#393c40",t._colors[d.Color.CircleColorFill]="#ffffff",t._colors[d.Color.CircleColorStroke]="#393c40",t._fonts=[],t._fonts[d.Font.Default]="12px Tahoma",t}return l(e,d),e}();e.LightTheme=g},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateMeasuringHandler=e.DefaultTemplate=e.Template=void 0;var r=a(0),n=a(4),i=g(a(2)),s=g(a(12)),o=g(a(13)),l=g(a(11)),u=a(23),h=a(15),c=g(a(24)),d=g(a(6)),f=g(a(18));function g(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,e,a){return e&&w(t.prototype,e),a&&w(t,a),t}var C=function(){function t(){y(this,t)}return x(t,null,[{key:"createCandlestickDataSource",value:function(t){return new i.MainDataSource(t)}},{key:"createDataSource",value:function(t,e,a){var n=r.ChartManager.instance;null===n.getCachedDataSource(e)&&n.setCachedDataSource(e,a(e)),n.setCurrentDataSource(t,e),n.updateData(t,null)}},{key:"createTableComps",value:function(t){this.createMainChartComps(t),this.displayVolume&&this.createIndicatorChartComps(t,"VOLUME"),this.createTimelineComps(t)}},{key:"createMainChartComps",value:function(t){var e=r.ChartManager.instance,a=e.getArea(t+".charts"),n=t+".main",i=n+"Range",u=new o.MainArea(n);e.setArea(n,u),a.addArea(u);var h=new o.MainRangeArea(i);e.setArea(i,h),a.addArea(h);var c=new s.MainDataProvider(n+".main");e.setDataProvider(c.getName(),c),e.setMainIndicator(t,"MA");var d=new f.MainRange(n);e.setRange(d.getName(),d),d.setPaddingTop(28),d.setPaddingBottom(12);var g=new l.MainAreaBackgroundPlotter(n+".background");e.setPlotter(g.getName(),g),g=new l.CGridPlotter(n+".grid"),e.setPlotter(g.getName(),g),g=new l.CandlestickPlotter(n+".main"),e.setPlotter(g.getName(),g),g=new l.MinMaxPlotter(n+".decoration"),e.setPlotter(g.getName(),g),g=new l.MainInfoPlotter(n+".info"),e.setPlotter(g.getName(),g),g=new l.SelectionPlotter(n+".selection"),e.setPlotter(g.getName(),g),g=new l.CDynamicLinePlotter(n+".tool"),e.setPlotter(g.getName(),g),g=new l.RangeAreaBackgroundPlotter(n+"Range.background"),e.setPlotter(g.getName(),g),g=new l.COrderGraphPlotter(n+"Range.grid"),e.setPlotter(g.getName(),g),g=new l.RangePlotter(n+"Range.main"),e.setPlotter(g.getName(),g),g=new l.RangeSelectionPlotter(n+"Range.selection"),e.setPlotter(g.getName(),g),g=new l.LastClosePlotter(n+"Range.decoration"),e.setPlotter(g.getName(),g)}},{key:"createIndicatorChartComps",value:function(t,e){var a=r.ChartManager.instance,i=a.getArea(t+".charts"),u=t+".indic"+i.getNextRowId(),h=u+"Range",c=new o.IndicatorArea(u);a.setArea(u,c),i.addArea(c);var d=i.getAreaCount()>>1,f=n.ChartSettings.get().charts.areaHeight;if(f.length>d){var g,_;for(_=0;_<d;_++)(g=i.getAreaAt(_<<1)).setTop(0),g.setBottom(f[_]);c.setTop(0),c.setBottom(f[d])}var p=new o.IndicatorRangeArea(h);a.setArea(h,p),i.addArea(p);var m=new s.IndicatorDataProvider(u+".secondary");if(a.setDataProvider(m.getName(),m),!1!==a.setIndicator(u,e)){var v=new l.MainAreaBackgroundPlotter(u+".background");a.setPlotter(v.getName(),v),v=new l.CGridPlotter(u+".grid"),a.setPlotter(v.getName(),v),v=new l.IndicatorPlotter(u+".secondary"),a.setPlotter(v.getName(),v),v=new l.IndicatorInfoPlotter(u+".info"),a.setPlotter(v.getName(),v),v=new l.SelectionPlotter(u+".selection"),a.setPlotter(v.getName(),v),v=new l.RangeAreaBackgroundPlotter(u+"Range.background"),a.setPlotter(v.getName(),v),v=new l.RangePlotter(u+"Range.main"),a.setPlotter(v.getName(),v),v=new l.RangeSelectionPlotter(u+"Range.selection"),a.setPlotter(v.getName(),v)}else a.removeIndicator(u)}},{key:"createTimelineComps",value:function(t){var e,a=r.ChartManager.instance,n=new u.Timeline(t);a.setTimeline(n.getName(),n),e=new l.TimelineAreaBackgroundPlotter(t+".timeline.background"),a.setPlotter(e.getName(),e),e=new l.TimelinePlotter(t+".timeline.main"),a.setPlotter(e.getName(),e),e=new l.TimelineSelectionPlotter(t+".timeline.selection"),a.setPlotter(e.getName(),e)}},{key:"createLiveOrderComps",value:function(t){var e,a=r.ChartManager.instance;e=new l.BackgroundPlotter(t+".main.background"),a.setPlotter(e.getName(),e),e=new l.CLiveOrderPlotter(t+".main.main"),a.setPlotter(e.getName(),e)}},{key:"createLiveTradeComps",value:function(t){var e,a=r.ChartManager.instance;e=new l.BackgroundPlotter(t+".main.background"),a.setPlotter(e.getName(),e),e=new l.CLiveTradePlotter(t+".main.main"),a.setPlotter(e.getName(),e)}}]),t}();e.Template=C,C.displayVolume=!0;var b=function(t){function e(){return y(this,e),p(this,m(e).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(e,C),x(e,null,[{key:"loadTemplate",value:function(t,e){var a=r.ChartManager.instance,i=n.ChartSettings.get(),s=new h.CName(t).getCompAt(0);a.unloadTemplate(s),this.createDataSource(t,e,this.createCandlestickDataSource);var l=new c.DockableLayout(s);a.setFrame(l.getName(),l),a.setArea(l.getName(),l),l.setGridColor(d.Theme.Color.Grid1);var u=new o.TimelineArea(t+".timeline");a.setArea(u.getName(),u),l.addArea(u),u.setDockStyle(o.ChartArea.DockStyle.Bottom),u.Measuring.addHandler(u,P.onMeasuring);var f=new c.TableLayout(t+".charts");return a.setArea(f.getName(),f),f.setDockStyle(o.ChartArea.DockStyle.Fill),l.addArea(f),this.createTableComps(t),a.setThemeName(s,i.theme),a}}]),e}();e.DefaultTemplate=b;var P=function(){function t(){y(this,t)}return x(t,null,[{key:"onMeasuring",value:function(t,e){var a=e.Width;e.Height;"timeline"===t.getNameObject().getCompAt(2)&&t.setMeasuredDimension(a,22)}}]),t}();e.TemplateMeasuringHandler=P},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Control=void 0;var _kline=_interopRequireDefault(__webpack_require__(3)),_kline_trade=__webpack_require__(14),_chart_manager=__webpack_require__(0),_chart_settings=__webpack_require__(4),_templates=__webpack_require__(7),_mevent=__webpack_require__(17),_jquery=_interopRequireDefault(__webpack_require__(19));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Control=function(){function Control(){_classCallCheck(this,Control)}return _createClass(Control,null,[{key:"refreshFunction",value:function(){Control.refreshCounter++;var t=_chart_manager.ChartManager.instance.getLanguage();if(Control.refreshCounter>3600){var e=Number(Control.refreshCounter/3600);"en-us"===t?(0,_jquery.default)("#chart_updated_time_text").html(e.toFixed(0)+"h"):"zh-tw"===t?(0,_jquery.default)("#chart_updated_time_text").html(e.toFixed(0)+"小時"):(0,_jquery.default)("#chart_updated_time_text").html(e.toFixed(0)+"小时")}else if(Control.refreshCounter>60&&Control.refreshCounter<=3600){var a=Number(Control.refreshCounter/60);"en-us"===t?(0,_jquery.default)("#chart_updated_time_text").html(a.toFixed(0)+"m"):"zh-tw"===t?(0,_jquery.default)("#chart_updated_time_text").html(a.toFixed(0)+"分鐘"):(0,_jquery.default)("#chart_updated_time_text").html(a.toFixed(0)+"分钟")}else Control.refreshCounter<=60&&("en-us"===t?(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"s"):(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"秒"))}},{key:"clearRefreshCounter",value:function(){window.clearInterval(Control.refreshHandler),Control.refreshCounter=0,"en-us"===_chart_manager.ChartManager.instance.getLanguage()?(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"s"):(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"秒"),Control.refreshHandler=setInterval(Control.refreshFunction,_kline.default.instance.intervalTime)}},{key:"requestData",value:function(t){Control.AbortRequest(),window.clearTimeout(_kline.default.instance.timer),_kline.default.instance.paused||(!0===t&&(0,_jquery.default)("#chart_loading").addClass("activated"),"stomp"===_kline.default.instance.type&&_kline.default.instance.stompClient?Control.requestOverStomp():Control.requestOverHttp())}},{key:"parseRequestParam",value:function(t){return JSON.parse('{"'+decodeURI(t.replace(/&/g,'","').replace(/=/g,'":"'))+'"}')}},{key:"requestOverStomp",value:function(){_kline.default.instance.socketConnected?_kline.default.instance.stompClient&&1===_kline.default.instance.stompClient.ws.readyState?_kline.default.instance.stompClient.send(_kline.default.instance.sendPath,{},JSON.stringify(Control.parseRequestParam(_kline.default.instance.requestParam))):(_kline.default.instance.debug&&console.log("DEBUG: stomp client is not ready yet ..."),_kline.default.instance.timer=setTimeout(function(){Control.requestData(!0)},1e3)):_kline.default.instance.debug&&console.log("DEBUG: socket is not coonnected")}},{key:"requestOverHttp",value:function(){_kline.default.instance.debug&&console.log("DEBUG: "+_kline.default.instance.requestParam),(0,_jquery.default)(document).ready(_kline.default.instance.G_HTTP_REQUEST=_jquery.default.ajax({type:"GET",url:_kline.default.instance.url,dataType:"json",data:_kline.default.instance.requestParam,timeout:3e4,created:Date.now(),beforeSend:function(){this.range=_kline.default.instance.range,this.symbol=_kline.default.instance.symbol},success:function(t){_kline.default.instance.G_HTTP_REQUEST&&Control.requestSuccessHandler(t)},error:function(t,e,a){_kline.default.instance.debug&&console.log(t),200===t.status&&4===t.readyState||(_kline.default.instance.timer=setTimeout(function(){Control.requestData(!0)},_kline.default.instance.intervalTime))},complete:function(){_kline.default.instance.G_HTTP_REQUEST=null}}))}},{key:"requestSuccessHandler",value:function requestSuccessHandler(res){if(_kline.default.instance.debug&&console.log(res),res&&res.success){(0,_jquery.default)("#chart_loading").removeClass("activated");var chart=_chart_manager.ChartManager.instance.getChart();chart.setTitle(),_kline.default.instance.data=eval(res.data);var updateDataRes=_kline.default.instance.chartMgr.updateData("frame0.k0",_kline.default.instance.data.lines);_kline.default.instance.requestParam=Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,null,_kline.default.instance.chartMgr.getDataSource("frame0.k0").getLastDate());var intervalTime=_kline.default.instance.intervalTime<_kline.default.instance.range?_kline.default.instance.intervalTime:_kline.default.instance.range;updateDataRes?(_kline.default.instance.data.trades&&_kline.default.instance.data.trades.length>0&&(_kline_trade.KlineTrade.instance.pushTrades(_kline.default.instance.data.trades),_kline_trade.KlineTrade.instance.klineTradeInit=!0),_kline.default.instance.data.depths&&_kline_trade.KlineTrade.instance.updateDepth(_kline.default.instance.data.depths),Control.clearRefreshCounter(),"poll"===_kline.default.instance.type&&(_kline.default.instance.timer=setTimeout(Control.TwoSecondThread,intervalTime)),_chart_manager.ChartManager.instance.redraw("All",!1)):"poll"===_kline.default.instance.type&&(_kline.default.instance.timer=setTimeout(Control.requestData,intervalTime))}else"poll"===_kline.default.instance.type&&(_kline.default.instance.timer=setTimeout(function(){Control.requestData(!0)},_kline.default.instance.intervalTime))}},{key:"AbortRequest",value:function(){"stomp"===_kline.default.instance.type&&_kline.default.instance.stompClient||_kline.default.instance.G_HTTP_REQUEST&&4!==_kline.default.instance.G_HTTP_REQUEST.readyState&&_kline.default.instance.G_HTTP_REQUEST.abort()}},{key:"TwoSecondThread",value:function(){var t=_kline.default.instance.chartMgr.getDataSource("frame0.k0").getLastDate();_kline.default.instance.requestParam=-1===t?Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,_kline.default.instance.limit,null):Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,null,t.toString()),Control.requestData()}},{key:"readCookie",value:function(){_chart_settings.ChartSettings.get(),_chart_settings.ChartSettings.save();var t=_chart_settings.ChartSettings.get();_chart_manager.ChartManager.instance.setChartStyle("frame0.k0",t.charts.chartStyle);var e=t.charts.symbol;_kline.default.instance.init||(e=_kline.default.instance.symbol,_kline.default.instance.init=!0),_kline.default.instance.symbol=e,Control.switchSymbolSelected(e);var a=t.charts.period;Control.switchPeriod(a),(0,_jquery.default)("#chart_period_"+a+"_v a").addClass("selected"),(0,_jquery.default)("#chart_period_"+a+"_h a").addClass("selected"),"close"===t.charts.indicsStatus?Control.switchIndic("off"):"open"===t.charts.indicsStatus&&Control.switchIndic("on"),(0,_jquery.default)("#chart_select_main_indicator").find("a").each(function(){(0,_jquery.default)(this).attr("name")===t.charts.mIndic&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)("#chart_select_chart_style").find("a").each(function(){(0,_jquery.default)(this)[0].innerHTML===t.charts.chartStyle&&(0,_jquery.default)(this).addClass("selected")}),_chart_manager.ChartManager.instance.getChart().setMainIndicator(t.charts.mIndic),_chart_manager.ChartManager.instance.setThemeName("frame0",t.theme),Control.switchTools("off"),"Dark"===t.theme?Control.switchTheme("dark"):"Light"===t.theme&&Control.switchTheme("light"),Control.chartSwitchLanguage(t.language||"zh-cn")}},{key:"setHttpRequestParam",value:function(t,e,a,r){var n="symbol="+t+"&range="+e;return n+=null!==a?"&limit="+a:"&since="+r,0!==_kline_trade.KlineTrade.instance.tradeDate.getTime()&&(n+="&prevTradeTime="+_kline_trade.KlineTrade.instance.tradeDate.getTime()),n}},{key:"refreshTemplate",value:function(){_kline.default.instance.chartMgr=_templates.DefaultTemplate.loadTemplate("frame0.k0",""),_chart_manager.ChartManager.instance.redraw("All",!0)}},{key:"chartSwitchLanguage",value:function(t){var e=t.replace(/-/,"_");(0,_jquery.default)("#chart_language_switch_tmp").find("span").each(function(){var t=(0,_jquery.default)(this).attr("name"),a=(0,_jquery.default)(this).attr(e);t="."+t,(0,_jquery.default)(t)[0]&&(0,_jquery.default)(t).each(function(){(0,_jquery.default)(this)[0].innerHTML=a})}),(0,_jquery.default)("#chart_language_setting_div li a[name='"+t+"']").addClass("selected"),_chart_manager.ChartManager.instance.setLanguage(t),_chart_manager.ChartManager.instance.getChart().setTitle(),_chart_settings.ChartSettings.get().language=t,_chart_settings.ChartSettings.save(),_kline.default.instance.onLangChange(t)}},{key:"onSize",value:function(t,e){var a=t||window.innerWidth,r=_kline.default.instance.showTrade?a-_kline.default.instance.tradeWidth:a,n=e||window.innerHeight;(0,_jquery.default)(_kline.default.instance.element).css({width:a+"px",height:n+"px"});var i=(0,_jquery.default)("#chart_toolbar"),s=(0,_jquery.default)("#chart_toolpanel"),o=(0,_jquery.default)("#chart_canvasGroup"),l=(0,_jquery.default)("#chart_tabbar"),u="inline"===s[0].style.display,h="block"===l[0].style.display,c={x:0,y:0};c.w=r,c.h=29;var d={x:0};d.y=c.h+1,d.w=u?32:0,d.h=n-d.y;var f={};f.w=u?r-(d.w+1):r,f.h=h?22:-1,f.x=r-f.w,f.y=n-(f.h+1);var g={};g.x=f.x,g.y=d.y,g.w=f.w,g.h=f.y-d.y,i.css({left:c.x+"px",top:c.y+"px",width:c.w+"px",height:c.h+"px"}),u&&s.css({left:d.x+"px",top:d.y+"px",width:d.w+"px",height:d.h+"px"}),o.css({left:g.x+"px",top:g.y+"px",height:g.h+"px"});var _=(0,_jquery.default)("#chart_mainCanvas")[0],p=(0,_jquery.default)("#chart_overlayCanvas")[0];_.width=g.w,_.height=g.h,p.width=g.w,p.height=g.h,h&&l.css({left:f.x+"px",top:f.y+"px",width:f.w+"px",height:f.h+"px"});var m=(0,_jquery.default)("#chart_parameter_settings");m.css({left:r-m.width()>>1,top:n-m.height()>>1});var v=(0,_jquery.default)("#chart_loading");v.css({left:r-v.width()>>1,top:n-v.height()>>2});var y=(0,_jquery.default)("#chart_dom_elem_cache"),w=(0,_jquery.default)("#chart_select_theme")[0],x=(0,_jquery.default)("#chart_enable_tools")[0],C=(0,_jquery.default)("#chart_enable_indicator")[0],b=(0,_jquery.default)("#chart_toolbar_periods_vert"),P=(0,_jquery.default)("#chart_toolbar_periods_horz")[0],k=(0,_jquery.default)("#chart_show_indicator")[0],M=(0,_jquery.default)("#chart_show_tools")[0],S=(0,_jquery.default)("#chart_toolbar_theme")[0],E=(0,_jquery.default)("#chart_dropdown_settings"),O=b[0].offsetWidth,D=O+P.offsetWidth,A=D+k.offsetWidth+4,T=A+M.offsetWidth+4,I=T+S.offsetWidth,R=E.find(".chart_dropdown_t")[0].offsetWidth+150;O+=R,A+=R,T+=R,I+=R,r<(D+=R)?y.append(P):b.after(P),r<A?(y.append(k),C.style.display=""):(E.before(k),C.style.display="none"),r<T?(y.append(M),x.style.display=""):(E.before(M),x.style.display="none"),r<I?(y.append(S),w.style.display=""):(E.before(S),w.style.display="none"),_chart_manager.ChartManager.instance.redraw("All",!0),_kline.default.instance.onResize(a,n)}},{key:"mouseWheel",value:function(t,e){return _chart_manager.ChartManager.instance.scale(e>0?1:-1),_chart_manager.ChartManager.instance.redraw("All",!0),!1}},{key:"switchTheme",value:function(t){if((0,_jquery.default)("#chart_toolbar_theme a").removeClass("selected"),(0,_jquery.default)("#chart_select_theme a").removeClass("selected"),(0,_jquery.default)("#chart_toolbar_theme").find("a").each(function(){(0,_jquery.default)(this).attr("name")===t&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)("#chart_select_theme a").each(function(){(0,_jquery.default)(this).attr("name")===t&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)(".chart_container").attr("class","chart_container "+t),(0,_jquery.default)(".marketName_ a").attr("class",t),"dark"===t)(0,_jquery.default)(".trade_container").addClass("dark").removeClass("light"),_chart_manager.ChartManager.instance.setThemeName("frame0","Dark"),_chart_settings.ChartSettings.get().theme="Dark",_chart_settings.ChartSettings.save();else if("light"===t){(0,_jquery.default)(".trade_container").addClass("light").removeClass("dark"),_chart_manager.ChartManager.instance.setThemeName("frame0","Light"),_chart_settings.ChartSettings.get().theme="Light",_chart_settings.ChartSettings.save()}var e={command:"set current themes"};e.content=t,(0,_jquery.default)("#chart_output_interface_text").val(JSON.stringify(e)),(0,_jquery.default)("#chart_output_interface_submit").submit(),(new _mevent.MEvent).raise(t),_chart_manager.ChartManager.instance.redraw(),_kline.default.instance.onThemeChange(t)}},{key:"switchTools",value:function(t){(0,_jquery.default)(".chart_dropdown_data").removeClass("chart_dropdown-hover"),(0,_jquery.default)("#chart_toolpanel .chart_toolpanel_button").removeClass("selected"),(0,_jquery.default)("#chart_enable_tools a").removeClass("selected"),"on"===t?((0,_jquery.default)("#chart_show_tools").addClass("selected"),(0,_jquery.default)("#chart_enable_tools a").each(function(){"on"===(0,_jquery.default)(this).attr("name")&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)("#chart_toolpanel")[0].style.display="inline",_chart_manager.ChartManager.instance._drawingTool===_chart_manager.ChartManager.DrawingTool.Cursor?(0,_jquery.default)("#chart_Cursor").parent().addClass("selected"):_chart_manager.ChartManager.instance._drawingTool===_chart_manager.ChartManager.DrawingTool.CrossCursor&&(0,_jquery.default)("#chart_CrossCursor").parent().addClass("selected")):"off"===t&&((0,_jquery.default)("#chart_show_tools").removeClass("selected"),(0,_jquery.default)("#chart_enable_tools a").each(function(){"off"===(0,_jquery.default)(this).attr("name")&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)("#chart_toolpanel")[0].style.display="none",_chart_manager.ChartManager.instance.setRunningMode(_chart_manager.ChartManager.instance._beforeDrawingTool),_chart_manager.ChartManager.instance.redraw("All",!0)),_kline.default.instance.isSized?Control.onSize():Control.onSize(_kline.default.instance.width,_kline.default.instance.height)}},{key:"switchIndic",value:function(t){if((0,_jquery.default)("#chart_enable_indicator a").removeClass("selected"),(0,_jquery.default)("#chart_enable_indicator a[name='"+t+"']").addClass("selected"),"on"===t){(0,_jquery.default)("#chart_show_indicator").addClass("selected");var e=_chart_settings.ChartSettings.get();e.charts.indicsStatus="open",_chart_settings.ChartSettings.save();var a=e.charts.indics[1];_templates.Template.displayVolume,_chart_manager.ChartManager.instance.getChart().setIndicator(2,a),(0,_jquery.default)("#chart_tabbar").find("a").each(function(){(0,_jquery.default)(this).attr("name")===a&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)("#chart_tabbar")[0].style.display="block"}else if("off"===t){(0,_jquery.default)("#chart_show_indicator").removeClass("selected"),_chart_manager.ChartManager.instance.getChart().setIndicator(2,"NONE"),_chart_settings.ChartSettings.get().charts.indicsStatus="close",_chart_settings.ChartSettings.save(),(0,_jquery.default)("#chart_tabbar")[0].style.display="none",(0,_jquery.default)("#chart_tabbar a").removeClass("selected")}_kline.default.instance.isSized?Control.onSize():Control.onSize(_kline.default.instance.width,_kline.default.instance.height)}},{key:"switchPeriod",value:function(t){if((0,_jquery.default)(".chart_container .chart_toolbar_tabgroup a").removeClass("selected"),(0,_jquery.default)("#chart_toolbar_periods_vert ul a").removeClass("selected"),(0,_jquery.default)(".chart_container .chart_toolbar_tabgroup a").each(function(){(0,_jquery.default)(this).parent().attr("name")===t&&(0,_jquery.default)(this).addClass("selected")}),(0,_jquery.default)("#chart_toolbar_periods_vert ul a").each(function(){(0,_jquery.default)(this).parent().attr("name")===t&&(0,_jquery.default)(this).addClass("selected")}),_chart_manager.ChartManager.instance.showCursor(),Control.calcPeriodWeight(t),"line"===t)return _chart_manager.ChartManager.instance.getChart().strIsLine=!0,_chart_manager.ChartManager.instance.setChartStyle("frame0.k0","Line"),_chart_manager.ChartManager.instance.getChart().setCurrentPeriod("line"),_chart_settings.ChartSettings.get().charts.period=t,void _chart_settings.ChartSettings.save();_chart_manager.ChartManager.instance.getChart().strIsLine=!1;var e=_kline.default.instance.tagMapPeriod[t];_chart_manager.ChartManager.instance.setChartStyle("frame0.k0",_chart_settings.ChartSettings.get().charts.chartStyle),_chart_manager.ChartManager.instance.getChart().setCurrentPeriod(e),_chart_settings.ChartSettings.get().charts.period=t,_chart_settings.ChartSettings.save()}},{key:"reset",value:function(t){_kline.default.instance.symbol=t,_kline.default.instance.showTrade&&_kline_trade.KlineTrade.instance.reset(t)}},{key:"switchSymbolSelected",value:function(t){Control.reset(t),(0,_jquery.default)(".market_chooser ul a").removeClass("selected"),(0,_jquery.default)(".market_chooser ul a[name='"+t+"']").addClass("selected"),_chart_manager.ChartManager.instance.getChart()._symbol=t,_chart_settings.ChartSettings.get().charts.symbol=t,_chart_settings.ChartSettings.save()}},{key:"switchSymbol",value:function(t){"stomp"===_kline.default.instance.type&&1===_kline.default.instance.stompClient.ws.readyState&&(_kline.default.instance.subscribed.unsubscribe(),_kline.default.instance.subscribed=_kline.default.instance.stompClient.subscribe(_kline.default.instance.subscribePath+"/"+t+"/"+_kline.default.instance.range,Control.subscribeCallback)),Control.switchSymbolSelected(t),"line"===_chart_settings.ChartSettings.get().charts.period?(_chart_manager.ChartManager.instance.getChart().strIsLine=!0,_chart_manager.ChartManager.instance.setChartStyle("frame0.k0","Line")):(_chart_manager.ChartManager.instance.getChart().strIsLine=!1,_chart_manager.ChartManager.instance.setChartStyle("frame0.k0",_chart_settings.ChartSettings.get().charts.chartStyle)),_chart_manager.ChartManager.instance.getChart().setSymbol(t)}},{key:"calcPeriodWeight",value:function(t){var e=t;"line"!==t&&(e=_kline.default.instance.periodMap[_kline.default.instance.tagMapPeriod[t]]);var a=_chart_settings.ChartSettings.get().charts.period_weight;for(var r in a)a[r]>a[e]&&(a[r]-=1);a[e]=8,_chart_settings.ChartSettings.save()}},{key:"subscribeCallback",value:function(t){Control.requestSuccessHandler(JSON.parse(t.body))}},{key:"socketConnect",value:function(){_kline.default.instance.stompClient&&_kline.default.instance.socketConnected||(_kline.default.instance.stompClient=Stomp.client(_kline.default.instance.url),_kline.default.instance.socketConnected=!0),1!==_kline.default.instance.stompClient.ws.readyState?(_kline.default.instance.debug||(_kline.default.instance.stompClient.debug=null),_kline.default.instance.stompClient.connect({},function(){_kline.default.instance.stompClient.subscribe("/user"+_kline.default.instance.subscribePath,Control.subscribeCallback),_kline.default.instance.subscribed=_kline.default.instance.stompClient.subscribe(_kline.default.instance.subscribePath+"/"+_kline.default.instance.symbol+"/"+_kline.default.instance.range,Control.subscribeCallback),Control.requestData(!0)},function(){_kline.default.instance.stompClient.disconnect(),console.log("DEBUG: reconnect in 5 seconds ..."),setTimeout(function(){Control.socketConnect()},5e3)})):console.log("DEBUG: already connected")}}]),Control}();exports.Control=Control,Control.refreshCounter=0,Control.refreshHandler=null},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CPoint=void 0;var r=a(0),n=a(1),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}(a(2)),s=a(5);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function e(t){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=u(this,h(e).call(this,t))).pos={index:-1,value:-1},a.state=e.state.Hide,a}var a,o,d;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,n.NamedObject),a=e,(o=[{key:"getChartObjects",value:function(){var t=r.ChartManager.instance,e=t.getDataSource("frame0.k0");if(null===e||!s.Util.isInstance(e,i.MainDataSource))return null;var a=t.getTimeline("frame0.k0");if(null===a)return null;var n=t.getRange("frame0.k0.main");return null===n?null:{pMgr:t,pCDS:e,pTimeline:a,pRange:n}}},{key:"setPosXY",value:function(t,e){var a=this.getChartObjects(),r=a.pTimeline.toIndex(t),n=a.pRange.toValue(e),i=this.snapValue(r,n);null!==i&&(n=i),this.setPosIV(r,n)}},{key:"setPosXYNoSnap",value:function(t,e){var a=this.getChartObjects(),r=a.pTimeline.toIndex(t),n=a.pRange.toValue(e);this.setPosIV(r,n)}},{key:"setPosIV",value:function(t,e){this.pos={index:t,value:e}}},{key:"getPosXY",value:function(){var t=this.getChartObjects();return{x:t.pTimeline.toItemCenter(this.pos.index),y:t.pRange.toY(this.pos.value)}}},{key:"getPosIV",value:function(){return{i:this.pos.index,v:this.pos.value}}},{key:"setState",value:function(t){this.state=t}},{key:"getState",value:function(){return this.state}},{key:"isSelected",value:function(t,a){var r=this.getPosXY();return!(t<r.x-4||t>r.x+4||a<r.y-4||a>r.y+4)&&(this.setState(e.state.Highlight),!0)}},{key:"snapValue",value:function(t,e){var a=this.getChartObjects(),r=null,n=Math.floor(a.pTimeline.getFirstIndex()),i=Math.floor(a.pTimeline.getLastIndex());if(t<n||t>i)return r;var s=a.pRange.toY(e),o=a.pCDS.getDataAt(t);if(null===o||void 0===o)return r;var l=null;l=t>0?a.pCDS.getDataAt(t-1):a.pCDS.getDataAt(t);var u=a.pMgr.getChartStyle(a.pCDS.getFrameName()),h=a.pRange.toY(o.open),c=a.pRange.toY(o.high),d=a.pRange.toY(o.low),f=a.pRange.toY(o.close);"CandleStickHLC"===u&&(h=a.pRange.toY(l.close));var g=Math.abs(h-s),_=Math.abs(c-s),p=Math.abs(d-s),m=Math.abs(f-s);return g<=_&&g<=p&&g<=m&&g<6&&(r=o.open),_<=g&&_<=p&&_<=m&&_<6&&(r=o.high),p<=g&&p<=_&&p<=m&&p<6&&(r=o.low),m<=g&&m<=_&&m<=p&&m<6&&(r=o.close),r}}])&&l(a.prototype,o),d&&l(a,d),e}();e.CPoint=d,d.state={Hide:0,Show:1,Highlight:2}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CArrowLineObject=e.CPriceLineObject=e.CVertiStraightLineObject=e.CTriParallelLineObject=e.CStraightLineObject=e.CSegLineObject=e.CRayLineObject=e.CHoriStraightLineObject=e.CHoriSegLineObject=e.CHoriRayLineObject=e.CFibRetraceObject=e.CFibFansObject=e.CBiParallelRayLineObject=e.CBiParallelLineObject=e.CBandLineObject=e.CTriToolObject=e.CBiToolObject=e.CToolObject=void 0;var r=a(0),n=a(1),i=a(9),s=a(5),o=u(a(2)),l=u(a(11));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e,a){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(a):n.value}})(t,e,a||t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,a){return e&&f(t.prototype,e),a&&f(t,a),t}function _(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var w=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=null,a.state=e.state.BeforeDraw,a.points=[],a.step=0,a}return v(e,n.NamedObject),g(e,[{key:"getChartObjects",value:function(){var t=r.ChartManager.instance,e=t.getDataSource("frame0.k0");if(null===e||!s.Util.isInstance(e,o.MainDataSource))return null;var a=t.getTimeline("frame0.k0");if(null===a)return null;var n=t.getArea("frame0.k0.main");if(null===n)return null;var i=t.getRange("frame0.k0.main");return null===i?null:{pMgr:t,pCDS:e,pTimeline:a,pArea:n,pRange:i}}},{key:"isValidMouseXY",value:function(t,e){var a=this.getChartObjects(),r=a.pArea.getLeft(),n=a.pArea.getTop(),i=a.pArea.getRight(),s=a.pArea.getBottom();return!(t<r||t>i||e<n||e>s)}},{key:"getPlotter",value:function(){return this.drawer}},{key:"setState",value:function(t){this.state=t}},{key:"getState",value:function(){return this.state}},{key:"addPoint",value:function(t){this.points.push(t)}},{key:"getPoint",value:function(t){return this.points[t]}},{key:"acceptMouseMoveEvent",value:function(t,a){return!1!==this.isValidMouseXY(t,a)&&(this.state===e.state.BeforeDraw?this.setBeforeDrawPos(t,a):this.state===e.state.Draw?this.setDrawPos(t,a):this.state===e.state.AfterDraw&&this.setAfterDrawPos(t,a),!0)}},{key:"acceptMouseDownEvent",value:function(t,a){return!1!==this.isValidMouseXY(t,a)&&(this.state===e.state.BeforeDraw?(this.setDrawPos(t,a),this.setState(e.state.Draw)):this.state===e.state.Draw?(this.setAfterDrawPos(t,a),0===this.step&&this.setState(e.state.AfterDraw)):this.state===e.state.AfterDraw&&(e.prototype.isSelected(t,a)?(this.setDrawPos(t,a),this.setState(e.state.Draw)):(this.oldx=t,this.oldy=a)),!0)}},{key:"acceptMouseDownMoveEvent",value:function(t,a){if(!1===this.isValidMouseXY(t,a))return!1;if(this.state===e.state.Draw)this.setDrawPos(t,a);else if(this.state===e.state.AfterDraw){var r=this.getChartObjects(),n=r.pTimeline.getItemWidth();r.pRange;if(Math.abs(t-this.oldx)<n&&0===Math.abs(a-this.oldy))return!0;var i=r.pTimeline.toIndex(this.oldx),s=r.pRange.toValue(this.oldy),o=r.pTimeline.toIndex(t),l=r.pRange.toValue(a);this.oldx=t,this.oldy=a;var u=o-i,h=l-s;for(var c in this.points)this.points[c].pos.index+=u,this.points[c].pos.value+=h}return!0}},{key:"acceptMouseUpEvent",value:function(t,a){return!1!==this.isValidMouseXY(t,a)&&(this.state===e.state.Draw&&(this.setAfterDrawPos(t,a),0===this.step&&this.setState(e.state.AfterDraw),!0))}},{key:"setBeforeDrawPos",value:function(t,e){for(var a in this.points)this.points[a].setPosXY(t,e),this.points[a].setState(i.CPoint.state.Show)}},{key:"setDrawPos",value:function(t,e){for(var a in this.points)this.points[a].getState()===i.CPoint.state.Highlight&&this.points[a].setPosXY(t,e)}},{key:"setAfterDrawPos",value:function(t,e){for(var a in 0!==this.step&&(this.step-=1),this.points)this.points[a].setState(i.CPoint.state.Hide);0===this.step&&this.getChartObjects().pMgr.setNormalMode()}},{key:"isSelected",value:function(t,e){var a=!1;for(var r in this.points)if(this.points[r].isSelected(t,e)){this.points[r].setState(i.CPoint.state.Highlight),a=!0;break}return!0===a&&(this.select(),!0)}},{key:"select",value:function(){for(var t in this.points)this.points[t].getState()===i.CPoint.state.Hide&&this.points[t].setState(i.CPoint.state.Show)}},{key:"unselect",value:function(){for(var t in this.points)this.points[t].getState()!==i.CPoint.state.Hide&&this.points[t].setState(i.CPoint.state.Hide)}},{key:"calcDistance",value:function(t,e,a){var r=t.getPosXY().x,n=t.getPosXY().y,i=e.getPosXY().x,s=e.getPosXY().y,o=a.getPosXY().x,l=a.getPosXY().y,u=r-o,h=n-l,c=i-o,d=s-l;return Math.abs(u*d-h*c)/Math.sqrt(Math.pow(i-r,2)+Math.pow(s-n,2))}},{key:"calcGap",value:function(t,e,a){var r=t.sx,n=t.sy,i=t.ex,s=t.ey,o=r-e,l=n-a,u=i-e,h=s-a;return Math.abs(o*h-l*u)/Math.sqrt(Math.pow(i-r,2)+Math.pow(s-n,2))}},{key:"isWithRect",value:function(t,e,a){var r=t.getPosXY().x,n=t.getPosXY().y,i=e.getPosXY().x,s=e.getPosXY().y,o=a.getPosXY().x,l=a.getPosXY().y;return r>i?(r+=4,i-=4):(r-=4,i+=4),n>s?(n+=4,s-=4):(n-=4,s+=4),r<=o&&i>=o&&n<=l&&s>=l||(r>=o&&i<=o&&n<=l&&s>=l||(r<=o&&i>=o&&n>=l&&s<=l||r>=o&&i<=o&&n>=l&&s<=l))}}]),e}();e.CToolObject=w,w.state={BeforeDraw:0,Draw:1,AfterDraw:2};var x=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).addPoint(new i.CPoint(t)),a.addPoint(new i.CPoint(t)),a}return v(e,w),g(e,[{key:"setBeforeDrawPos",value:function(t,a){this.step=1,c(m(e.prototype),"setBeforeDrawPos",this).call(this,t,a),this.getPoint(0).setState(i.CPoint.state.Show),this.getPoint(1).setState(i.CPoint.state.Highlight)}}]),e}();e.CBiToolObject=x;var C=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).addPoint(new i.CPoint(t)),a.addPoint(new i.CPoint(t)),a.addPoint(new i.CPoint(t)),a}return v(e,w),g(e,[{key:"setBeforeDrawPos",value:function(t,a){this.step=2,c(m(e.prototype),"setBeforeDrawPos",this).call(this,t,a),this.getPoint(0).setState(i.CPoint.state.Show),this.getPoint(1).setState(i.CPoint.state.Show),this.getPoint(2).setState(i.CPoint.state.Highlight)}},{key:"setAfterDrawPos",value:function(t,e){if(0!==this.step&&(this.step-=1),0===this.step)for(var a in this.points)this.points[a].setState(i.CPoint.state.Hide);else this.getPoint(0).setState(i.CPoint.state.Show),this.getPoint(1).setState(i.CPoint.state.Highlight),this.getPoint(2).setState(i.CPoint.state.Show);0===this.step&&this.getChartObjects().pMgr.setNormalMode()}}]),e}();e.CTriToolObject=C;var b=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawBandLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);this.getPoint(0).getPosXY().x;for(var r=this.getPoint(0).getPosXY().y,n=(this.getPoint(1).getPosXY().x,this.getPoint(1).getPosXY().y),s=[100,87.5,75,62.5,50,37.5,25,12.5,0],o=0;o<s.length;o++){var l=r+(100-s[o])/100*(n-r);if(l<a+4&&l>a-4)return this.select(),!0}return!1}}]),e}();e.CBandLineObject=b;var P=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawBiParallelLinesPlotter(t,p(p(a))),a}return v(e,C),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;var r=this.getPoint(0).getPosXY().x,n=this.getPoint(0).getPosXY().y,i=this.getPoint(1).getPosXY().x,s=this.getPoint(1).getPosXY().y,o=this.getPoint(2).getPosXY().x,l=this.getPoint(2).getPosXY().y,u={sx:r,sy:n,ex:o,ey:l},h={sx:i,sy:s,ex:r-(r-i+(r-o)),ey:n-(n-s+(n-l))};return!(this.calcGap(u,t,a)>4&&this.calcGap(h,t,a)>4)}}]),e}();e.CBiParallelLineObject=P;var k=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawBiParallelRayLinesPlotter(t,p(p(a))),a}return v(e,C),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;var r=this.getPoint(0).getPosXY().x,n=this.getPoint(0).getPosXY().y,i=this.getPoint(1).getPosXY().x,s=this.getPoint(1).getPosXY().y,o=this.getPoint(2).getPosXY().x,l=this.getPoint(2).getPosXY().y,u={sx:r,sy:n,ex:o,ey:l},h={sx:i,sy:s,ex:r-(r-i+(r-o)),ey:n-(n-s+(n-l))};return(u.ex>u.sx&&t>u.sx-4||u.ex<u.sx&&t<u.sx+4||h.ex>h.sx&&t>h.sx-4||h.ex<h.sx&&t<h.sx+4)&&(!(this.calcGap(u,t,a)>4&&this.calcGap(h,t,a)>4)&&(this.select(),!0))}}]),e}();e.CBiParallelRayLineObject=k;var M=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawFibFansPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;var r=new i.CPoint("frame0.k0");r.setPosXY(t,a);for(var n=this.getPoint(0).getPosXY().x,s=this.getPoint(0).getPosXY().y,o=this.getPoint(1).getPosXY().x,l=this.getPoint(1).getPosXY().y,u=this.getChartObjects(),h={left:u.pArea.getLeft(),top:u.pArea.getTop(),right:u.pArea.getRight(),bottom:u.pArea.getBottom()},d=[0,38.2,50,61.8],f=0;f<d.length;f++){var g={x:n,y:s},_={x:o,y:s+(100-d[f])/100*(l-s)},p=this.getRectCrossPt(h,g,_),v=Math.pow(p[0].x-n,2)+Math.pow(p[0].y-s,2)>Math.pow(p[0].x-o,2)+Math.pow(p[0].y-l,2)?{x:p[0].x,y:p[0].y}:{x:p[1].x,y:p[1].y};if(!(v.x>n&&t<n)&&!(v.x<n&&t>n)){var y=new i.CPoint("frame0.k0");y.setPosXY(n,s);var w=new i.CPoint("frame0.k0");if(w.setPosXY(v.x,v.y),!(this.calcDistance(y,w,r)>4))return this.select(),!0}}return!1}}]),e}();e.CFibFansObject=M;var S=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawFibRetracePlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);this.getPoint(0).getPosXY().x;for(var r=this.getPoint(0).getPosXY().y,n=(this.getPoint(1).getPosXY().x,this.getPoint(1).getPosXY().y),s=[100,78.6,61.8,50,38.2,23.6,0],o=0;o<s.length;o++){var l=r+(100-s[o])/100*(n-r);if(l<a+4&&l>a-4)return this.select(),!0}return!1}}]),e}();e.CFibRetraceObject=S;var E=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawHoriRayLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"setDrawPos",value:function(t,e){if(this.points[0].getState()===i.CPoint.state.Highlight)return this.points[0].setPosXY(t,e),void this.points[1].setPosXYNoSnap(this.points[1].getPosXY().x,this.points[0].getPosXY().y);this.points[1].getState()===i.CPoint.state.Highlight&&(this.points[1].setPosXY(t,e),this.points[0].setPosXYNoSnap(this.points[0].getPosXY().x,this.points[1].getPosXY().y))}},{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);var r=this.getPoint(0).getPosXY().y,n=this.getPoint(0).getPosXY().x,s=this.getPoint(1).getPosXY().x;return!(a>r+4||a<r-4)&&(!(s>n&&t<n-4)&&(!(s<n&&t>n+4)&&(this.select(),!0)))}}]),e}();e.CHoriRayLineObject=E;var O=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawHoriSegLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"setDrawPos",value:function(t,e){if(this.points[0].getState()===i.CPoint.state.Highlight)return this.points[0].setPosXY(t,e),void this.points[1].setPosXYNoSnap(this.points[1].getPosXY().x,this.points[0].getPosXY().y);this.points[1].getState()===i.CPoint.state.Highlight&&(this.points[1].setPosXY(t,e),this.points[0].setPosXYNoSnap(this.points[0].getPosXY().x,this.points[1].getPosXY().y))}},{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);var r=this.getPoint(0).getPosXY().y,n=this.getPoint(0).getPosXY().x,s=this.getPoint(1).getPosXY().x;return!(a>r+4||a<r-4)&&(!(n>s&&(t>n+4||t<s-4))&&(!(n<s&&(t<n-4||t>s+4))&&(this.select(),!0)))}}]),e}();e.CHoriSegLineObject=O;var D=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawHoriStraightLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"setDrawPos",value:function(t,e){for(var a in this.points)this.points[a].setPosXY(t,e)}},{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);var r=this.getPoint(0).getPosXY().y;return!(a>r+4||a<r-4)&&(this.select(),!0)}}]),e}();e.CHoriStraightLineObject=D;var A=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawRayLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;var r=new i.CPoint("frame0.k0");r.setPosXY(t,a);var n=this.getPoint(0).getPosXY().x,s=this.getPoint(1).getPosXY().x;return!(s>n&&t<n-4)&&(!(s<n&&t>n+4)&&(this.calcDistance(this.getPoint(0),this.getPoint(1),r)<4&&(this.select(),!0)))}}]),e}();e.CRayLineObject=A;var T=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawSegLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;var r=new i.CPoint("frame0.k0");return r.setPosXY(t,a),!1!==this.isWithRect(this.getPoint(0),this.getPoint(1),r)&&(this.calcDistance(this.getPoint(0),this.getPoint(1),r)<4&&(this.select(),!0))}}]),e}();e.CSegLineObject=T;var I=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawStraightLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;var r=new i.CPoint("frame0.k0");return r.setPosXY(t,a),this.calcDistance(this.getPoint(0),this.getPoint(1),r)<4&&(this.select(),!0)}}]),e}();e.CStraightLineObject=I;var R=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawTriParallelLinesPlotter(t,p(p(a))),a}return v(e,C),g(e,[{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;this.getChartObjects();var r=this.getPoint(0).getPosXY().x,n=this.getPoint(0).getPosXY().y,i=this.getPoint(1).getPosXY().x,s=this.getPoint(1).getPosXY().y,o=this.getPoint(2).getPosXY().x,l=this.getPoint(2).getPosXY().y,u=r-(r-i+(r-o)),h=n-(n-s+(n-l)),d={sx:r,sy:n,ex:o,ey:l},f={sx:i,sy:s,ex:u,ey:h},g=i-r,_=s-n,p=u-o,v=h-l,y={sx:Math.abs(g-r),sy:Math.abs(_-n),ex:Math.abs(p-o),ey:Math.abs(v-l)};return!(this.calcGap(d,t,a)>4&&this.calcGap(f,t,a)>4&&this.calcGap(y,t,a)>4)&&(this.select(),!0)}}]),e}();e.CTriParallelLineObject=R;var j=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawVertiStraightLinesPlotter(t,p(p(a))),a}return v(e,x),g(e,[{key:"setDrawPos",value:function(t,e){for(var a in this.points)this.points[a].setPosXY(t,e)}},{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);var r=this.getPoint(0).getPosXY().x;return!(t>r+4||t<r-4)&&(this.select(),!0)}}]),e}();e.CVertiStraightLineObject=j;var L=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawPriceLinesPlotter(t,p(p(a))),a}return v(e,T),g(e,[{key:"setDrawPos",value:function(t,e){for(var a in this.points)this.points[a].setPosXY(t,e)}},{key:"isSelected",value:function(t,a){if(!0===c(m(e.prototype),"isSelected",this).call(this,t,a))return!0;new i.CPoint("frame0.k0").setPosXY(t,a);var r=this.getPoint(0).getPosXY().x,n=this.getPoint(0).getPosXY().y;this.getPoint(1).getPosXY().x,this.getPoint(1).getPosXY().y;return!(t<r-4)&&(!(a>=n+4||a<=n-4)&&(this.select(),!0))}}]),e}();e.CPriceLineObject=L;var N=function(t){function e(t){var a;return d(this,e),(a=_(this,m(e).call(this,t))).drawer=new l.DrawArrowLinesPlotter(t,p(p(a))),a}return v(e,T),e}();e.CArrowLineObject=N},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CDynamicLinePlotter=e.DrawFibFansPlotter=e.DrawBandLinesPlotter=e.DrawFibRetracePlotter=e.BandLinesPlotter=e.DrawTriParallelLinesPlotter=e.DrawBiParallelRayLinesPlotter=e.DrawBiParallelLinesPlotter=e.ParallelLinesPlotter=e.DrawPriceLinesPlotter=e.DrawVertiStraightLinesPlotter=e.DrawHoriSegLinesPlotter=e.DrawHoriRayLinesPlotter=e.DrawHoriStraightLinesPlotter=e.DrawArrowLinesPlotter=e.DrawRayLinesPlotter=e.DrawSegLinesPlotter=e.DrawStraightLinesPlotter=e.CToolPlotter=e.RangeSelectionPlotter=e.TimelineSelectionPlotter=e.SelectionPlotter=e.LastClosePlotter=e.LastVolumePlotter=e.COrderGraphPlotter=e.RangePlotter=e.TimelinePlotter=e.MinMaxPlotter=e.IndicatorInfoPlotter=e.IndicatorPlotter=e.MainInfoPlotter=e.OHLCPlotter=e.CandlestickHLCPlotter=e.CandlestickPlotter=e.CGridPlotter=e.TimelineAreaBackgroundPlotter=e.RangeAreaBackgroundPlotter=e.MainAreaBackgroundPlotter=e.BackgroundPlotter=e.Plotter=void 0;var r,n=(r=a(3))&&r.__esModule?r:{default:r},i=a(1),s=a(0),o=a(5),l=a(9),u=g(a(16)),h=g(a(6)),c=g(a(12)),d=g(a(2)),f=g(a(10));function g(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,a){return e&&m(t.prototype,e),a&&m(t,a),t}function y(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var b=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,null,[{key:"drawLine",value:function(t,e,a,r,n){t.beginPath(),t.moveTo(.5+(e<<0),.5+(a<<0)),t.lineTo(.5+(r<<0),.5+(n<<0)),t.stroke()}},{key:"drawLines",value:function(t,a){var r,n=a.length;for(t.beginPath(),t.moveTo(a[0].x,a[0].y),r=1;r<n;r++)t.lineTo(a[r].x,a[r].y);if(e.isChrome)for(t.moveTo(a[0].x,a[0].y),r=1;r<n;r++)t.lineTo(a[r].x,a[r].y);t.stroke()}},{key:"drawDashedLine",value:function(t,e,a,r,n,i,s){i<2&&(i=2);var o=r-e,l=n-a;if(t.beginPath(),0===l){for(var u=o/i+.5<<0,h=0;h<u;h++)t.rect(e,a,s,1),e+=i;t.fill()}else{for(var c=Math.sqrt(o*o+l*l)/i+.5<<0,d=(o/=c)*s/i,f=(l/=c)*s/i,g=0;g<c;g++)t.moveTo(e+.5,a+.5),t.lineTo(e+.5+d,a+.5+f),e+=o,a+=l;t.stroke()}}},{key:"createHorzDashedLine",value:function(t,e,a,r,n,i){n<2&&(n=2);for(var s=(a-e)/n+.5<<0,o=0;o<s;o++)t.rect(e,r,i,1),e+=n}},{key:"createRectangles",value:function(t,e){t.beginPath();var a,r,n=e.length;for(r=0;r<n;r++)a=e[r],t.rect(a.x,a.y,a.w,a.h)}},{key:"createPolygon",value:function(t,e){t.beginPath(),t.moveTo(e[0].x+.5,e[0].y+.5);var a,r=e.length;for(a=1;a<r;a++)t.lineTo(e[a].x+.5,e[a].y+.5);t.closePath()}},{key:"drawString",value:function(t,e,a){var r=t.measureText(e).width;return!(a.w<r)&&(t.fillText(e,a.x,a.y),a.x+=r,a.w-=r,!0)}}]),e}();e.Plotter=b,b.isChrome=null!==navigator.userAgent.toLowerCase().match(/chrome/);var P=function(t){function e(t){var a;return p(this,e),(a=y(this,w(e).call(this,t)))._color=h.Theme.Color.Background,a}return x(e,b),v(e,[{key:"getColor",value:function(){return this._color}},{key:"setColor",value:function(t){this._color=t}},{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTheme(this.getFrameName());t.fillStyle=r.getColor(this._color),t.fillRect(a.getLeft(),a.getTop(),a.getWidth(),a.getHeight())}}]),e}();e.BackgroundPlotter=P;var k=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,P),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName()),n=e.getRange(this.getAreaName()),i=e.getTheme(this.getFrameName()),o=a.getRect();if(!a.isChanged()&&!r.isUpdated()&&!n.isUpdated()){var l=r.getFirstIndex(),u=r.getLastIndex()-2,h=Math.max(l,u);o.X=r.toColumnLeft(h),o.Width=a.getRight()-o.X}t.fillStyle=i.getColor(this._color),t.fillRect(o.X,o.Y,o.Width,o.Height)}}]),e}();e.MainAreaBackgroundPlotter=k;var M=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,P),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=this.getAreaName(),r=e.getArea(a),n=e.getRange(a.substring(0,a.lastIndexOf("Range")));if("main"===n.getNameObject().getCompAt(2)||r.isChanged()||n.isUpdated()){var i=e.getTheme(this.getFrameName());t.fillStyle=i.getColor(this._color),t.fillRect(r.getLeft(),r.getTop(),r.getWidth(),r.getHeight())}}}]),e}();e.RangeAreaBackgroundPlotter=M;var S=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,P),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName());if(a.isChanged()||r.isUpdated()){var n=e.getTheme(this.getFrameName());t.fillStyle=n.getColor(this._color),t.fillRect(a.getLeft(),a.getTop(),a.getWidth(),a.getHeight())}}}]),e}();e.TimelineAreaBackgroundPlotter=S;var E=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName()),n=e.getRange(this.getAreaName()),i=!1;if(!a.isChanged()&&!r.isUpdated()&&!n.isUpdated()){var o=r.getFirstIndex(),l=r.getLastIndex(),u=Math.max(o,l-2),c=r.toColumnLeft(u);t.save(),t.rect(c,a.getTop(),a.getRight()-c,a.getHeight()),t.clip(),i=!0}var d=e.getTheme(this.getFrameName());t.fillStyle=d.getColor(h.Theme.Color.Grid0),t.beginPath();var f=4,g=1;b.isChrome&&(f=4,g=1);var _=n.getGradations();for(var p in _)b.createHorzDashedLine(t,a.getLeft(),a.getRight(),n.toY(_[p]),f,g);t.fill(),i&&t.restore()}}]),e}();e.CGridPlotter=E;var O=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getDataSource(this.getDataSourceName());if(!(a.getDataCount()<1)){var r=e.getArea(this.getAreaName()),n=e.getTimeline(this.getDataSourceName()),i=e.getRange(this.getAreaName());if(0!==i.getRange()){var l,u=e.getTheme(this.getFrameName()),c=o.Util.isInstance(u,h.DarkTheme),d=n.getFirstIndex(),f=n.getLastIndex();l=r.isChanged()||n.isUpdated()||i.isUpdated()?d:Math.max(d,f-2);for(var g=n.getColumnWidth(),_=n.getItemWidth(),p=n.toItemLeft(l),m=n.toItemCenter(l),v=[],y=[],w=[],x=[],C=l;C<f;C++){var P=a.getDataAt(C),k=i.toY(P.high),M=i.toY(P.low),S=P.open,E=P.close;if(E>S){var O=i.toY(E),D=i.toY(S),A=Math.max(D-O,1);A>1&&_>1&&c?v.push({x:p+.5,y:O+.5,w:_-1,h:A-1}):y.push({x:p,y:O,w:Math.max(_,1),h:Math.max(A,1)}),P.high>E&&(k=Math.min(k,O-1),y.push({x:m,y:k,w:1,h:O-k})),S>P.low&&(M=Math.max(M,D+1),y.push({x:m,y:D,w:1,h:M-D}))}else if(E===S){var T=i.toY(E);w.push({x:p,y:T,w:Math.max(_,1),h:1}),P.high>E&&(k=Math.min(k,T-1)),S>P.low&&(M=Math.max(M,T+1)),k<M&&w.push({x:m,y:k,w:1,h:M-k})}else{var I=i.toY(S),R=i.toY(E),j=Math.max(R-I,1);x.push({x:p,y:I,w:Math.max(_,1),h:Math.max(j,1)}),P.high>S&&(k=Math.min(k,I-1)),E>P.low&&(M=Math.max(M,R+1)),k<M&&x.push({x:m,y:k,w:1,h:M-k})}p+=g,m+=g}v.length>0&&(t.strokeStyle=u.getColor(h.Theme.Color.Positive),b.createRectangles(t,v),t.stroke()),y.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Positive),b.createRectangles(t,y),t.fill()),w.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Negative),b.createRectangles(t,w),t.fill()),x.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Negative),b.createRectangles(t,x),t.fill())}}}}]),e}();e.CandlestickPlotter=O;var D=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getDataSource(this.getDataSourceName());if(o.Util.isInstance(a,d.MainDataSource)&&!(a.getDataCount()<1)){var r=e.getArea(this.getAreaName()),n=e.getTimeline(this.getDataSourceName()),i=e.getRange(this.getAreaName());if(0!==i.getRange()){var l,u=e.getTheme(this.getFrameName()),c=o.Util.isInstance(u,h.DarkTheme),f=n.getFirstIndex(),g=n.getLastIndex();l=r.isChanged()||n.isUpdated()||i.isUpdated()?f:Math.max(f,g-2);for(var _=n.getColumnWidth(),p=n.getItemWidth(),m=n.toItemLeft(l),v=n.toItemCenter(l),y=[],w=[],x=[],C=[],P=l;P<g;P++){var k=a.getDataAt(P),M=i.toY(k.high),S=i.toY(k.low),E=k.open;P>0&&(E=a.getDataAt(P-1).close);var O=k.close;if(O>E){var D=i.toY(O),A=i.toY(E),T=Math.max(A-D,1);T>1&&p>1&&c?y.push({x:m+.5,y:D+.5,w:p-1,h:T-1}):w.push({x:m,y:D,w:Math.max(p,1),h:Math.max(T,1)}),k.high>O&&(M=Math.min(M,D-1),w.push({x:v,y:M,w:1,h:D-M})),E>k.low&&(S=Math.max(S,A+1),w.push({x:v,y:A,w:1,h:S-A}))}else if(O===E){var I=i.toY(O);x.push({x:m,y:I,w:Math.max(p,1),h:1}),k.high>O&&(M=Math.min(M,I-1)),E>k.low&&(S=Math.max(S,I+1)),M<S&&x.push({x:v,y:M,w:1,h:S-M})}else{var R=i.toY(E),j=i.toY(O),L=Math.max(j-R,1);C.push({x:m,y:R,w:Math.max(p,1),h:Math.max(L,1)}),k.high>E&&(M=Math.min(M,R-1)),O>k.low&&(S=Math.max(S,j+1)),M<S&&C.push({x:v,y:M,w:1,h:S-M})}m+=_,v+=_}y.length>0&&(t.strokeStyle=u.getColor(h.Theme.Color.Positive),b.createRectangles(t,y),t.stroke()),w.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Positive),b.createRectangles(t,w),t.fill()),x.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Negative),b.createRectangles(t,x),t.fill()),C.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Negative),b.createRectangles(t,C),t.fill())}}}}]),e}();e.CandlestickHLCPlotter=D;var A=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getDataSource(this.getDataSourceName());if(o.Util.isInstance(a,d.MainDataSource)&&!(a.getDataCount()<1)){var r=e.getArea(this.getAreaName()),n=e.getTimeline(this.getDataSourceName()),i=e.getRange(this.getAreaName());if(0!==i.getRange()){var l,u=e.getTheme(this.getFrameName()),c=n.getFirstIndex(),f=n.getLastIndex();l=r.isChanged()||n.isUpdated()||i.isUpdated()?c:Math.max(c,f-2);for(var g=n.getColumnWidth(),_=n.getItemWidth()>>1,p=n.toItemLeft(l),m=n.toItemCenter(l),v=(n.getItemWidth(),[]),y=[],w=[],x=l;x<f;x++){var C=a.getDataAt(x),P=i.toY(C.high),k=i.toY(C.low),M=Math.max(k-P,1);if(C.close>C.open){var S=i.toY(C.close),E=i.toY(C.open);v.push({x:m,y:P,w:1,h:M}),v.push({x:p,y:S,w:_,h:1}),v.push({x:m,y:E,w:_,h:1})}else if(C.close===C.open){var O=i.toY(C.close);y.push({x:m,y:P,w:1,h:M}),y.push({x:p,y:O,w:_,h:1}),y.push({x:m,y:O,w:_,h:1})}else{var D=i.toY(C.open),A=i.toY(C.close);w.push({x:m,y:P,w:1,h:M}),w.push({x:p,y:D,w:_,h:1}),w.push({x:m,y:A,w:_,h:1})}p+=g,m+=g,g}v.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Positive),b.createRectangles(t,v),t.fill()),y.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Negative),b.createRectangles(t,y),t.fill()),w.length>0&&(t.fillStyle=u.getColor(h.Theme.Color.Negative),b.createRectangles(t,w),t.fill())}}}}]),e}();e.OHLCPlotter=A;var T=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName()),n=e.getDataSource(this.getDataSourceName()),i=e.getTheme(this.getFrameName());t.font=i.getFont(h.Theme.Font.Default),t.textAlign="left",t.textBaseline="top",t.fillStyle=i.getColor(h.Theme.Color.Text4);var l={x:a.getLeft()+4,y:a.getTop()+2,w:a.getWidth()-8,h:20},u=r.getSelectedIndex();if(!(u<0)){var c,d=n.getDataAt(u),f=n.getDecimalDigits(),g=new Date(d.date),_=(g.getFullYear(),o.Util.formatTime(g.getMonth()+1),o.Util.formatTime(g.getDate()),o.Util.formatTime(g.getHours()),o.Util.formatTime(g.getMinutes()),e.getLanguage());if("zh-cn"===_){if(!b.drawString(t,"  开: "+d.open.toFixed(f),l))return;if(!b.drawString(t,"  高: "+d.high.toFixed(f),l))return;if(!b.drawString(t,"  低: "+d.low.toFixed(f),l))return;if(!b.drawString(t,"  收: "+d.close.toFixed(f),l))return}else if("en-us"===_){if(!b.drawString(t,"  O: "+d.open.toFixed(f),l))return;if(!b.drawString(t,"  H: "+d.high.toFixed(f),l))return;if(!b.drawString(t,"  L: "+d.low.toFixed(f),l))return;if(!b.drawString(t,"  C: "+d.close.toFixed(f),l))return}else if("zh-tw"===_){if(!b.drawString(t,"  開: "+d.open.toFixed(f),l))return;if(!b.drawString(t,"  高: "+d.high.toFixed(f),l))return;if(!b.drawString(t,"  低: "+d.low.toFixed(f),l))return;if(!b.drawString(t,"  收: "+d.close.toFixed(f),l))return}if(u>0){if("zh-cn"===_){if(!b.drawString(t,"  涨幅: ",l))return}else if("en-us"===_){if(!b.drawString(t,"  CHANGE: ",l))return}else if("zh-tw"===_&&!b.drawString(t,"  漲幅: ",l))return;var p,m=n.getDataAt(u-1);if((p=(d.close-m.close)/m.close*100?(d.close-m.close)/m.close*100:0)>=0?(p=" "+p.toFixed(2),t.fillStyle=i.getColor(h.Theme.Color.TextPositive)):(p=p.toFixed(2),t.fillStyle=i.getColor(h.Theme.Color.TextNegative)),!b.drawString(t,p,l))return;if(t.fillStyle=i.getColor(h.Theme.Color.Text4),!b.drawString(t," %",l))return}if(c=(d.high-d.low)/d.low*100?(d.high-d.low)/d.low*100:0,"zh-cn"===_){if(!b.drawString(t,"  振幅: "+c.toFixed(2)+" %",l))return}else if("en-us"===_){if(!b.drawString(t,"  AMPLITUDE: "+c.toFixed(2)+" %",l))return}else if("zh-tw"===_&&!b.drawString(t,"  振幅: "+c.toFixed(2)+" %",l))return;var v=e.getDataProvider(this.getAreaName()+".secondary");if(void 0!==v){var y,w=v.getIndicator(),x=w.getOutputCount();for(y=0;y<x;y++){var C=w.getOutputAt(y),P=C.execute(u);if(!isNaN(P)){var k="  "+C.getName()+": "+P.toFixed(f),M=C.getColor();if(void 0===M&&(M=h.Theme.Color.Indicator0+y),t.fillStyle=i.getColor(M),!b.drawString(t,k,l))return}}}}}}]),e}();e.MainInfoPlotter=T;var I=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName()),n=e.getRange(this.getAreaName());if(0!==n.getRange()){var i=e.getDataProvider(this.getName());if(o.Util.isInstance(i,c.IndicatorDataProvider)){var l,d=e.getTheme(this.getFrameName()),f=r.getColumnWidth(),g=r.getFirstIndex(),_=r.getLastIndex();l=a.isChanged()||r.isUpdated()||n.isUpdated()?g:Math.max(g,_-2);var p,m,v=i.getIndicator(),y=v.getOutputCount();for(m=0;m<y;m++){var w=(p=v.getOutputAt(m)).getStyle();w===u.OutputExpr.outputStyle.VolumeStick?this.drawVolumeStick(t,d,e.getDataSource(this.getDataSourceName()),l,_,r.toItemLeft(l),f,r.getItemWidth(),n):w===u.OutputExpr.outputStyle.MACDStick?this.drawMACDStick(t,d,p,l,_,r.toItemLeft(l),f,r.getItemWidth(),n):w===u.OutputExpr.outputStyle.SARPoint&&this.drawSARPoint(t,d,p,l,_,r.toItemCenter(l),f,r.getItemWidth(),n)}var x=r.toColumnLeft(l),C=r.toItemCenter(l);for(t.save(),t.rect(x,a.getTop(),a.getRight()-x,a.getHeight()),t.clip(),t.translate(.5,.5),m=0;m<y;m++){var P=C;if((p=v.getOutputAt(m)).getStyle()===u.OutputExpr.outputStyle.Line){var k=void 0,M=[];l>g&&(k=p.execute(l-1),!1===isNaN(k)&&M.push({x:P-f,y:n.toY(k)}));for(var S=l;S<_;S++,P+=f)k=p.execute(S),!1===isNaN(k)&&M.push({x:P,y:n.toY(k)});if(M.length>0){var E=p.getColor();void 0===E&&(E=h.Theme.Color.Indicator0+m),t.strokeStyle=d.getColor(E),b.drawLines(t,M)}}}t.restore()}}}},{key:"drawVolumeStick",value:function(t,e,a,r,n,i,s,l,u){for(var c=o.Util.isInstance(e,h.DarkTheme),d=i,f=(u.toY(0),[]),g=[],_=[],p=r;p<n;p++){var m=a.getDataAt(p),v=u.toY(m.volume),y=u.toHeight(m.volume);m.close>m.open?y>1&&l>1&&c?f.push({x:d+.5,y:v+.5,w:l-1,h:y-1}):g.push({x:d,y:v,w:Math.max(l,1),h:Math.max(y,1)}):m.close===m.open&&p>0&&m.close>=a.getDataAt(p-1).close?y>1&&l>1&&c?f.push({x:d+.5,y:v+.5,w:l-1,h:y-1}):g.push({x:d,y:v,w:Math.max(l,1),h:Math.max(y,1)}):_.push({x:d,y:v,w:Math.max(l,1),h:Math.max(y,1)}),d+=s}f.length>0&&(t.strokeStyle=e.getColor(h.Theme.Color.Positive),b.createRectangles(t,f),t.stroke()),g.length>0&&(t.fillStyle=e.getColor(h.Theme.Color.Positive),b.createRectangles(t,g),t.fill()),_.length>0&&(t.fillStyle=e.getColor(h.Theme.Color.Negative),b.createRectangles(t,_),t.fill())}},{key:"drawMACDStick",value:function(t,e,a,r,n,i,s,o,l){for(var u=i,c=l.toY(0),d=[],f=[],g=[],_=[],p=r>0?a.execute(r-1):NaN,m=r;m<n;m++){var v=a.execute(m);if(v>=0){var y=l.toHeight(v);(0===m||v>=p)&&y>1&&o>1?d.push({x:u+.5,y:c-y+.5,w:o-1,h:y-1}):g.push({x:u,y:c-y,w:Math.max(o,1),h:Math.max(y,1)})}else{var w=l.toHeight(-v);(0===m||v>=p)&&w>1&&o>1?f.push({x:u+.5,y:c+.5,w:o-1,h:w-1}):_.push({x:u,y:c,w:Math.max(o,1),h:Math.max(w,1)})}p=v,u+=s}d.length>0&&(t.strokeStyle=e.getColor(h.Theme.Color.Positive),b.createRectangles(t,d),t.stroke()),f.length>0&&(t.strokeStyle=e.getColor(h.Theme.Color.Negative),b.createRectangles(t,f),t.stroke()),g.length>0&&(t.fillStyle=e.getColor(h.Theme.Color.Positive),b.createRectangles(t,g),t.fill()),_.length>0&&(t.fillStyle=e.getColor(h.Theme.Color.Negative),b.createRectangles(t,_),t.fill())}},{key:"drawSARPoint",value:function(t,e,a,r,n,i,s,o,l){var u=o>>1;u<.5&&(u=.5),u>4&&(u=4);var c=i,d=c+u,f=2*Math.PI;t.save(),t.translate(.5,.5),t.strokeStyle=e.getColor(h.Theme.Color.Indicator3),t.beginPath();for(var g=r;g<n;g++){var _=l.toY(a.execute(g));t.moveTo(d,_),t.arc(c,_,u,0,f),c+=s,d+=s}t.stroke(),t.restore()}}]),e}();e.IndicatorPlotter=I;var R=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName()),n=e.getDataProvider(this.getAreaName()+".secondary"),i=e.getTheme(this.getFrameName());t.font=i.getFont(h.Theme.Font.Default),t.textAlign="left",t.textBaseline="top",t.fillStyle=i.getColor(h.Theme.Color.Text4);var o,l={x:a.getLeft()+4,y:a.getTop()+2,w:a.getWidth()-8,h:20},u=n.getIndicator();switch(u.getParameterCount()){case 0:o=u.getName();break;case 1:o=u.getName()+"("+u.getParameterAt(0).getValue()+")";break;case 2:o=u.getName()+"("+u.getParameterAt(0).getValue()+","+u.getParameterAt(1).getValue()+")";break;case 3:o=u.getName()+"("+u.getParameterAt(0).getValue()+","+u.getParameterAt(1).getValue()+","+u.getParameterAt(2).getValue()+")";break;case 4:o=u.getName()+"("+u.getParameterAt(0).getValue()+","+u.getParameterAt(1).getValue()+","+u.getParameterAt(2).getValue()+","+u.getParameterAt(3).getValue()+")";break;default:return}if(b.drawString(t,o,l)){var c=r.getSelectedIndex();if(!(c<0)){var d,f,g,_,p,m=u.getOutputCount();for(p=0;p<m;p++)if(f=(d=u.getOutputAt(p)).execute(c),!isNaN(f)&&(g="  "+d.getName()+": "+f.toFixed(2),void 0===(_=d.getColor())&&(_=h.Theme.Color.Indicator0+p),t.fillStyle=i.getColor(_),!b.drawString(t,g,l)))return}}}}]),e}();e.IndicatorInfoPlotter=R;var j=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=e.getDataSource(this.getDataSourceName());if(!(a.getDataCount()<1)){var r=e.getTimeline(this.getDataSourceName());if(!(r.getInnerWidth()<r.getColumnWidth())){var n=e.getRange(this.getAreaName());if(0!==n.getRange()){var i=e.getDataProvider(this.getAreaName()+".main"),o=r.getFirstIndex(),l=o+r.getLastIndex()>>1,u=e.getTheme(this.getFrameName());t.font=u.getFont(h.Theme.Font.Default),t.textBaseline="middle",t.fillStyle=u.getColor(h.Theme.Color.Text4),t.strokeStyle=u.getColor(h.Theme.Color.Text4);var c=a.getDecimalDigits();this.drawMark(t,i.getMinValue(),c,n.toY(i.getMinValue()),o,l,i.getMinValueIndex(),r),this.drawMark(t,i.getMaxValue(),c,n.toY(i.getMaxValue()),o,l,i.getMaxValueIndex(),r)}}}}},{key:"drawMark",value:function(t,e,a,r,n,i,s,l){var u,h,c,d;s>i?(t.textAlign="right",c=(u=l.toItemCenter(s)-4)-3,d=(h=u-7)-4):(t.textAlign="left",c=(u=l.toItemCenter(s)+4)+3,d=(h=u+7)+4),b.drawLine(t,u,r,h,r),b.drawLine(t,u,r,c,r+2),b.drawLine(t,u,r,c,r-2),t.fillText(o.Util.fromFloat(e,a),d,r)}}]),e}();e.MinMaxPlotter=j;var L=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var a=s.ChartManager.instance,r=a.getArea(this.getAreaName()),n=a.getTimeline(this.getDataSourceName());if(r.isChanged()||n.isUpdated()){var i=a.getDataSource(this.getDataSourceName());if(!(i.getDataCount()<2)){var o,l=i.getDataAt(1).date-i.getDataAt(0).date,u=e.TIME_INTERVAL.length;for(o=0;o<u&&!(l<e.TIME_INTERVAL[o]);o++);for(;o<u&&!(e.TIME_INTERVAL[o]%l==0&&e.TIME_INTERVAL[o]/l*n.getColumnWidth()>60);o++);var c=n.getFirstIndex(),d=n.getLastIndex(),f=60*(new Date).getTimezoneOffset()*1e3,g=a.getTheme(this.getFrameName());t.font=g.getFont(h.Theme.Font.Default),t.textAlign="center",t.textBaseline="middle";for(var _=a.getLanguage(),p=[],m=r.getTop(),v=r.getMiddle(),y=c;y<d;y++){var w=i.getDataAt(y).date,x=w-f,C=new Date(w),P=C.getFullYear(),k=C.getMonth()+1,M=C.getDate(),S=C.getHours(),E=C.getMinutes(),O="";if(o<u){if(x%Math.max(e.TP_DAY,e.TIME_INTERVAL[o])==0)"zh-cn"===_?O=k.toString()+"月"+M.toString()+"日":"zh-tw"===_?O=k.toString()+"月"+M.toString()+"日":"en-us"===_&&(O=e.MonthConvert[k]+" "+M.toString()),t.fillStyle=g.getColor(h.Theme.Color.Text4);else if(x%e.TIME_INTERVAL[o]==0){var D=E.toString();E<10&&(D="0"+D),O=S.toString()+":"+D,t.fillStyle=g.getColor(h.Theme.Color.Text2)}}else 1===M&&S<l/e.TP_HOUR&&(1===k?(O=P.toString(),"zh-cn"===_?O+="年":"zh-tw"===_&&(O+="年")):"zh-cn"===_?O=k.toString()+"月":"zh-tw"===_?O=k.toString()+"月":"en-us"===_&&(O=e.MonthConvert[k]),t.fillStyle=g.getColor(h.Theme.Color.Text4));if(O.length>0){var A=n.toItemCenter(y);p.push({x:A,y:m,w:1,h:4}),t.fillText(O,A,v)}}p.length>0&&(t.fillStyle=g.getColor(h.Theme.Color.Grid1),b.createRectangles(t,p),t.fill())}}}}]),e}();e.TimelinePlotter=L,L.TP_MINUTE=6e4,L.TP_HOUR=60*L.TP_MINUTE,L.TP_DAY=24*L.TP_HOUR,L.TIME_INTERVAL=[5*L.TP_MINUTE,10*L.TP_MINUTE,15*L.TP_MINUTE,30*L.TP_MINUTE,L.TP_HOUR,2*L.TP_HOUR,3*L.TP_HOUR,6*L.TP_HOUR,12*L.TP_HOUR,L.TP_DAY,2*L.TP_DAY],L.MonthConvert={1:"Jan.",2:"Feb.",3:"Mar.",4:"Apr.",5:"May.",6:"Jun.",7:"Jul.",8:"Aug.",9:"Sep.",10:"Oct.",11:"Nov.",12:"Dec."};var N=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"getRequiredWidth",value:function(t,e){var a=s.ChartManager.instance.getTheme(this.getFrameName());return t.font=a.getFont(h.Theme.Font.Default),t.measureText((Math.floor(e)+.88).toString()).width+16}},{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=this.getAreaName(),r=e.getArea(a),n=a.substring(0,a.lastIndexOf("Range")),i=e.getRange(n);if(0!==i.getRange()){if("main"===i.getNameObject().getCompAt(2));else if(!r.isChanged()&&!i.isUpdated())return;var l=i.getGradations();if(0!==l.length){var u=r.getLeft(),c=r.getRight(),d=r.getCenter(),f=e.getTheme(this.getFrameName());t.font=f.getFont(h.Theme.Font.Default),t.textAlign="center",t.textBaseline="middle",t.fillStyle=f.getColor(h.Theme.Color.Text2);var g=[];for(var _ in l){var p=i.toY(l[_]);g.push({x:u,y:p,w:6,h:1}),g.push({x:c-6,y:p,w:6,h:1}),t.fillText(o.Util.fromFloat(l[_],2),d,p)}g.length>0&&(t.fillStyle=f.getColor(h.Theme.Color.Grid1),b.createRectangles(t,g),t.fill())}}}}]),e}();e.RangePlotter=N;var V=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"Draw",value:function(t){return this._Draw_(t)}},{key:"_Draw_",value:function(t){if(!1!==this.Update()&&!1!==this.updateData()){this.m_top=this.m_pArea.getTop(),this.m_bottom=this.m_pArea.getBottom(),this.m_left=this.m_pArea.getLeft(),this.m_right=this.m_pArea.getRight(),t.save(),t.rect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top),t.clip();var e=s.ChartManager.instance.getChart()._depthData;this.x_offset=0,this.y_offset=0;var a={},r={};a.x=this.m_left+e.array[this.m_ask_si].amounts*this.m_Step,a.y=this.m_pRange.toY(e.array[this.m_ask_si].rate),r.x=this.m_left+e.array[this.m_bid_si].amounts*this.m_Step,r.y=this.m_pRange.toY(e.array[this.m_bid_si].rate),Math.abs(a.y-r.y)<1&&(this.y_offset=1),this.x_offset=1,this.DrawBackground(t),this.UpdatePoints(),this.FillBlack(t),this.DrawGradations(t),this.DrawLine(t),t.restore()}}},{key:"DrawBackground",value:function(t){t.fillStyle=this.m_pTheme.getColor(h.Theme.Color.Background),t.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top);var e=s.ChartManager.instance.getChart()._depthData;if(0===this.m_mode){var a=this.m_pRange.toY(e.array[this.m_ask_si].rate)-this.y_offset,r=this.m_pRange.toY(e.array[this.m_bid_si].rate)+this.y_offset,n=t.createLinearGradient(this.m_left,0,this.m_right,0);n.addColorStop(0,this.m_pTheme.getColor(h.Theme.Color.Background)),n.addColorStop(1,this.m_pTheme.getColor(h.Theme.Color.PositiveDark)),t.fillStyle=n,t.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,a-this.m_top);var i=t.createLinearGradient(this.m_left,0,this.m_right,0);i.addColorStop(0,this.m_pTheme.getColor(h.Theme.Color.Background)),i.addColorStop(1,this.m_pTheme.getColor(h.Theme.Color.NegativeDark)),t.fillStyle=i,t.fillRect(this.m_left,r,this.m_right-this.m_left,this.m_bottom-r)}else if(1===this.m_mode){var o=t.createLinearGradient(this.m_left,0,this.m_right,0);o.addColorStop(0,this.m_pTheme.getColor(h.Theme.Color.Background)),o.addColorStop(1,this.m_pTheme.getColor(h.Theme.Color.PositiveDark)),t.fillStyle=o,t.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top)}else if(2===this.m_mode){var l=t.createLinearGradient(this.m_left,0,this.m_right,0);l.addColorStop(0,this.m_pTheme.getColor(h.Theme.Color.Background)),l.addColorStop(1,this.m_pTheme.getColor(h.Theme.Color.NegativeDark)),t.fillStyle=l,t.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top)}}},{key:"DrawLine",value:function(t){if(0===this.m_mode||1===this.m_mode){t.strokeStyle=this.m_pTheme.getColor(h.Theme.Color.Positive),t.beginPath(),t.moveTo(Math.floor(this.m_ask_points[0].x)+.5,Math.floor(this.m_ask_points[0].y)+.5);for(var e=1;e<this.m_ask_points.length;e++)t.lineTo(Math.floor(this.m_ask_points[e].x)+.5,Math.floor(this.m_ask_points[e].y)+.5);t.stroke()}if(0===this.m_mode||2===this.m_mode){t.strokeStyle=this.m_pTheme.getColor(h.Theme.Color.Negative),t.beginPath(),t.moveTo(this.m_bid_points[0].x+.5,this.m_bid_points[0].y+.5);for(var a=1;a<this.m_bid_points.length;a++)t.lineTo(this.m_bid_points[a].x+.5,this.m_bid_points[a].y+.5);t.stroke()}}},{key:"UpdatePoints",value:function(){var t=s.ChartManager.instance.getChart()._depthData;this.m_ask_points=[];var e={};e.x=Math.floor(this.m_left),e.y=Math.floor(this.m_pRange.toY(t.array[this.m_ask_si].rate)-this.y_offset),this.m_ask_points.push(e);for(var a=0,r=this.m_ask_si;r>=this.m_ask_ei;r--){var n={},i={};r===this.m_ask_si?(n.x=Math.floor(this.m_left+t.array[r].amounts*this.m_Step+this.x_offset),n.y=Math.floor(this.m_pRange.toY(t.array[r].rate)-this.y_offset),this.m_ask_points.push(n),a=1):(n.x=Math.floor(this.m_left+t.array[r].amounts*this.m_Step+this.x_offset),n.y=Math.floor(this.m_ask_points[a].y),i.x=Math.floor(n.x),i.y=Math.floor(this.m_pRange.toY(t.array[r].rate)-this.y_offset),this.m_ask_points.push(n),a++,this.m_ask_points.push(i),a++)}this.m_bid_points=[];var o={};o.x=Math.floor(this.m_left),o.y=Math.ceil(this.m_pRange.toY(t.array[this.m_bid_si].rate)+this.y_offset),this.m_bid_points.push(o);for(var l=0,u=this.m_bid_si;u<=this.m_bid_ei;u++){var h={},c={};u===this.m_bid_si?(h.x=Math.floor(this.m_left+t.array[u].amounts*this.m_Step+this.x_offset),h.y=Math.ceil(this.m_pRange.toY(t.array[u].rate)+this.y_offset),this.m_bid_points.push(h),l=1):(h.x=Math.floor(this.m_left+t.array[u].amounts*this.m_Step+this.x_offset),h.y=Math.ceil(this.m_bid_points[l].y),c.x=Math.floor(h.x),c.y=Math.ceil(this.m_pRange.toY(t.array[u].rate)+this.x_offset),this.m_bid_points.push(h),l++,this.m_bid_points.push(c),l++)}}},{key:"updateData",value:function(){var t=s.ChartManager.instance.getChart()._depthData;if(null===t.array)return!1;if(t.array.length<=50)return!1;var e=this.m_pRange.getOuterMinValue(),a=this.m_pRange.getOuterMaxValue();this.m_ask_si=t.asks_si,this.m_ask_ei=t.asks_si;for(var r=t.asks_si;r>=t.asks_ei&&t.array[r].rate<a;r--)this.m_ask_ei=r;this.m_bid_si=t.bids_si,this.m_bid_ei=t.bids_si;for(var n=t.bids_si;n<=t.bids_ei&&t.array[n].rate>e;n++)this.m_bid_ei=n;return this.m_ask_ei===this.m_ask_si?this.m_mode=2:this.m_bid_ei===this.m_bid_si?this.m_mode=1:this.m_mode=0,this.m_Step=this.m_pArea.getWidth(),0===this.m_mode?this.m_ask_ei===t.asks_ei&&this.m_bid_ei===t.bids_ei?this.m_Step/=Math.min(t.array[this.m_ask_ei].amounts,t.array[this.m_bid_ei].amounts):this.m_ask_ei!==t.asks_ei&&this.m_bid_ei===t.bids_ei?this.m_Step/=t.array[this.m_bid_ei].amounts:this.m_ask_ei===t.asks_ei&&this.m_bid_ei!==t.bids_ei?this.m_Step/=t.array[this.m_ask_ei].amounts:this.m_ask_ei!==t.asks_ei&&this.m_bid_ei!==t.bids_ei&&(this.m_Step/=Math.max(t.array[this.m_ask_ei].amounts,t.array[this.m_bid_ei].amounts)):1===this.m_mode?this.m_Step/=t.array[this.m_ask_ei].amounts:2===this.m_mode&&(this.m_Step/=t.array[this.m_bid_ei].amounts),!0}},{key:"Update",value:function(){this.m_pMgr=s.ChartManager.instance;var t=this.getAreaName();if(this.m_pArea=this.m_pMgr.getArea(t),null===this.m_pArea)return!1;var e=t.substring(0,t.lastIndexOf("Range"));return this.m_pRange=this.m_pMgr.getRange(e),null!==this.m_pRange&&0!==this.m_pRange.getRange()&&(this.m_pTheme=this.m_pMgr.getTheme(this.getFrameName()),null!==this.m_pTheme)}},{key:"DrawGradations",value:function(t){var e=s.ChartManager.instance,a=this.getAreaName(),r=e.getArea(a),n=a.substring(0,a.lastIndexOf("Range")),i=e.getRange(n);if(0!==i.getRange()){var o=i.getGradations();if(0!==o.length){var l=r.getLeft(),u=r.getRight(),c=[];for(var d in o){var f=i.toY(o[d]);c.push({x:l,y:f,w:6,h:1}),c.push({x:u-6,y:f,w:6,h:1})}if(c.length>0){var g=e.getTheme(this.getFrameName());t.fillStyle=g.getColor(h.Theme.Color.Grid1),b.createRectangles(t,c),t.fill()}}}}},{key:"FillBlack",value:function(t){var e=this.m_ask_points,a=this.m_bid_points,r={},n={};r.x=this.m_right,r.y=e[0].y,n.x=this.m_right,n.y=e[e.length-1].y;var i={},s={};i.x=this.m_right,i.y=a[0].y-1,s.x=this.m_right,s.y=a[a.length-1].y,e.unshift(r),e.push(n),a.unshift(i),a.push(s),t.fillStyle=this.m_pTheme.getColor(h.Theme.Color.Background),t.beginPath(),t.moveTo(Math.floor(e[0].x)+.5,Math.floor(e[0].y)+.5);for(var o=1;o<e.length;o++)t.lineTo(Math.floor(e[o].x)+.5,Math.floor(e[o].y)+.5);t.fill(),t.beginPath(),t.moveTo(Math.floor(a[0].x)+.5,Math.floor(a[0].y)+.5);for(var l=1;l<a.length;l++)t.lineTo(Math.floor(a[l].x)+.5,Math.floor(a[l].y)+.5);t.fill(),e.shift(),e.pop(),a.shift(),a.pop()}},{key:"DrawTickerGraph",value:function(t){var e=s.ChartManager.instance.getDataSource(this.getDataSourceName()),a=e._dataItems[e._dataItems.length-1].close;this.m_left,this.m_pRange.toY(a);t.fillStyle=this.m_pTheme.getColor(h.Theme.Color.Mark),t.strokeStyle=this.m_pTheme.getColor(h.Theme.Color.Mark)}}]),e}();e.COrderGraphPlotter=V;var F=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=(e.getTimeline(this.getDataSourceName()),this.getAreaName()),r=e.getArea(a),n=a.substring(0,a.lastIndexOf("Range")),i=e.getRange(n);if(0!==i.getRange()){var l=e.getDataSource(this.getDataSourceName());if(!(l.getDataCount()<1)){var u=e.getTheme(this.getFrameName());t.font=u.getFont(h.Theme.Font.Default),t.textAlign="left",t.textBaseline="middle",t.fillStyle=u.getColor(h.Theme.Color.RangeMark),t.strokeStyle=u.getColor(h.Theme.Color.RangeMark);var c=l.getDataAt(l.getDataCount()-1).volume,d=i.toY(c),f=r.getLeft()+1;b.drawLine(t,f,d,f+7,d),b.drawLine(t,f,d,f+3,d+2),b.drawLine(t,f,d,f+3,d-2),t.fillText(o.Util.fromFloat(c,2),f+10,d)}}}}]),e}();e.LastVolumePlotter=F;var B=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=(e.getTimeline(this.getDataSourceName()),this.getAreaName()),r=e.getArea(a),n=a.substring(0,a.lastIndexOf("Range")),i=e.getRange(n);if(0!==i.getRange()){var l=e.getDataSource(this.getDataSourceName());if(!(l.getDataCount()<1)){var u=l._dataItems[l._dataItems.length-1].close;if(!(u<=i.getMinValue()||u>=i.getMaxValue())){var c=e.getTheme(this.getFrameName());t.font=c.getFont(h.Theme.Font.Default),t.textAlign="left",t.textBaseline="middle",t.fillStyle=c.getColor(h.Theme.Color.RangeMark),t.strokeStyle=c.getColor(h.Theme.Color.RangeMark);var d=i.toY(u),f=r.getLeft()+1;b.drawLine(t,f,d,f+7,d),b.drawLine(t,f,d,f+3,d+2),b.drawLine(t,f,d,f+3,d-2),t.fillText(o.Util.fromFloat(u,l.getDecimalDigits()),f+10,d)}}}}}]),e}();e.LastClosePlotter=B;var H=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance;if(e._drawingTool===s.ChartManager.DrawingTool.CrossCursor){var a=e.getArea(this.getAreaName()),r=e.getTimeline(this.getDataSourceName());if(!(r.getSelectedIndex()<0)){var n=e.getRange(this.getAreaName()),i=e.getTheme(this.getFrameName());t.strokeStyle=i.getColor(h.Theme.Color.Cursor);var o=r.toItemCenter(r.getSelectedIndex());b.drawLine(t,o,a.getTop()-1,o,a.getBottom());var l=n.getSelectedPosition();l>=0&&b.drawLine(t,a.getLeft(),l,a.getRight(),l)}}}}]),e}();e.SelectionPlotter=H;var z=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,b),v(e,[{key:"Draw",value:function(t){var a=s.ChartManager.instance,r=a.getArea(this.getAreaName()),i=a.getTimeline(this.getDataSourceName());if(!(i.getSelectedIndex()<0)){var l=a.getDataSource(this.getDataSourceName());if(o.Util.isInstance(l,d.MainDataSource)){var u=a.getTheme(this.getFrameName()),c=a.getLanguage(),f=i.toItemCenter(i.getSelectedIndex());t.fillStyle=u.getColor(h.Theme.Color.Background),t.fillRect(f-52.5,r.getTop()+2.5,106,18),t.strokeStyle=u.getColor(h.Theme.Color.Grid3),t.strokeRect(f-52.5,r.getTop()+2.5,106,18),t.font=u.getFont(h.Theme.Font.Default),t.textAlign="center",t.textBaseline="middle",t.fillStyle=u.getColor(h.Theme.Color.Text4);var g=new Date(l.getDataAt(i.getSelectedIndex()).date),_=g.getMonth()+1,p=g.getDate(),m=g.getHours(),v=g.getMinutes(),y=g.getSeconds(),w=_.toString(),x=p.toString(),C=m.toString(),b=v.toString(),P=y.toString();v<10&&(b="0"+b),y<10&&(P="0"+P);var k="";"zh-cn"===c?k=w+"月"+x+"日  "+C+":"+b:"zh-tw"===c?k=w+"月"+x+"日  "+C+":"+b:"en-us"===c&&(k=e.MonthConvert[_]+" "+x+"  "+C+":"+b),n.default.instance.range<6e4&&(k+=":"+P),t.fillText(k,f,r.getMiddle())}}}}]),e}();e.TimelineSelectionPlotter=z,z.MonthConvert={1:"Jan.",2:"Feb.",3:"Mar.",4:"Apr.",5:"May.",6:"Jun.",7:"Jul.",8:"Aug.",9:"Sep.",10:"Oct.",11:"Nov.",12:"Dec."};var U=function(t){function e(t){return p(this,e),y(this,w(e).call(this,t))}return x(e,i.NamedObject),v(e,[{key:"Draw",value:function(t){var e=s.ChartManager.instance,a=this.getAreaName(),r=e.getArea(a);if(!(e.getTimeline(this.getDataSourceName()).getSelectedIndex()<0)){var n=a.substring(0,a.lastIndexOf("Range")),i=e.getRange(n);if(!(0===i.getRange()||i.getSelectedPosition()<0)){var l=i.getSelectedValue();if(l!==-Number.MAX_VALUE){var u=i.getSelectedPosition();b.createPolygon(t,[{x:r.getLeft(),y:u},{x:r.getLeft()+5,y:u+10},{x:r.getRight()-3,y:u+10},{x:r.getRight()-3,y:u-10},{x:r.getLeft()+5,y:u-10}]);var c=e.getTheme(this.getFrameName());t.fillStyle=c.getColor(h.Theme.Color.Background),t.fill(),t.strokeStyle=c.getColor(h.Theme.Color.Grid4),t.stroke(),t.font=c.getFont(h.Theme.Font.Default),t.textAlign="center",t.textBaseline="middle",t.fillStyle=c.getColor(h.Theme.Color.Text3);var d=2;"main"===i.getNameObject().getCompAt(2)&&(d=e.getDataSource(this.getDataSourceName()).getDecimalDigits()),t.fillText(o.Util.fromFloat(l,d),r.getCenter(),u)}}}}}]),e}();e.RangeSelectionPlotter=U;var Y=function(t){function e(t,a){var r;p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a;var n=s.ChartManager.instance.getArea("frame0.k0.main");return null===n?(r.areaPos={left:0,top:0,right:0,bottom:0},y(r)):(r.areaPos={left:n.getLeft(),top:n.getTop(),right:n.getRight(),bottom:n.getBottom()},r.crossPt={},r.normalSize=4,r.selectedSize=6,r.cursorLen=4,r.cursorGapLen=3,r.theme=s.ChartManager.instance.getTheme(r.getFrameName()),r)}return x(e,i.NamedObject),v(e,[{key:"drawCursor",value:function(t){this.drawCrossCursor(t)}},{key:"drawCrossCursor",value:function(t){t.strokeStyle=this.theme.getColor(h.Theme.Color.LineColorNormal),t.fillStyle=this.theme.getColor(h.Theme.Color.LineColorNormal);var e=this.toolObject.getPoint(0).getPosXY();if(null!==e){var a=e.x,r=e.y,n=this.cursorLen,i=this.cursorGapLen;t.fillRect(a,r,1,1),b.drawLine(t,a-n-i,r,a-i,r),b.drawLine(t,a+n+i,r,a+i,r),b.drawLine(t,a,r-n-i,a,r-i),b.drawLine(t,a,r+n+i,a,r+i)}}},{key:"drawCircle",value:function(t,e,a){var r=e.x,n=e.y;t.beginPath(),t.arc(r,n,a,0,2*Math.PI,!1),t.fillStyle=this.theme.getColor(h.Theme.Color.CircleColorFill),t.fill(),t.stroke()}},{key:"drawCtrlPt",value:function(t){t.strokeStyle=this.theme.getColor(h.Theme.Color.CircleColorStroke);for(var e=0;e<this.ctrlPtsNum;e++)this.drawCircle(t,this.ctrlPts[1][e],this.normalSize)}},{key:"highlightCtrlPt",value:function(t){t.strokeStyle=this.theme.getColor(h.Theme.Color.CircleColorStroke);for(var e=0;e<this.ctrlPtsNum;e++)this.toolObject.getPoint(e).getState()===l.CPoint.state.Highlight&&this.drawCircle(t,this.ctrlPts[1][e],this.selectedSize)}},{key:"drawFibRayLines",value:function(t,e,a){for(var r=0;r<this.fiboFansSequence.length;r++){var n=e.y+(100-this.fiboFansSequence[r])/100*(a.y-e.y),i={x:e.x,y:e.y},s={x:a.x,y:n};this.drawRayLines(t,i,s)}}},{key:"drawRayLines",value:function(t,e,a){this.getAreaPos();var r,n={x:e.x,y:e.y},i={x:a.x,y:a.y},s=this.getRectCrossPt(this.areaPos,n,i);r=a.x===e.x?a.y===e.y?a:a.y>e.y?{x:s[1].x,y:s[1].y}:{x:s[0].x,y:s[0].y}:a.x>e.x?{x:s[1].x,y:s[1].y}:{x:s[0].x,y:s[0].y},b.drawLine(t,e.x,e.y,r.x,r.y)}},{key:"lenBetweenPts",value:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}},{key:"getCtrlPts",value:function(){for(var t=0;t<this.ctrlPtsNum;t++)this.ctrlPts[0][t]=this.toolObject.getPoint(t)}},{key:"updateCtrlPtPos",value:function(){for(var t=0;t<this.ctrlPtsNum;t++)this.ctrlPts[1][t]=this.ctrlPts[0][t].getPosXY()}},{key:"getAreaPos",value:function(){var t=s.ChartManager.instance.getArea("frame0.k0.main");this.areaPos=null!==t?{left:Math.floor(t.getLeft()),top:Math.floor(t.getTop()),right:Math.floor(t.getRight()),bottom:Math.floor(t.getBottom())}:{left:0,top:0,right:0,bottom:0}}},{key:"updateDraw",value:function(t){t.strokeStyle=this.theme.getColor(h.Theme.Color.LineColorNormal),this.draw(t),this.drawCtrlPt(t)}},{key:"finishDraw",value:function(t){t.strokeStyle=this.theme.getColor(h.Theme.Color.LineColorNormal),this.draw(t)}},{key:"highlight",value:function(t){t.strokeStyle=this.theme.getColor(h.Theme.Color.LineColorSelected),this.draw(t),this.drawCtrlPt(t),this.highlightCtrlPt(t)}}]),e}();e.CToolPlotter=Y;var q=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y?b.drawLine(t,this.areaPos.left,this.startPoint.y,this.areaPos.right,this.startPoint.y):(this.crossPt=this.getRectCrossPt(this.areaPos,this.startPoint,this.endPoint),b.drawLine(t,this.crossPt[0].x,this.crossPt[0].y,this.crossPt[1].x,this.crossPt[1].y))}}]),e}();e.DrawStraightLinesPlotter=q;var X=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y&&(this.endPoint.x+=1),b.drawLine(t,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y)}}]),e}();e.DrawSegLinesPlotter=X;var G=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y&&(this.endPoint.x+=1),this.drawRayLines(t,this.startPoint,this.endPoint)}}]),e}();e.DrawRayLinesPlotter=G;var W=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.arrowSizeRatio=.03,r.arrowSize=4,r.crossPt={x:-1,y:-1},r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"drawArrow",value:function(t,e,a){var r=this.lenBetweenPts(e,a),n=[a.x-e.x,a.y-e.y];this.crossPt.x=e.x+(1-this.arrowSize/r)*n[0],this.crossPt.y=e.y+(1-this.arrowSize/r)*n[1];var i=[-n[1],n[0]],s={x:i[0],y:i[1]},o={x:0,y:0};i[0]=this.arrowSize*s.x/this.lenBetweenPts(s,o),i[1]=this.arrowSize*s.y/this.lenBetweenPts(s,o);var l=[this.crossPt.x+i[0],this.crossPt.y+i[1]];b.drawLine(t,a.x,a.y,l[0],l[1]),l=[this.crossPt.x-i[0],this.crossPt.y-i[1]],b.drawLine(t,a.x,a.y,l[0],l[1])}},{key:"draw",value:function(t){this.updateCtrlPtPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y&&(this.endPoint.x+=1),b.drawLine(t,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y),this.drawArrow(t,this.startPoint,this.endPoint)}}]),e}();e.DrawArrowLinesPlotter=W;var $=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.ctrlPtsNum=1,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],b.drawLine(t,this.areaPos.left,this.startPoint.y,this.areaPos.right,this.startPoint.y)}}]),e}();e.DrawHoriStraightLinesPlotter=$;var K=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){if(this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.startPoint.x===this.endPoint.x)b.drawLine(t,this.startPoint.x,this.startPoint.y,this.areaPos.right,this.startPoint.y);else{var e={x:this.endPoint.x,y:this.startPoint.y};this.drawRayLines(t,this.startPoint,e)}}}]),e}();e.DrawHoriRayLinesPlotter=K;var J=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.endPoint.y=this.startPoint.y,this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y?b.drawLine(t,this.startPoint.x,this.startPoint.y,this.endPoint.x+1,this.startPoint.y):b.drawLine(t,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.startPoint.y)}}]),e}();e.DrawHoriSegLinesPlotter=J;var Z=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.ctrlPtsNum=1,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],b.drawLine(t,this.startPoint.x,this.areaPos.top,this.startPoint.x,this.areaPos.bottom)}}]),e}();e.DrawVertiStraightLinesPlotter=Z;var Q=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.ctrlPtsNum=1,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"draw",value:function(t){t.font="12px Tahoma",t.textAlign="left",t.fillStyle=this.theme.getColor(h.Theme.Color.LineColorNormal),this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0];var e=this.ctrlPts[0][0].getPosIV().v;b.drawLine(t,this.startPoint.x,this.startPoint.y,this.areaPos.right,this.startPoint.y),t.fillText(e.toFixed(2),this.startPoint.x+2,this.startPoint.y-15)}}]),e}();e.DrawPriceLinesPlotter=Q;var tt=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r}return x(e,Y),v(e,[{key:"getParaPt",value:function(){var t=[];t[0]=this.endPoint.x-this.startPoint.x,t[1]=this.endPoint.y-this.startPoint.y;var e=[];e[0]=this.paraStartPoint.x-this.startPoint.x,e[1]=this.paraStartPoint.y-this.startPoint.y,this.paraEndPoint={x:-1,y:-1},this.paraEndPoint.x=t[0]+e[0]+this.startPoint.x,this.paraEndPoint.y=t[1]+e[1]+this.startPoint.y}}]),e}();e.ParallelLinesPlotter=tt;var et=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.ctrlPtsNum=3,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,tt),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.paraStartPoint=this.ctrlPts[1][1],this.endPoint=this.ctrlPts[1][2],this.getParaPt(),this.getAreaPos(),this.crossPt0=this.getRectCrossPt(this.areaPos,this.startPoint,this.endPoint),b.drawLine(t,this.crossPt0[0].x,this.crossPt0[0].y,this.crossPt0[1].x,this.crossPt0[1].y),this.crossPt1=this.getRectCrossPt(this.areaPos,this.paraStartPoint,this.paraEndPoint),b.drawLine(t,this.crossPt1[0].x,this.crossPt1[0].y,this.crossPt1[1].x,this.crossPt1[1].y)}}]),e}();e.DrawBiParallelLinesPlotter=et;var at=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.ctrlPtsNum=3,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,tt),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.paraStartPoint=this.ctrlPts[1][1],this.endPoint=this.ctrlPts[1][2],this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y&&(this.endPoint.x+=1),this.getParaPt(),this.drawRayLines(t,this.startPoint,this.endPoint),this.drawRayLines(t,this.paraStartPoint,this.paraEndPoint)}}]),e}();e.DrawBiParallelRayLinesPlotter=at;var rt=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.ctrlPtsNum=3,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,tt),v(e,[{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.paraStartPoint=this.ctrlPts[1][1],this.endPoint=this.ctrlPts[1][2];var e=[];e[0]=this.endPoint.x-this.startPoint.x,e[1]=this.endPoint.y-this.startPoint.y;var a=[];a[0]=this.paraStartPoint.x-this.startPoint.x,a[1]=this.paraStartPoint.y-this.startPoint.y,this.para1EndPoint={x:-1,y:-1},this.para2EndPoint={x:-1,y:-1},this.para2StartPoint={x:-1,y:-1},this.para1EndPoint.x=e[0]+a[0]+this.startPoint.x,this.para1EndPoint.y=e[1]+a[1]+this.startPoint.y,this.para2StartPoint.x=this.startPoint.x-a[0],this.para2StartPoint.y=this.startPoint.y-a[1],this.para2EndPoint.x=this.endPoint.x-a[0],this.para2EndPoint.y=this.endPoint.y-a[1],this.getAreaPos(),this.crossPt0=this.getRectCrossPt(this.areaPos,this.startPoint,this.endPoint),b.drawLine(t,this.crossPt0[0].x,this.crossPt0[0].y,this.crossPt0[1].x,this.crossPt0[1].y),this.crossPt1=this.getRectCrossPt(this.areaPos,this.paraStartPoint,this.para1EndPoint),b.drawLine(t,this.crossPt1[0].x,this.crossPt1[0].y,this.crossPt1[1].x,this.crossPt1[1].y),this.crossPt2=this.getRectCrossPt(this.areaPos,this.para2StartPoint,this.para2EndPoint),b.drawLine(t,this.crossPt2[0].x,this.crossPt2[0].y,this.crossPt2[1].x,this.crossPt2[1].y)}}]),e}();e.DrawTriParallelLinesPlotter=rt;var nt=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"drawLinesAndInfo",value:function(t,e,a){var r;t.font="12px Tahoma",t.textAlign="left",t.fillStyle=this.theme.getColor(h.Theme.Color.LineColorNormal),this.toolObject.state===f.CToolObject.state.Draw&&(this.startPtValue=this.toolObject.getPoint(0).getPosIV().v,this.endPtValue=this.toolObject.getPoint(1).getPosIV().v),this.getAreaPos();for(var n=0;n<this.fiboSequence.length;n++){var i=e.y+(100-this.fiboSequence[n])/100*(a.y-e.y);if(!(i>this.areaPos.bottom)){var s=this.startPtValue+(100-this.fiboSequence[n])/100*(this.endPtValue-this.startPtValue);b.drawLine(t,this.areaPos.left,i,this.areaPos.right,i),r=this.fiboSequence[n].toFixed(1)+"% "+s.toFixed(1),t.fillText(r,this.areaPos.left+2,i-15)}}}},{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.drawLinesAndInfo(t,this.startPoint,this.endPoint)}}]),e}();e.BandLinesPlotter=nt;var it=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.fiboSequence=[100,78.6,61.8,50,38.2,23.6,0],r}return x(e,nt),e}();e.DrawFibRetracePlotter=it;var st=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t,a))).toolObject=a,r.fiboSequence=[0,12.5,25,37.5,50,62.5,75,87.5,100],r}return x(e,nt),e}();e.DrawBandLinesPlotter=st;var ot=function(t){function e(t,a){var r;return p(this,e),(r=y(this,w(e).call(this,t))).toolObject=a,r.fiboFansSequence=[0,38.2,50,61.8],r.ctrlPtsNum=2,r.ctrlPts=[new Array(r.ctrlPtsNum),new Array(2)],r.getCtrlPts(),r}return x(e,Y),v(e,[{key:"drawLinesAndInfo",value:function(t,e,a){this.drawFibRayLines(t,e,a)}},{key:"draw",value:function(t){this.updateCtrlPtPos(),this.getAreaPos(),this.startPoint=this.ctrlPts[1][0],this.endPoint=this.ctrlPts[1][1],this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y&&(this.endPoint.x+=1),this.drawLinesAndInfo(t,this.startPoint,this.endPoint)}}]),e}();e.DrawFibFansPlotter=ot;var lt=function(t){function e(t){var a;return p(this,e),(a=y(this,w(e).call(this,t))).flag=!0,a.context=s.ChartManager.instance._overlayContext,a}return x(e,i.NamedObject),v(e,[{key:"getAreaPos",value:function(){var t=s.ChartManager.instance.getArea("frame0.k0.main");this.areaPos=null!==t?{left:Math.floor(t.getLeft()),top:Math.floor(t.getTop()),right:Math.floor(t.getRight()),bottom:Math.floor(t.getBottom())}:{left:0,top:0,right:0,bottom:0}}},{key:"Draw",value:function(t){this.getAreaPos();var e=s.ChartManager.instance.getDataSource(this.getDataSourceName());if(null!==e&&o.Util.isInstance(e,d.MainDataSource)){this.context.save(),this.context.rect(this.areaPos.left,this.areaPos.top,this.areaPos.right-this.areaPos.left,this.areaPos.bottom-this.areaPos.top),this.context.clip();for(var a=e.getToolObjectCount(),r=0;r<a;r++){var n=e.getToolObject(r);switch(n.getState()){case f.CToolObject.state.BeforeDraw:n.getPlotter().theme=s.ChartManager.instance.getTheme(this.getFrameName()),n.getPlotter().drawCursor(this.context);break;case f.CToolObject.state.Draw:n.getPlotter().theme=s.ChartManager.instance.getTheme(this.getFrameName()),n.getPlotter().updateDraw(this.context);break;case f.CToolObject.state.AfterDraw:n.getPlotter().theme=s.ChartManager.instance.getTheme(this.getFrameName()),n.getPlotter().finishDraw(this.context)}}var i=e.getSelectToolObjcet();null!==i&&i!==f.CToolObject.state.Draw&&i.getPlotter().highlight(this.context),this.context.restore()}}}]),e}();e.CDynamicLinePlotter=lt},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IndicatorDataProvider=e.MainDataProvider=e.DataProvider=void 0;var r=a(1),n=a(0),i=a(5),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}(a(2));function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,a){return e&&u(t.prototype,e),a&&u(t,a),t}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._minValue=0,a._maxValue=0,a._minValueIndex=-1,a._maxValueIndex=-1,a}return f(e,r.NamedObject),h(e,[{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"getMinValueIndex",value:function(){return this._minValueIndex}},{key:"getMaxValueIndex",value:function(){return this._maxValueIndex}},{key:"getMinMaxAt",value:function(t,e){return!0}},{key:"calcRange",value:function(t,e,a,r){for(var n=Number.MAX_VALUE,i=-Number.MAX_VALUE,s=-1,o=-1,l={},u=e-1,h=t.length-1;h>=0;h--){var c=t[h];if(u<c)a[h]={min:n,max:i};else{for(;u>=c;u--)!1!==this.getMinMaxAt(u,l)&&(n>l.min&&(n=l.min,s=u),i<l.max&&(i=l.max,o=u));a[h]={min:n,max:i}}null!==r&&void 0!==r&&(r[h]={minIndex:s,maxIndex:o})}}},{key:"updateRange",value:function(){var t=n.ChartManager.instance.getTimeline(this.getDataSourceName()),e=[t.getFirstIndex()],a=[{}],r=[{}];this.calcRange(e,t.getLastIndex(),a,r),this._minValue=a[0].min,this._maxValue=a[0].max,this._minValueIndex=r[0].minIndex,this._maxValueIndex=r[0].maxIndex}}]),e}();e.DataProvider=_;var p=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._candlestickDS=null,a}return f(e,_),h(e,[{key:"updateData",value:function(){var t=n.ChartManager.instance.getDataSource(this.getDataSourceName());i.Util.isInstance(t,s.MainDataSource)&&(this._candlestickDS=t)}},{key:"getMinMaxAt",value:function(t,e){var a=this._candlestickDS.getDataAt(t);return e.min=a.low,e.max=a.high,!0}}]),e}();e.MainDataProvider=p;var m=function(t){function e(){return l(this,e),c(this,d(e).apply(this,arguments))}return f(e,_),h(e,[{key:"getIndicator",value:function(){return this._indicator}},{key:"setIndicator",value:function(t){this._indicator=t,this.refresh()}},{key:"refresh",value:function(){var t=n.ChartManager.instance.getDataSource(this.getDataSourceName());if(!(t.getDataCount()<1)){var e,a=this._indicator,r=t.getDataCount();for(a.clear(),a.reserve(r),e=0;e<r;e++)a.execute(t,e)}}},{key:"updateData",value:function(){var t=n.ChartManager.instance.getDataSource(this.getDataSourceName());if(!(t.getDataCount()<1)){var e=this._indicator;switch(t.getUpdateMode()){case s.DataSource.UpdateMode.Refresh:this.refresh();break;case s.DataSource.UpdateMode.Append:e.reserve(t.getAppendedCount());break;case s.DataSource.UpdateMode.Update:var a,r=t.getDataCount();for(a=r-(t.getUpdatedCount()+t.getAppendedCount());a<r;a++)e.execute(t,a)}}}},{key:"getMinMaxAt",value:function(t,e){e.min=Number.MAX_VALUE,e.max=-Number.MAX_VALUE;var a,r,n=!1,i=this._indicator.getOutputCount();for(r=0;r<i;r++)a=this._indicator.getOutputAt(r).execute(t),!1===isNaN(a)&&(n=!0,e.min>a&&(e.min=a),e.max<a&&(e.max=a));return n}}]),e}();e.IndicatorDataProvider=m},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ChartAreaGroup=e.TimelineArea=e.IndicatorRangeArea=e.MainRangeArea=e.IndicatorArea=e.MainArea=e.ChartArea=void 0;var r=a(1),n=a(0),i=a(17);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,a){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(a):n.value}})(t,e,a||t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,a){return e&&u(t.prototype,e),a&&u(t,a),t}function c(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._left=0,a._top=0,a._right=0,a._bottom=0,a._changed=!1,a._highlighted=!1,a._pressed=!1,a._selected=!1,a.Measuring=new i.MEvent,a}return f(e,r.NamedObject),h(e,[{key:"getDockStyle",value:function(){return this._dockStyle}},{key:"setDockStyle",value:function(t){this._dockStyle=t}},{key:"getLeft",value:function(){return this._left}},{key:"getTop",value:function(){return this._top}},{key:"setTop",value:function(t){this._top!==t&&(this._top=t,this._changed=!0)}},{key:"getRight",value:function(){return this._right}},{key:"getBottom",value:function(){return this._bottom}},{key:"setBottom",value:function(t){this._bottom!==t&&(this._bottom=t,this._changed=!0)}},{key:"getCenter",value:function(){return this._left+this._right>>1}},{key:"getMiddle",value:function(){return this._top+this._bottom>>1}},{key:"getWidth",value:function(){return this._right-this._left}},{key:"getHeight",value:function(){return this._bottom-this._top}},{key:"getRect",value:function(){return{X:this._left,Y:this._top,Width:this._right-this._left,Height:this._bottom-this._top}}},{key:"contains",value:function(t,e){return t>=this._left&&t<this._right&&e>=this._top&&e<this._bottom?[this]:null}},{key:"getMeasuredWidth",value:function(){return this._measuredWidth}},{key:"getMeasuredHeight",value:function(){return this._measuredHeight}},{key:"setMeasuredDimension",value:function(t,e){this._measuredWidth=t,this._measuredHeight=e}},{key:"measure",value:function(t,e,a){this._measuredWidth=0,this._measuredHeight=0,this.Measuring.raise(this,{Width:e,Height:a}),0===this._measuredWidth&&0===this._measuredHeight&&this.setMeasuredDimension(e,a)}},{key:"layout",value:function(t,e,a,r,n){t<<=0,this._left!==t&&(this._left=t,this._changed=!0),e<<=0,this._top!==e&&(this._top=e,this._changed=!0),a<<=0,this._right!==a&&(this._right=a,this._changed=!0),r<<=0,this._bottom!==r&&(this._bottom=r,this._changed=!0),n&&(this._changed=!0)}},{key:"isChanged",value:function(){return this._changed}},{key:"setChanged",value:function(t){this._changed=t}},{key:"isHighlighted",value:function(){return this._highlighted}},{key:"getHighlightedArea",value:function(){return this._highlighted?this:null}},{key:"highlight",value:function(t){return this._highlighted=this===t,this._highlighted?this:null}},{key:"isPressed",value:function(){return this._pressed}},{key:"setPressed",value:function(t){this._pressed=t}},{key:"isSelected",value:function(){return this._selected}},{key:"getSelectedArea",value:function(){return this._selected?this:null}},{key:"select",value:function(t){return this._selected=this===t,this._selected?this:null}},{key:"onMouseMove",value:function(t,e){return null}},{key:"onMouseLeave",value:function(t,e){}},{key:"onMouseDown",value:function(t,e){return null}},{key:"onMouseUp",value:function(t,e){return null}}]),e}();e.ChartArea=_,_.DockStyle={Left:0,Top:1,Right:2,Bottom:3,Fill:4};var p=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._dragStarted=!1,a._oldX=0,a._oldY=0,a._passMoveEventToToolManager=!0,a}return f(e,_),h(e,[{key:"onMouseMove",value:function(t,e){var a=n.ChartManager.instance;if(a._capturingMouseArea===this&&!1===this._dragStarted&&(Math.abs(this._oldX-t)>1||Math.abs(this._oldY-e)>1)&&(this._dragStarted=!0),this._dragStarted)return a.hideCursor(),a.onToolMouseDrag(this.getFrameName(),t,e)?this:(a.getTimeline(this.getDataSourceName()).move(t-this._oldX),this);if(this._passMoveEventToToolManager&&a.onToolMouseMove(this.getFrameName(),t,e))return a.hideCursor(),this;switch(a._drawingTool){case n.ChartManager.DrawingTool.Cursor:a.showCursor();break;case n.ChartManager.DrawingTool.CrossCursor:a.showCrossCursor(this,t,e)?a.hideCursor():a.showCursor();break;default:a.hideCursor()}return this}},{key:"onMouseLeave",value:function(t,e){this._dragStarted=!1,this._passMoveEventToToolManager=!0}},{key:"onMouseDown",value:function(t,e){var a=n.ChartManager.instance;return a.getTimeline(this.getDataSourceName()).startMove(),this._oldX=t,this._oldY=e,this._dragStarted=!1,a.onToolMouseDown(this.getFrameName(),t,e)&&(this._passMoveEventToToolManager=!1),this}},{key:"onMouseUp",value:function(t,e){var a=n.ChartManager.instance,r=null;return this._dragStarted&&(this._dragStarted=!1,r=this),a.onToolMouseUp(this.getFrameName(),t,e)&&(r=this),this._passMoveEventToToolManager=!0,r}}]),e}();e.MainArea=p;var m=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._dragStarted=!1,a._oldX=0,a._oldY=0,a}return f(e,_),h(e,[{key:"onMouseMove",value:function(t,e){var a=n.ChartManager.instance;if(a._capturingMouseArea===this&&!1===this._dragStarted&&(this._oldX===t&&this._oldY===e||(this._dragStarted=!0)),this._dragStarted)return a.hideCursor(),a.getTimeline(this.getDataSourceName()).move(t-this._oldX),this;switch(a._drawingTool){case n.ChartManager.DrawingTool.CrossCursor:a.showCrossCursor(this,t,e)?a.hideCursor():a.showCursor();break;default:a.showCursor()}return this}},{key:"onMouseLeave",value:function(t,e){this._dragStarted=!1}},{key:"onMouseDown",value:function(t,e){return n.ChartManager.instance.getTimeline(this.getDataSourceName()).startMove(),this._oldX=t,this._oldY=e,this._dragStarted=!1,this}},{key:"onMouseUp",value:function(t,e){return this._dragStarted?(this._dragStarted=!1,this):null}}]),e}();e.IndicatorArea=m;var v=function(t){function e(t){return l(this,e),c(this,d(e).call(this,t))}return f(e,_),h(e,[{key:"onMouseMove",value:function(t,e){return n.ChartManager.instance.showCursor(),this}}]),e}();e.MainRangeArea=v;var y=function(t){function e(t){return l(this,e),c(this,d(e).call(this,t))}return f(e,_),h(e,[{key:"onMouseMove",value:function(t,e){return n.ChartManager.instance.showCursor(),this}}]),e}();e.IndicatorRangeArea=y;var w=function(t){function e(t){return l(this,e),c(this,d(e).call(this,t))}return f(e,_),h(e,[{key:"onMouseMove",value:function(t,e){return n.ChartManager.instance.showCursor(),this}}]),e}();e.TimelineArea=w;var x=function(t){function e(t){var a;return l(this,e),(a=c(this,d(e).call(this,t)))._areas=[],a._highlightedArea=null,a._selectedArea=null,a}return f(e,_),h(e,[{key:"contains",value:function(t,a){var r,n,i=this._areas.length;for(n=0;n<i;n++)if(null!==(r=this._areas[n].contains(t,a)))return r.push(this),r;return o(d(e.prototype),"contains",this).call(this,t,a)}},{key:"getAreaCount",value:function(){return this._areas.length}},{key:"getAreaAt",value:function(t){return t<0||t>=this._areas.length?null:this._areas[t]}},{key:"addArea",value:function(t){this._areas.push(t)}},{key:"removeArea",value:function(t){var e,a=this._areas.length;for(e=0;e<a;e++)if(t===this._areas[e]){this._areas.splice(e),this.setChanged(!0);break}}},{key:"getGridColor",value:function(){return this._gridColor}},{key:"setGridColor",value:function(t){this._gridColor=t}},{key:"getHighlightedArea",value:function(){return null!==this._highlightedArea?this._highlightedArea.getHighlightedArea():null}},{key:"highlight",value:function(t){this._highlightedArea=null;var e,a,r=this._areas.length;for(a=0;a<r;a++)if(null!==(e=this._areas[a].highlight(t)))return this._highlightedArea=e,this;return null}},{key:"getSelectedArea",value:function(){return null!==this._selectedArea?this._selectedArea.getSelectedArea():null}},{key:"select",value:function(t){this._selectedArea=null;var e,a,r=this._areas.length;for(a=0;a<r;a++)if(null!==(e=this._areas[a].select(t)))return this._selectedArea=e,this;return null}},{key:"onMouseLeave",value:function(t,e){var a,r=this._areas.length;for(a=0;a<r;a++)this._areas[a].onMouseLeave(t,e)}},{key:"onMouseUp",value:function(t,e){var a,r,n=this._areas.length;for(r=0;r<n;r++)if(null!==(a=this._areas[r].onMouseUp(t,e)))return a;return null}}]),e}();e.ChartAreaGroup=x},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.KlineTrade=void 0;var r=a(0);function n(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=function(){function t(e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.browerState=0,this.tradeDate=new Date,this.tradesLimit=20,this.lastDepth=null,this.depthShowSize=15,this.priceDecimalDigits=6,this.amountDecimalDigits=4,this.symbol=null,this.curPrice=null,this.title="",Object.assign(this,e),t.created||(t.instance=this,t.created=!0),t.instance}var e,a,i;return e=t,(a=[{key:"reset",value:function(t){this.symbol=t,this.lastDepth=null,this.curPrice=null,this.klineTradeInit=!1,$("#trades .trades_list").empty(),$("#gasks .table").empty(),$("#gbids .table").empty(),$("#asks .table").empty(),$("#bids .table").empty()}},{key:"pushTrades",value:function(t){for(var e=$("#trades .trades_list"),a="",r=0;r<t.length;r++){var n=t[r];if(r>=t.length-this.tradesLimit){this.tradeDate.setTime(n.time);var i=this.dateFormatTf(this.tradeDate.getHours())+":"+this.dateFormatTf(this.tradeDate.getMinutes())+":"+this.dateFormatTf(this.tradeDate.getSeconds()),s=(n.amount.toFixed(4)+"").split("."),o=n.price;o>1&&(o=o.toFixed(2)),o<1&&o>1e-5&&(o=o.toFixed(4)),o<1e-5&&(o=o.toFixed(6)),a=this.klineTradeInit?"<ul class='newul'><li class='tm'>"+i+"</li><li class='pr-"+("buy"===n.type?"green":"red")+"'>"+o+"</li><li class='vl'>"+s[0]+"<g>"+(s.length>1?"."+s[1]:"")+"</g></li></ul>"+a:"<ul><li class='tm'>"+i+"</li><li class='pr-"+("buy"===n.type?"green":"red")+"'>"+o+"</li><li class='vl'>"+s[0]+"<g>"+(s.length>1?"."+s[1]:"")+"</g></li></ul>"+a}}var l=0,u=this;if(this.klineTradeInit){clearInterval(h);var h=setInterval(function(){var e=t[l],a=Number(e.price);a>1&&(a=a.toFixed(2)),a<1&&a>1e-4&&(a=a.toFixed(4)),a<1e-4&&(a=a.toFixed(6)),u.curPrice=a,$("div#price").attr("class","buy"===e.type?"green":"red").text(a),++l>=t.length&&clearInterval(h)},100)}else if(t.length>0){var c=Number(t[t.length-1].price);c>1&&(c=c.toFixed(2)),c<1&&c>1e-4&&(c=c.toFixed(4)),c<1e-4&&(c=c.toFixed(6)),u.curPrice=c,$("div#price").attr("class","buy"===t[t.length-1].type?"green":"red").text(c)}this.klineTradeInit?e.prepend(a):e.append(a),a=null,e.find("ul.newul").slideDown(1e3,function(){$(this).removeClass("newul")}),e.find("ul:gt("+(this.tradesLimit-1)+")").remove()}},{key:"updateDepth",value:function(t){if(r.ChartManager.instance.getChart().updateDepth(t),t)if($("#gasks .table").html(this.getgview(this.getgasks(t.asks))),$("#gbids .table").html(this.getgview(this.getgbids(t.bids))),null===this.lastDepth)this.lastDepth={},this.lastDepth.asks=this.getAsks(t.asks,this.depthShowSize),this.depthInit(this.lastDepth.asks,$("#asks .table")),this.lastDepth.bids=this.getBids(t.bids,this.depthShowSize),this.depthInit(this.lastDepth.bids,$("#bids .table"));else{var e=$("#asks .table");e.find("div.remove").remove(),e.find("div.add").removeClass("add");var a=this.getAsks(t.asks,this.depthShowSize),n=this.lastDepth.asks;this.lastDepth.asks=a,this.asksAndBids(a.slice(0),n,e);var i=$("#bids .table");i.find("div.remove").remove(),i.find("div.add").removeClass("add");var s=this.getBids(t.bids,this.depthShowSize),o=this.lastDepth.bids;this.lastDepth.bids=s,this.asksAndBids(s.slice(0),o,$("#bids .table"))}}},{key:"depthInit",value:function(t,e){if(e.empty(),t&&t.length>0){for(var a,r="",n=0;n<t.length;n++){var i=(t[n][0]+"").split("."),s=this.getPrice(i,a);a=i[0],i=(t[n][1]+"").split(".");var o=this.getAmount(i);r+="<div class='row'><span class='price'>"+s[0]+"<g>"+s[1]+"</g></span> <span class='amount'>"+o[0]+"<g>"+o[1]+"</g></span></div>"}e.append(r),r=null}}},{key:"asksAndBids",value:function(t,e,a){for(var r=0;r<e.length;r++){for(var n=!1,i=0;i<t.length;i++)if(e[r][0]===t[i][0]){if(n=!0,e[r][1]!==t[i][1]){var s=a.find("div:eq("+r+") .amount");s.addClass(e[r][1]>t[i][1]?"red":"green");var o=this.getAmount((t[i][1]+"").split("."));setTimeout(function(t,e){return function(){t.html(e[0]+"<g>"+e[1]+"</g>"),t.removeClass("red").removeClass("green"),t=null,e=null}}(s,o),500)}t.splice(i,1);break}n||(a.find("div:eq("+r+")").addClass("remove"),e[r][2]=-1)}for(var l=0;l<e.length;l++)for(var u=0;u<t.length;u++)if(t[u][0]>e[l][0]){var h=(t[u][1]+"").split("."),c=this.getAmount(h);a.find("div:eq("+l+")").before("<div class='row add'><span class='price'></span> <span class='amount'>"+c[0]+"<g>"+c[1]+"</g></span></div>"),e.splice(l,0,t[u]),t.splice(u,1);break}for(var d,f,g,_="",p=0;p<t.length;p++){e.push(t[p]);var m=(t[p][1]+"").split("."),v=this.getAmount(m);_+="<div class='row add'><span class='price'></span> <span class='amount'>"+v[0]+"<g>"+v[1]+"</g></span></div>"}_.length>0&&a.append(_),_=null;for(var y=0;y<e.length;y++){var w=a.find("div:eq("+y+")");if(!(e[y].length>=3&&-1===e[y][2])){var x=(e[y][0]+"").split("."),C=this.getPrice(x,d);d=x[0],w.find(".price").html(C[0]+"<g>"+C[1]+"</g>")}}t=null,e=null,a.find("div.add").slideDown(800),setTimeout((f=a.find("div.remove"),g=a.find("div.add"),function(){f.slideUp(500,function(){$(this).remove()}),g.removeClass("add")}),1e3)}},{key:"getAsks",value:function(t,e){return t.length>e&&t.splice(0,t.length-e),t}},{key:"getBids",value:function(t,e){return t.length>e&&t.splice(e,t.length-1),t}},{key:"getgview",value:function(t){for(var e,a="",r=0;r<t.length;r++){var n=t[r][0].split(".");1===n.length||n[0]!==e?(a+="<div class='row'><span class='price'>"+t[r][0]+"</span> <span class='amount'>"+t[r][1]+"</span></div>",e=n[0]):a+="<div class='row'><span class='price'><h>"+n[0]+".</h>"+n[1]+"</span> <span class='amount'>"+t[r][1]+"</span></div>"}return a}},{key:"getgasks",value:function(t){if(t.length<2)return[];var e=t[t.length-1][0],a=t[0][0],r=a-e,n=this.getBlock(r,100),i=Math.abs(Number(Math.log(n)/Math.log(10))).toFixed(0);r/n<2&&(n/=2,i++),n>=1&&(i=0),e=parseInt(e/n)*n,a=parseInt(a/n)*n;for(var s=[],o=0,l=t.length-1;l>=0;l--){if(t[l][0]>e){var u=parseInt(o,10);if(u>0&&s.unshift([Number(e).toFixed(i),u]),e>=a)break;e+=n}o+=t[l][1]}return s}},{key:"getgbids",value:function(t){if(t.length<2)return[];var e=t[t.length-1][0],a=t[0][0],r=a-e,n=this.getBlock(r,100),i=Math.abs(Number(Math.log(n)/Math.log(10))).toFixed(0);r/n<2&&(n/=2,i++),n>=1&&(i=0),e=parseInt(e/n)*n,a=parseInt(a/n)*n;for(var s=[],o=0,l=0;l<t.length;l++){if(t[l][0]<a){var u=parseInt(o,10);if(u>0&&s.push([Number(a).toFixed(i),u]),a<=e)break;a-=n}o+=t[l][1]}return s}},{key:"getBlock",value:function(t,e){return t>e||t<=0?e:(e/=10,this.getBlock(t,e))}},{key:"getZeros",value:function(t){for(var e="";t>0;)t--,e+="0";return e}},{key:"getPrice",value:function(t,e){var a=t[0];e===a?a="<h>"+a+".</h>":a+=".";var r="";return 1===t.length?(a+="0",r=this.getZeros(this.priceDecimalDigits-1)):(a+=t[1],r=this.getZeros(this.priceDecimalDigits-t[1].length)),[a,r]}},{key:"getAmount",value:function(t){var e=t[0],a="",r=this.amountDecimalDigits-e.length+1;return r>0&&(a=".",1===t.length?a+=this.getZeros(r):r>t[1].length?a+=t[1]+this.getZeros(r-t[1].length):r===t[1].length?a+=t[1]:a+=t[1].substring(0,r)),[e,a]}},{key:"dateFormatTf",value:function(t){return(t<10?"0":"")+t}}])&&n(e.prototype,a),i&&n(e,i),t}();e.KlineTrade=i,i.created=!1,i.instance=null},function(t,e,a){"use strict";function r(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.CName=void 0;var n=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._names=[],this._comps=[],e instanceof t)this._names=e._names,this._comps=e._comps;else{var a=e.split("."),r=a.length-1;if(r>0){this._comps=a,this._names.push(a[0]);for(var n=1;n<=r;n++)this._names.push(this._names[n-1]+"."+a[n])}else this._comps.push(e),this._names.push(e)}}var e,a,n;return e=t,(a=[{key:"getCompAt",value:function(t){return t>=0&&t<this._comps.length?this._comps[t]:""}},{key:"getName",value:function(t){if(t<0){if(this._names.length>0)return this._names[this._names.length-1]}else if(t<this._names.length)return this._names[t];return""}}])&&r(e.prototype,a),n&&r(e,n),t}();e.CName=n},function(t,e,a){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e,a){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(a):n.value}})(t,e,a||t)}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,a){return e&&h(t.prototype,e),a&&h(t,a),t}Object.defineProperty(e,"__esModule",{value:!0}),e.SarExpr=e.SmaExpr=e.ExpmemaExpr=e.EmaExpr=e.MaExpr=e.StdExpr=e.SumExpr=e.CountExpr=e.LlvExpr=e.HhvExpr=e.RangeExpr=e.RangeOutputExpr=e.OutputExpr=e.AssignExpr=e.IfExpr=e.OrExpr=e.AndExpr=e.RefExpr=e.AbsExpr=e.MaxExpr=e.EqExpr=e.LeExpr=e.LtExpr=e.GeExpr=e.GtExpr=e.DivExpr=e.MulExpr=e.SubExpr=e.AddExpr=e.NegExpr=e.OpABCDExpr=e.OpABCExpr=e.OpABExpr=e.OpAExpr=e.ParameterExpr=e.ConstExpr=e.VolumeExpr=e.CloseExpr=e.LowExpr=e.HighExpr=e.OpenExpr=e.Expr=e.ExprEnv=void 0;var d=function(){function t(){u(this,t),this._ds=null,this._firstIndex=null}return c(t,[{key:"getDataSource",value:function(){return this._ds}},{key:"setDataSource",value:function(t){return this._ds=t}},{key:"getFirstIndex",value:function(){return this._firstIndex}},{key:"setFirstIndex",value:function(t){return this._firstIndex=t}}],[{key:"get",value:function(){return this.inst}},{key:"set",value:function(t){this.inst=t}}]),t}();e.ExprEnv=d,d.inst=null;var f=function(){function t(){u(this,t),this._rid=0}return c(t,[{key:"execute",value:function(t){}},{key:"reserve",value:function(t,e){}},{key:"clear",value:function(){}}]),t}();e.Expr=f;var g=function(t){function e(){return u(this,e),i(this,s(e).apply(this,arguments))}return o(e,f),c(e,[{key:"execute",value:function(t){return d.get()._ds.getDataAt(t).open}}]),e}();e.OpenExpr=g;var _=function(t){function e(){return u(this,e),i(this,s(e).apply(this,arguments))}return o(e,f),c(e,[{key:"execute",value:function(t){return d.get()._ds.getDataAt(t).high}}]),e}();e.HighExpr=_;var p=function(t){function e(){return u(this,e),i(this,s(e).apply(this,arguments))}return o(e,f),c(e,[{key:"execute",value:function(t){return d.get()._ds.getDataAt(t).low}}]),e}();e.LowExpr=p;var m=function(t){function e(){return u(this,e),i(this,s(e).apply(this,arguments))}return o(e,f),c(e,[{key:"execute",value:function(t){return d.get()._ds.getDataAt(t).close}}]),e}();e.CloseExpr=m;var v=function(t){function e(){return u(this,e),i(this,s(e).apply(this,arguments))}return o(e,f),c(e,[{key:"execute",value:function(t){return d.get()._ds.getDataAt(t).volume}}]),e}();e.VolumeExpr=v;var y=function(t){function e(t){var a;return u(this,e),(a=i(this,s(e).call(this)))._value=t,a}return o(e,f),c(e,[{key:"execute",value:function(t){return this._value}}]),e}();e.ConstExpr=y;var w=function(t){function e(t,a,r,n){var o;return u(this,e),(o=i(this,s(e).call(this)))._name=t,o._minValue=a,o._maxValue=r,o._value=o._defaultValue=n,o}return o(e,f),c(e,[{key:"execute",value:function(t){return this._value}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(t){0===t?this._value=0:t<this._minValue?this._value=this._minValue:t>this._maxValue?this._value=this._maxValue:this._value=t}}]),e}();e.ParameterExpr=w;var x=function(t){function e(t){var a;return u(this,e),(a=i(this,s(e).call(this)))._exprA=t,a}return o(e,f),c(e,[{key:"reserve",value:function(t,e){this._rid<t&&(this._rid=t,this._exprA.reserve(t,e))}},{key:"clear",value:function(){this._exprA.clear()}}]),e}();e.OpAExpr=x;var C=function(t){function e(t,a){var r;return u(this,e),(r=i(this,s(e).call(this)))._exprA=t,r._exprB=a,r}return o(e,f),c(e,[{key:"reserve",value:function(t,e){this._rid<t&&(this._rid=t,this._exprA.reserve(t,e),this._exprB.reserve(t,e))}},{key:"clear",value:function(){this._exprA.clear(),this._exprB.clear()}}]),e}();e.OpABExpr=C;var b=function(t){function e(t,a,r){var n;return u(this,e),(n=i(this,s(e).call(this)))._exprA=t,n._exprB=a,n._exprC=r,n}return o(e,f),c(e,[{key:"reserve",value:function(t,e){this._rid<t&&(this._rid=t,this._exprA.reserve(t,e),this._exprB.reserve(t,e),this._exprC.reserve(t,e))}},{key:"clear",value:function(){this._exprA.clear(),this._exprB.clear(),this._exprC.clear()}}]),e}();e.OpABCExpr=b;var P=function(t){function e(t,a,r,n){var o;return u(this,e),(o=i(this,s(e).call(this)))._exprA=t,o._exprB=a,o._exprC=r,o._exprD=n,o}return o(e,f),c(e,[{key:"reserve",value:function(t,e){this._rid<t&&(this._rid=t,this._exprA.reserve(t,e),this._exprB.reserve(t,e),this._exprC.reserve(t,e),this._exprD.reserve(t,e))}},{key:"clear",value:function(){this._exprA.clear(),this._exprB.clear(),this._exprC.clear(),this._exprD.clear()}}]),e}();e.OpABCDExpr=P;var k=function(t){function e(t){return u(this,e),i(this,s(e).call(this,t))}return o(e,x),c(e,[{key:"execute",value:function(t){return-this._exprA.execute(t)}}]),e}();e.NegExpr=k;var M=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)+this._exprB.execute(t)}}]),e}();e.AddExpr=M;var S=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)-this._exprB.execute(t)}}]),e}();e.SubExpr=S;var E=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)*this._exprB.execute(t)}}]),e}();e.MulExpr=E;var O=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){var e=this._exprA.execute(t),a=this._exprB.execute(t);return 0===e?e:0===a?e>0?1e6:-1e6:e/a}}]),e}();e.DivExpr=O;var D=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)>this._exprB.execute(t)?1:0}}]),e}();e.GtExpr=D;var A=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)>=this._exprB.execute(t)?1:0}}]),e}();e.GeExpr=A;var T=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)<this._exprB.execute(t)?1:0}}]),e}();e.LtExpr=T;var I=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)<=this._exprB.execute(t)?1:0}}]),e}();e.LeExpr=I;var R=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return this._exprA.execute(t)===this._exprB.execute(t)?1:0}}]),e}();e.EqExpr=R;var j=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return Math.max(this._exprA.execute(t),this._exprB.execute(t))}}]),e}();e.MaxExpr=j;var L=function(t){function e(t){return u(this,e),i(this,s(e).call(this,t))}return o(e,x),c(e,[{key:"execute",value:function(t){return Math.abs(this._exprA.execute(t))}}]),e}();e.AbsExpr=L;var N=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){if((void 0===this._offset||this._offset<0)&&(this._offset=this._exprB.execute(t),this._offset<0))throw"offset < 0";if((t-=this._offset)<0)throw"index < 0";var e=this._exprA.execute(t);if(isNaN(e))throw"NaN";return e}}]),e}();e.RefExpr=N;var V=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return 0!==this._exprA.execute(t)&&0!==this._exprB.execute(t)?1:0}}]),e}();e.AndExpr=V;var F=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,C),c(e,[{key:"execute",value:function(t){return 0!==this._exprA.execute(t)||0!==this._exprB.execute(t)?1:0}}]),e}();e.OrExpr=F;var B=function(t){function e(t,a,r){return u(this,e),i(this,s(e).call(this,t,a,r))}return o(e,b),c(e,[{key:"execute",value:function(t){return 0!==this._exprA.execute(t)?this._exprB.execute(t):this._exprC.execute(t)}}]),e}();e.IfExpr=B;var H=function(t){function e(t,a){var r;return u(this,e),(r=i(this,s(e).call(this,a)))._name=t,r._buf=[],r}return o(e,x),c(e,[{key:"getName",value:function(){return this._name}},{key:"execute",value:function(t){return this._buf[t]}},{key:"assign",value:function(t){if(this._buf[t]=this._exprA.execute(t),d.get()._firstIndex>=0&&isNaN(this._buf[t])&&!isNaN(this._buf[t-1]))throw this._name+".assign("+t+"): NaN"}},{key:"reserve",value:function(t,a){if(this._rid<t)for(var r=a;r>0;r--)this._buf.push(NaN);n(s(e.prototype),"reserve",this).call(this,t,a)}},{key:"clear",value:function(){n(s(e.prototype),"clear",this).call(this),this._buf=[]}}]),e}();e.AssignExpr=H;var z=function(t){function e(t,a,r,n){var o;return u(this,e),(o=i(this,s(e).call(this,t,a)))._style=void 0===r?e.outputStyle.Line:r,o._color=n,o}return o(e,H),c(e,[{key:"getStyle",value:function(){return this._style}},{key:"getColor",value:function(){return this._color}}]),e}();e.OutputExpr=z,z.outputStyle={None:0,Line:1,VolumeStick:2,MACDStick:3,SARPoint:4};var U=function(t){function e(t,a,r,n){return u(this,e),i(this,s(e).call(this,t,a,r,n))}return o(e,z),c(e,[{key:"getName",value:function(){return this._name+this._exprA.getRange()}}]),e}();e.RangeOutputExpr=U;var Y=function(t){function e(t,a){var r;return u(this,e),(r=i(this,s(e).call(this,t,a)))._range=-1,r._buf=[],r}return o(e,C),c(e,[{key:"getRange",value:function(){return this._range}},{key:"initRange",value:function(){this._range=this._exprB.execute(0)}},{key:"execute",value:function(t){this._range<0&&this.initRange();var e=this._buf[t].resultA=this._exprA.execute(t);return this._buf[t].result=this.calcResult(t,e)}},{key:"reserve",value:function(t,a){if(this._rid<t)for(var r=a;r>0;r--)this._buf.push({resultA:NaN,result:NaN});n(s(e.prototype),"reserve",this).call(this,t,a)}},{key:"clear",value:function(){n(s(e.prototype),"clear",this).call(this),this._range=-1,this._buf=[]}}]),e}();e.RangeExpr=Y;var q=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=d.get()._firstIndex;if(a<0)return e;if(t>a){for(var r=e,n=t-this._range+1,i=Math.max(a,n);i<t;i++){var s=this._buf[i];r<s.resultA&&(r=s.resultA)}return r}return e}}]),e}();e.HhvExpr=q;var X=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=d.get()._firstIndex;if(a<0)return e;if(t>a){for(var r=e,n=t-this._range+1,i=Math.max(a,n);i<t;i++){var s=this._buf[i];r>s.resultA&&(r=s.resultA)}return r}return e}}]),e}();e.LlvExpr=X;var G=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=d.get()._firstIndex;if(a<0)return 0;if(t>=a){var r=this._range-1;r>t-a&&(r=t-a);for(var n=0;r>=0;r--)0!==this._buf[t-r].resultA&&n++;return n}return 0}}]),e}();e.CountExpr=G;var W=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"calcResult",value:function(t,e){var a=d.get()._firstIndex;if(a<0)return e;if(t>a){var r=this._range;return 0===r||r>=t+1-a?this._buf[t-1].result+e:this._buf[t-1].result+e-this._buf[t-r].resultA}return e}}]),e}();e.SumExpr=W;var $=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=this._stdBuf[t],r=d.get()._firstIndex;if(r<0)return a.resultMA=e,0;if(t>r){var n=this._range;n>=t+1-r?(n=t+1-r,a.resultMA=this._stdBuf[t-1].resultMA*(1-1/n)+e/n):a.resultMA=this._stdBuf[t-1].resultMA+(e-this._buf[t-n].resultA)/n;for(var i=0,s=t-n+1;s<=t;s++)i+=Math.pow(this._buf[s].resultA-a.resultMA,2);return Math.sqrt(i/n)}return a.resultMA=e,0}},{key:"reserve",value:function(t,a){if(this._rid<t)for(var r=a;r>0;r--)this._stdBuf.push({resultMA:NaN});n(s(e.prototype),"reserve",this).call(this,t,a)}},{key:"clear",value:function(){n(s(e.prototype),"clear",this).call(this),this._stdBuf=[]}}]),e}();e.StdExpr=$;var K=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=d.get()._firstIndex;if(a<0)return e;if(t>a){var r=this._range;return r>=t+1-a?(r=t+1-a,this._buf[t-1].result*(1-1/r)+e/r):this._buf[t-1].result+(e-this._buf[t-r].resultA)/r}return e}}]),e}();e.MaExpr=K;var J=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,Y),c(e,[{key:"initRange",value:function(){n(s(e.prototype),"initRange",this).call(this),this._alpha=2/(this._range+1)}},{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=d.get()._firstIndex;if(a<0)return e;if(t>a){var r=this._buf[t-1];return this._alpha*(e-r.result)+r.result}return e}}]),e}();e.EmaExpr=J;var Z=function(t){function e(t,a){return u(this,e),i(this,s(e).call(this,t,a))}return o(e,J),c(e,[{key:"calcResult",value:function(t,e){var a=d.get()._firstIndex;if(a<0)return e;if(t>a){var r=this._range,n=this._buf[t-1];return r>=t+1-a?(r=t+1-a,n.result*(1-1/r)+e/r):this._alpha*(e-n.result)+n.result}return e}}]),e}();e.ExpmemaExpr=Z;var Q=function(t){function e(t,a,r){var n;return u(this,e),(n=i(this,s(e).call(this,t,a)))._exprC=r,n._mul=null,n}return o(e,Y),c(e,[{key:"initRange",value:function(){n(s(e.prototype),"initRange",this).call(this),this._mul=this._exprC.execute(0)}},{key:"calcResult",value:function(t,e){if(0===this._range)return NaN;var a=d.get()._firstIndex;if(a<0)return e;if(t>a){var r=this._range;return r>t+1-a&&(r=t+1-a),((r-1)*this._buf[t-1].result+e*this._mul)/r}return e}}]),e}();e.SmaExpr=Q;var tt=function(t){function e(t,a,r,n){var o;return u(this,e),(o=i(this,s(e).call(this,t,a,r,n)))._buf=[],o._range=-1,o._min=null,o._step=null,o._max=null,o}return o(e,P),c(e,[{key:"execute",value:function(t){this._range<0&&(this._range=this._exprA.execute(0),this._min=this._exprB.execute(0)/100,this._step=this._exprC.execute(0)/100,this._max=this._exprD.execute(0)/100);var e=this._buf[t],a=d.get(),r=a._firstIndex;if(r<0)e.longPos=!0,e.sar=a._ds.getDataAt(t).low,e.ep=a._ds.getDataAt(t).high,e.af=.02;else{var n=a._ds.getDataAt(t).high,i=a._ds.getDataAt(t).low,s=this._buf[t-1];if(e.sar=s.sar+s.af*(s.ep-s.sar),s.longPos){if(e.longPos=!0,n>s.ep?(e.ep=n,e.af=Math.min(s.af+this._step,this._max)):(e.ep=s.ep,e.af=s.af),e.sar>i){e.longPos=!1;var o=t-this._range+1;for(o=Math.max(o,r);o<t;o++){var l=a._ds.getDataAt(o).high;n<l&&(n=l)}e.sar=n,e.ep=i,e.af=.02}}else if(e.longPos=!1,i<s.ep?(e.ep=i,e.af=Math.min(s.af+this._step,this._max)):(e.ep=s.ep,e.af=s.af),e.sar<n){e.longPos=!0;var u=t-this._range+1;for(u=Math.max(u,r);u<t;u++){var h=a._ds.getDataAt(u).low;i>h&&(i=h)}e.sar=i,e.ep=n,e.af=.02}}return e.sar}},{key:"reserve",value:function(t,a){if(this._rid<t)for(var r=a;r>0;r--)this._buf.push({longPos:!0,sar:NaN,ep:NaN,af:NaN});n(s(e.prototype),"reserve",this).call(this,t,a)}},{key:"clear",value:function(){n(s(e.prototype),"clear",this).call(this),this._range=-1}}]),e}();e.SarExpr=tt},function(t,e,a){"use strict";function r(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(e,"__esModule",{value:!0}),e.MEvent=void 0;var n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._handlers=[]}var e,a,n;return e=t,(a=[{key:"addHandler",value:function(t,e){this.indexOf(t,e)<0&&this._handlers.push({obj:t,func:e})}},{key:"removeHandler",value:function(t,e){var a=this.indexOf(t,e);a>=0&&this._handlers.splice(a,1)}},{key:"raise",value:function(t,e){var a,r=this._handlers,n=r.length;for(a=0;a<n;a++)r[a].func(t,e)}},{key:"indexOf",value:function(t,e){var a,r,n=this._handlers,i=n.length;for(r=0;r<i;r++)if(t===(a=n[r]).obj&&e===a.func)return r;return-1}}])&&r(e.prototype,a),n&&r(e,n),t}();e.MEvent=n},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PercentageRange=e.ZeroCenteredRange=e.MainRange=e.ZeroBasedPositiveRange=e.PositiveRange=e.Range=void 0;var r=a(1),n=a(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,a){return e&&o(t.prototype,e),a&&o(t,a),t}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){function e(t){var a;return s(this,e),(a=u(this,h(e).call(this,t)))._updated=!0,a._minValue=Number.MAX_VALUE,a._maxValue=-Number.MAX_VALUE,a._outerMinValue=Number.MAX_VALUE,a._outerMaxValue=-Number.MAX_VALUE,a._ratio=0,a._top=0,a._bottom=0,a._paddingTop=0,a._paddingBottom=0,a._minInterval=36,a._selectedPosition=-1,a._selectedValue=-Number.MAX_VALUE,a._gradations=[],a}return c(e,r.NamedObject),l(e,[{key:"isUpdated",value:function(){return this._updated}},{key:"setUpdated",value:function(t){this._updated=t}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"getRange",value:function(){return this._maxValue-this._minValue}},{key:"getOuterMinValue",value:function(){return this._outerMinValue}},{key:"getOuterMaxValue",value:function(){return this._outerMaxValue}},{key:"getOuterRange",value:function(){return this._outerMaxValue-this._outerMinValue}},{key:"getHeight",value:function(){return Math.max(0,this._bottom-this._top)}},{key:"getGradations",value:function(){return this._gradations}},{key:"getMinInterval",value:function(){return this._minInterval}},{key:"setMinInterval",value:function(t){this._minInterval=t}},{key:"getSelectedPosition",value:function(){return this._selectedPosition>=0?this._selectedPosition:this._selectedValue>-Number.MAX_VALUE?this.toY(this._selectedValue):-1}},{key:"getSelectedValue",value:function(){if(this._selectedValue>-Number.MAX_VALUE)return this._selectedValue;var t=n.ChartManager.instance.getArea(this.getAreaName());return null===t?-Number.MAX_VALUE:this._selectedPosition<t.getTop()+12||this._selectedPosition>=t.getBottom()-4?-Number.MAX_VALUE:this.toValue(this._selectedPosition)}},{key:"setPaddingTop",value:function(t){this._paddingTop=t}},{key:"setPaddingBottom",value:function(t){this._paddingBottom=t}},{key:"toValue",value:function(t){return this._maxValue-(t-this._top)/this._ratio}},{key:"toY",value:function(t){return this._ratio>0?this._top+Math.floor((this._maxValue-t)*this._ratio+.5):this._top}},{key:"toHeight",value:function(t){return t==1/0||0==this._ratio?1.5:Math.floor(t*this._ratio+1.5)}},{key:"update",value:function(){for(var t,e=Number.MAX_VALUE,a=-Number.MAX_VALUE,r=n.ChartManager.instance,i=[".main",".secondary"],s=0;s<i.length;s++)null!==(t=r.getDataProvider(this.getName()+i[s]))&&void 0!==t&&(e=Math.min(e,t.getMinValue()),a=Math.max(a,t.getMaxValue()));var o={min:e,max:a};this.preSetRange(o),this.setRange(o.min,o.max)}},{key:"select",value:function(t){this._selectedValue=t,this._selectedPosition=-1}},{key:"selectAt",value:function(t){this._selectedPosition=t,this._selectedValue=-Number.MAX_VALUE}},{key:"unselect",value:function(){this._selectedPosition=-1,this._selectedValue=-Number.MAX_VALUE}},{key:"preSetRange",value:function(t){t.min===t.max&&(t.min=-1,t.max=1)}},{key:"setRange",value:function(t,e){var a=n.ChartManager.instance.getArea(this.getAreaName());if(this._minValue!==t||this._maxValue!==e||a.isChanged()){this._updated=!0,this._minValue=t,this._maxValue=e,this._gradations=[];var r=a.getTop()+this._paddingTop,i=a.getBottom()-(this._paddingBottom+1);r>=i?this._minValue=this._maxValue:(this._top=r,this._bottom=i,this._maxValue>this._minValue?this._ratio=(i-r)/(this._maxValue-this._minValue):this._ratio=1,this._outerMinValue=this.toValue(a.getBottom()),this._outerMaxValue=this.toValue(a.getTop()),this.updateGradations())}}},{key:"calcInterval",value:function(){var t=this.getHeight(),e=this.getMinInterval();t/e<=1&&(e=t>>1);for(var a,r,n=this.getRange(),i=0;i>-2&&Math.floor(n)<n;)n*=10,i--;for(;(a=r=Math.pow(10,i),!(this.toHeight(a)>e))&&(a=2*r,!(this.toHeight(a)>e))&&(a=5*r,!(this.toHeight(a)>e));i++);return a}},{key:"updateGradations",value:function(){this._gradations=[];var t=this.calcInterval();if(!(t<=0)){var e=Math.floor(this.getMaxValue()/t)*t;do{this._gradations.push(e),e-=t}while(e>this.getMinValue())}}}]),e}();e.Range=f;var g=function(t){function e(t){return s(this,e),u(this,h(e).call(this,t))}return c(e,f),l(e,[{key:"preSetRange",value:function(t){t.min<0&&(t.min=0),t.max<0&&(t.max=0)}}]),e}();e.PositiveRange=g;var _=function(t){function e(t){return s(this,e),u(this,h(e).call(this,t))}return c(e,f),l(e,[{key:"preSetRange",value:function(t){t.min=0,t.max<0&&(t.max=0)}}]),e}();e.ZeroBasedPositiveRange=_;var p=function(t){function e(t){return s(this,e),u(this,h(e).call(this,t))}return c(e,f),l(e,[{key:"preSetRange",value:function(t){var e=n.ChartManager.instance,a=e.getTimeline(this.getDataSourceName()),r=a.getMaxIndex()-a.getLastIndex();if(r<25){var i=e.getDataSource(this.getDataSourceName()),s=i.getDataAt(i.getDataCount()-1),o=(t.max-t.min)/4*(1-r/25);t.min=Math.min(t.min,Math.max(s.low-o,0)),t.max=Math.max(t.max,s.high+o)}if(t.min>0){var l=t.max/t.min;if(l<1.016){var u=(t.max+t.min)/2,h=1.5*(l-1);t.max=u*(1+h),t.min=u*(1-h)}else if(l<1.048){var c=(t.max+t.min)/2;t.max=1.024*c,t.min=.976*c}}t.min<0&&(t.min=0),t.max<0&&(t.max=0)}}]),e}();e.MainRange=p;var m=function(t){function e(t){return s(this,e),u(this,h(e).call(this,t))}return c(e,f),l(e,[{key:"calcInterval",value:function(t){var e=this.getMinInterval();if(t.getHeight()/e<2)return 0;var a,r=this.getRange();for(a=3;!(this.toHeight(r/a)<=e);a+=2);return r/(a-=2)}},{key:"updateGradations",value:function(){this._gradations=[];var t=n.ChartManager.instance.getArea(this.getAreaName()),e=this.calcInterval(t);if(!(e<=0)){var a=e/2;do{this._gradations.push(a),this._gradations.push(-a),a+=e}while(a<=this.getMaxValue())}}},{key:"preSetRange",value:function(t){var e=Math.max(Math.abs(t.min),Math.abs(t.max));t.min=-e,t.max=e}}]),e}();e.ZeroCenteredRange=m;var v=function(t){function e(t){return s(this,e),u(this,h(e).call(this,t))}return c(e,f),l(e,[{key:"updateGradations",value:function(){this._gradations=[];var t=n.ChartManager.instance.getArea(this.getAreaName()),e=Math.floor(this.toHeight(10));if(!(e<<2>t.getHeight())){var a=10*Math.ceil(this.getMinValue()/10);if(0===a&&(a=0),e<<2<24){if(e<<1<8)return;do{20!==a&&80!==a||this._gradations.push(a),a+=10}while(a<this.getMaxValue())}else do{e<8?20!==a&&50!==a&&80!==a||this._gradations.push(a):0!==a&&20!==a&&50!==a&&80!==a&&100!==a||this._gradations.push(a),a+=10}while(a<this.getMaxValue())}}}]),e}();e.PercentageRange=v},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE_19__},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,n=(r=a(3))&&r.__esModule?r:{default:r};window.Kline=n.default;var i=n.default;e.default=i},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chart=void 0;var r,n=a(0),i=a(8),s=(r=a(3))&&r.__esModule?r:{default:r},o=a(7);function l(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=null,this._charStyle="CandleStick",this._depthData={array:null,asks_count:0,bids_count:0,asks_si:0,asks_ei:0,bids_si:0,bids_ei:0},this.strIsLine=!1,this._range=s.default.instance.range,this._symbol=s.default.instance.symbol}var e,a,r;return e=t,(a=[{key:"setTitle",value:function(){var e=n.ChartManager.instance.getLanguage(),a=s.default.instance.symbolName;a+=" ",a+=this.strIsLine?t.strPeriod[e].line:t.strPeriod[e][this._range],a+=(this._contract_unit+"/"+this._money_type).toUpperCase(),n.ChartManager.instance.setTitle("frame0.k0",a)}},{key:"setSymbol",value:function(t){this._symbol=t,this.updateDataAndDisplay()}},{key:"updateDataAndDisplay",value:function(){s.default.instance.symbol=this._symbol,s.default.instance.range=this._range,n.ChartManager.instance.setCurrentDataSource("frame0.k0",this._symbol+"."+this._range),n.ChartManager.instance.setNormalMode();var t=s.default.instance.chartMgr.getDataSource("frame0.k0").getLastDate();$(".symbol-title>a").text(s.default.instance.symbolName),-1===t?(s.default.instance.requestParam=i.Control.setHttpRequestParam(s.default.instance.symbol,s.default.instance.range,s.default.instance.limit,null),i.Control.requestData(!0)):(s.default.instance.requestParam=i.Control.setHttpRequestParam(s.default.instance.symbol,s.default.instance.range,null,t.toString()),i.Control.requestData()),n.ChartManager.instance.redraw("All",!1)}},{key:"setCurrentContractUnit",value:function(t){this._contract_unit=t,this.updateDataAndDisplay()}},{key:"setCurrentMoneyType",value:function(t){this._money_type=t,this.updateDataAndDisplay()}},{key:"setCurrentPeriod",value:function(t){this._range=s.default.instance.periodMap[t],"stomp"===s.default.instance.type&&1===s.default.instance.stompClient.ws.readyState&&(s.default.instance.subscribed.unsubscribe(),s.default.instance.subscribed=s.default.instance.stompClient.subscribe(s.default.instance.subscribePath+"/"+s.default.instance.symbol+"/"+this._range,i.Control.subscribeCallback)),this.updateDataAndDisplay(),s.default.instance.onRangeChange(this._range)}},{key:"updateDataSource",value:function(t){this._data=t,n.ChartManager.instance.updateData("frame0.k0",this._data)}},{key:"updateDepth",value:function(t){if(null===t)return this._depthData.array=[],void n.ChartManager.instance.redraw("All",!1);if(t.asks&&t.bids&&""!==t.asks&&""!==t.bids){var e=this._depthData;e.array=[];for(var a=0;a<t.asks.length;a++){var r={};r.rate=t.asks[a][0],r.amount=t.asks[a][1],e.array.push(r)}for(var i=0;i<t.bids.length;i++){var s={};s.rate=t.bids[i][0],s.amount=t.bids[i][1],e.array.push(s)}e.asks_count=t.asks.length,e.bids_count=t.bids.length,e.asks_si=e.asks_count-1,e.asks_ei=0,e.bids_si=e.asks_count-1,e.bids_ei=e.asks_count+e.bids_count-2;for(var o=e.asks_si;o>=e.asks_ei;o--)o===e.asks_si&&void 0!==e.array[o]?e.array[o].amounts=e.array[o].amount:void 0!==e.array[o+1]&&(e.array[o].amounts=e.array[o+1].amounts+e.array[o].amount);for(var l=e.bids_si;l<=e.bids_ei;l++)l===e.bids_si&&void 0!==e.array[l]?e.array[l].amounts=e.array[l].amount:void 0!==e.array[l-1]&&(e.array[l].amounts=e.array[l-1].amounts+e.array[l].amount);n.ChartManager.instance.redraw("All",!1)}}},{key:"setMainIndicator",value:function(t){this._mainIndicator=t,"NONE"===t?n.ChartManager.instance.removeMainIndicator("frame0.k0"):n.ChartManager.instance.setMainIndicator("frame0.k0",t),n.ChartManager.instance.redraw("All",!0)}},{key:"setIndicator",value:function(t,e){if("NONE"===e){var a=2;!1===o.Template.displayVolume&&(a=1);var r=n.ChartManager.instance.getIndicatorAreaName("frame0.k0",a);""!==r&&n.ChartManager.instance.removeIndicator(r)}else{var i=2;!1===o.Template.displayVolume&&(i=1);var s=n.ChartManager.instance.getIndicatorAreaName("frame0.k0",i);""===s?o.Template.createIndicatorChartComps("frame0.k0",e):n.ChartManager.instance.setIndicator(s,e)}n.ChartManager.instance.redraw("All",!0)}},{key:"addIndicator",value:function(t){n.ChartManager.instance.addIndicator(t),n.ChartManager.instance.redraw("All",!0)}},{key:"removeIndicator",value:function(t){var e=n.ChartManager.instance.getIndicatorAreaName(2);n.ChartManager.instance.removeIndicator(e),n.ChartManager.instance.redraw("All",!0)}}])&&l(e.prototype,a),r&&l(e,r),t}();e.Chart=u,u.strPeriod={"zh-cn":{line:"(分时)","1min":"(1分钟)","5min":"(5分钟)","15min":"(15分钟)","30min":"(30分钟)","1hour":"(1小时)","1day":"(日线)","1week":"(周线)","3min":"(3分钟)","2hour":"(2小时)","4hour":"(4小时)","6hour":"(6小时)","12hour":"(12小时)","3day":"(3天)"},"en-us":{line:"(Line)","1min":"(1m)","5min":"(5m)","15min":"(15m)","30min":"(30m)","1hour":"(1h)","1day":"(1d)","1week":"(1w)","3min":"(3m)","2hour":"(2h)","4hour":"(4h)","6hour":"(6h)","12hour":"(12h)","3day":"(3d)"},"zh-tw":{line:"(分時)","1min":"(1分鐘)","5min":"(5分鐘)","15min":"(15分鐘)","30min":"(30分鐘)","1hour":"(1小時)","1day":"(日線)","1week":"(周線)","3min":"(3分鐘)","2hour":"(2小時)","4hour":"(4小時)","6hour":"(6小時)","12hour":"(12小時)","3day":"(3天)"}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CToolManager=void 0;var r=a(1),n=a(9),i=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}(a(10));function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=function(t){function e(t){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=l(this,u(e).call(this,t))).selectedObject=-1,a.toolObjects=[],a}var a,s,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,r.NamedObject),a=e,(s=[{key:"getToolObjectCount",value:function(){return this.toolObjects.length}},{key:"addToolObject",value:function(t){this.toolObjects.push(t)}},{key:"getToolObject",value:function(t){return t<this.toolObjects.length&&t>=0?this.toolObjects[t]:null}},{key:"getCurrentObject",value:function(){return this.getToolObject(this.getToolObjectCount()-1)}},{key:"getSelectedObject",value:function(){return this.getToolObject(this.selectedObject)}},{key:"delCurrentObject",value:function(){this.toolObjects.splice(this.getToolObjectCount()-1,1)}},{key:"delSelectedObject",value:function(){this.toolObjects.splice(this.selectedObject,1),this.selectedObject=-1}},{key:"acceptMouseMoveEvent",value:function(t,e){if(-1===this.selectedObject){var a=this.toolObjects[this.getToolObjectCount()-1];if(null!==a&&void 0!==a&&a.getState()!==i.CToolObject.state.AfterDraw)return a.acceptMouseMoveEvent(t,e)}else{var r=this.toolObjects[this.selectedObject];if(r.getState()===i.CToolObject.state.Draw)return r.acceptMouseMoveEvent(t,e);r.unselect(),this.selectedObject=-1}for(var n in this.toolObjects)if(this.toolObjects[n].isSelected(t,e))return this.selectedObject=n,!1;return!1}},{key:"acceptMouseDownEvent",value:function(t,e){if(this.mouseDownMove=!1,-1===this.selectedObject){var a=this.toolObjects[this.getToolObjectCount()-1];if(null!==a&&void 0!==a&&a.getState()!==i.CToolObject.state.AfterDraw)return a.acceptMouseDownEvent(t,e)}else{var r=this.toolObjects[this.selectedObject];if(r.getState()!==i.CToolObject.state.BeforeDraw)return r.acceptMouseDownEvent(t,e)}return!1}},{key:"acceptMouseDownMoveEvent",value:function(t,e){if(this.mouseDownMove=!0,-1===this.selectedObject){var a=this.toolObjects[this.getToolObjectCount()-1];return null!==a&&void 0!==a&&a.getState()===i.CToolObject.state.Draw&&a.acceptMouseDownMoveEvent(t,e)}var r=this.toolObjects[this.selectedObject];if(r.getState()!==i.CToolObject.state.BeforeDraw){if(!0===r.acceptMouseDownMoveEvent(t,e))for(var s=this.toolObjects[this.selectedObject].points,o=0;o<s.length;o++)if(s[o].state===n.CPoint.state.Highlight||s[o].state===n.CPoint.state.Show)return!0;return!0}}},{key:"acceptMouseUpEvent",value:function(t,e){if(!0===this.mouseDownMove){if(-1===this.selectedObject){var a=this.toolObjects[this.getToolObjectCount()-1];return null===a||void 0===a||a.getState()!==i.CToolObject.state.Draw||a.acceptMouseUpEvent(t,e)}var r=this.toolObjects[this.selectedObject];if(r.getState()!==i.CToolObject.state.BeforeDraw)return r.acceptMouseUpEvent(t,e)}if(-1!==this.selectedObject)return!0;var n=this.toolObjects[this.getToolObjectCount()-1];if(null!==n&&void 0!==n){if(n.getState()===i.CToolObject.state.Draw)return!0;if(!n.isValidMouseXY(t,e))return!1;if(n.isSelected(t,e))return!0}return!1}}])&&o(a.prototype,s),c&&o(a,c),e}();e.CToolManager=c},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Timeline=void 0;var r=a(1),n=a(0),i=a(2);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=function(t){function e(t){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(a=l(this,u(e).call(this,t)))._updated=!1,a._innerLeft=0,a._innerWidth=0,a._firstColumnLeft=0,a._scale=3,a._lastScale=-1,a._maxItemCount=0,a._maxIndex=0,a._firstIndex=-1,a._selectedIndex=-1,a._savedFirstIndex=-1,a}var a,s,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(e,r.NamedObject),a=e,(s=[{key:"isLatestShown",value:function(){return this.getLastIndex()===this._maxIndex}},{key:"isUpdated",value:function(){return this._updated}},{key:"setUpdated",value:function(t){this._updated=t}},{key:"getItemWidth",value:function(){return e.itemWidth[this._scale]}},{key:"getSpaceWidth",value:function(){return e.spaceWidth[this._scale]}},{key:"getColumnWidth",value:function(){return this.getSpaceWidth()+this.getItemWidth()}},{key:"getInnerWidth",value:function(){return this._innerWidth}},{key:"getItemLeftOffset",value:function(){return this.getSpaceWidth()}},{key:"getItemCenterOffset",value:function(){return this.getSpaceWidth()+(this.getItemWidth()>>1)}},{key:"getFirstColumnLeft",value:function(){return this._firstColumnLeft}},{key:"getMaxItemCount",value:function(){return this._maxItemCount}},{key:"getFirstIndex",value:function(){return this._firstIndex}},{key:"getLastIndex",value:function(){return Math.min(this._firstIndex+this._maxItemCount,this._maxIndex)}},{key:"getSelectedIndex",value:function(){return this._selectedIndex}},{key:"getMaxIndex",value:function(){return this._maxIndex}},{key:"calcColumnCount",value:function(t){return Math.floor(t/this.getColumnWidth())<<0}},{key:"calcFirstColumnLeft",value:function(t){return this._innerLeft+this._innerWidth-this.getColumnWidth()*t}},{key:"calcFirstIndexAlignRight",value:function(t,e,a){return Math.max(0,t+Math.max(e,1)-Math.max(a,1))}},{key:"calcFirstIndex",value:function(t){return this.validateFirstIndex(this.calcFirstIndexAlignRight(this._firstIndex,this._maxItemCount,t),t)}},{key:"updateMaxItemCount",value:function(){var t,e=this.calcColumnCount(this._innerWidth);if(this._maxItemCount<1)t=this.calcFirstIndex(e);else if(this._lastScale===this._scale)t=this.validateFirstIndex(this._firstIndex-(e-this._maxItemCount));else{var a=this._selectedIndex>=0?this._selectedIndex:this.getLastIndex()-1;t=this.validateFirstIndex(a-Math.round((a-this._firstIndex)*e/this._maxItemCount))}this._lastScale=this._scale,this._firstIndex!==t&&(this._selectedIndex===this._firstIndex&&(this._selectedIndex=t),this._firstIndex=t,this._updated=!0),this._maxItemCount!==e&&(this._maxItemCount=e,this._updated=!0),this._firstColumnLeft=this.calcFirstColumnLeft(e)}},{key:"validateFirstIndex",value:function(t,e){if(this._maxIndex<1)return-1;if(t<0)return 0;var a=Math.max(0,this._maxIndex-1);return t>a?a:t}},{key:"validateSelectedIndex",value:function(){this._selectedIndex<this._firstIndex?this._selectedIndex=-1:this._selectedIndex>=this.getLastIndex()&&(this._selectedIndex=-1)}},{key:"onLayout",value:function(){var t=n.ChartManager.instance.getArea(this.getDataSourceName()+".main");if(null!==t){this._innerLeft=t.getLeft()+e.PADDING_LEFT;var a=Math.max(0,t.getWidth()-(e.PADDING_LEFT+e.PADDING_RIGHT));this._innerWidth!==a&&(this._innerWidth=a,this.updateMaxItemCount())}}},{key:"toIndex",value:function(t){return this._firstIndex+this.calcColumnCount(t-this._firstColumnLeft)}},{key:"toColumnLeft",value:function(t){return this._firstColumnLeft+this.getColumnWidth()*(t-this._firstIndex)}},{key:"toItemLeft",value:function(t){return this.toColumnLeft(t)+this.getItemLeftOffset()}},{key:"toItemCenter",value:function(t){return this.toColumnLeft(t)+this.getItemCenterOffset()}},{key:"selectAt",value:function(t){return this._selectedIndex=this.toIndex(t),this.validateSelectedIndex(),this._selectedIndex>=0}},{key:"unselect",value:function(){this._selectedIndex=-1}},{key:"update",value:function(){var t=n.ChartManager.instance.getDataSource(this.getDataSourceName()),e=this._maxIndex;switch(this._maxIndex=t.getDataCount(),t.getUpdateMode()){case i.DataSource.UpdateMode.Refresh:this._maxIndex<1?this._firstIndex=-1:this._firstIndex=Math.max(this._maxIndex-this._maxItemCount,0),this._selectedIndex=-1,this._updated=!0;break;case i.DataSource.UpdateMode.Append:var a=this.getLastIndex(),r=t.getErasedCount();a<e?r>0&&(this._firstIndex=Math.max(this._firstIndex-r,0),this._selectedIndex>=0&&(this._selectedIndex-=r,this.validateSelectedIndex()),this._updated=!0):a===e&&(this._firstIndex+=this._maxIndex-e,this._selectedIndex>=0&&(this._selectedIndex-=r,this.validateSelectedIndex()),this._updated=!0)}}},{key:"move",value:function(t){this.isLatestShown()&&n.ChartManager.instance.getArea(this.getDataSourceName()+".mainRange").setChanged(!0),this._firstIndex=this.validateFirstIndex(this._savedFirstIndex-this.calcColumnCount(t),this._maxItemCount),this._updated=!0,this._selectedIndex>=0&&this.validateSelectedIndex()}},{key:"startMove",value:function(){this._savedFirstIndex=this._firstIndex}},{key:"scale",value:function(t){this._scale+=t,this._scale<0?this._scale=0:this._scale>=e.itemWidth.length&&(this._scale=e.itemWidth.length-1),this.updateMaxItemCount(),this._selectedIndex>=0&&this.validateSelectedIndex()}}])&&o(a.prototype,s),c&&o(a,c),e}();e.Timeline=c,c.itemWidth=[1,3,3,5,5,7,9,11,13,15,17,19,21,23,25,27,29],c.spaceWidth=[1,1,2,2,3,3,3,3,3,3,5,5,5,5,7,7,7],c.PADDING_LEFT=4,c.PADDING_RIGHT=8},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DockableLayout=e.TableLayout=void 0;var r=o(a(13)),n=a(0),i=o(a(6)),s=a(4);function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,a){return e&&h(t.prototype,e),a&&h(t,a),t}function d(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t,e,a){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,a){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=g(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(a):n.value}})(t,e,a||t)}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=function(t){function e(t){var a;return u(this,e),(a=d(this,g(e).call(this,t)))._nextRowId=0,a._focusedRowIndex=-1,a}return _(e,r.ChartAreaGroup),c(e,[{key:"getNextRowId",value:function(){return this._nextRowId++}},{key:"measure",value:function(t,e,a){this.setMeasuredDimension(e,a);var r,i,s,o,l=0,u=0,h=[],c=this._areas.length;for(o=0;o<c;o+=2){if(0===(r=this._areas[o].getHeight())){if(0===o){var d=a/(2*(s=c+1>>1)+5)*2<<0;for(i=a,o=s-1;o>0;o--)h.unshift(d),i-=d;h.unshift(i);break}r=2===o?l/3:l}u+=r,l=r,h.push(r)}if(u>0){var f=a/u;for(i=a,o=(s=c+1>>1)-1;o>0;o--)h[o]*=f,i-=h[o];h[0]=i}var g=Math.min(240,e>>1),_=76,p=n.ChartManager.instance,m=p.getTimeline(this.getDataSourceName());if(m.getFirstIndex()>=0){var v=[];for(_=76;_<g;_+=8)v.push(m.calcFirstIndex(m.calcColumnCount(e-_)));var y,w,x=m.getLastIndex(),C=[".main",".secondary"],b=new Array(v.length);for(y=0,w=0,_=76;y<this._areas.length&&w<v.length;y+=2){var P=this._areas[y],k=p.getPlotter(P.getName()+"Range.main");for(var M in C){var S=p.getDataProvider(P.getName()+C[M]);if(void 0!==S)for(S.calcRange(v,x,b,null);w<v.length;){var E=k.getRequiredWidth(t,b[w].min),O=k.getRequiredWidth(t,b[w].max);if(Math.max(E,O)<_)break;w++,_+=8}}}}for(o=1;o<this._areas.length;o+=2)this._areas[o].measure(t,_,h[o>>1]);var D=e-_;for(o=0;o<this._areas.length;o+=2)this._areas[o].measure(t,D,h[o>>1])}},{key:"layout",value:function(t,a,r,n,i){if(f(g(e.prototype),"layout",this).call(this,t,a,r,n,i),!(this._areas.length<1)){var s,o,l=t+this._areas[0].getMeasuredWidth(),u=a;i||(i=this.isChanged());var h,c=this._areas.length;for(h=0;h<c;h++)o=u+(s=this._areas[h]).getMeasuredHeight(),s.layout(t,u,l,o,i),h++,(s=this._areas[h]).layout(l,u,this.getRight(),o,i),u=o;this.setChanged(!1)}}},{key:"drawGrid",value:function(t){if(!(this._areas.length<1)){var e=n.ChartManager.instance,a=e.getTheme(this.getFrameName());t.fillStyle=a.getColor(i.Theme.Color.Grid1),t.fillRect(this._areas[0].getRight(),this.getTop(),1,this.getHeight());var r,s=this._areas.length-2;for(r=0;r<s;r+=2)t.fillRect(this.getLeft(),this._areas[r].getBottom(),this.getWidth(),1);if(!e.getCaptureMouseWheelDirectly())for(r=0,s+=2;r<s;r+=2)if(this._areas[r].isSelected()){t.strokeStyle=a.getColor(i.Theme.Color.Indicator1),t.strokeRect(this.getLeft()+.5,this.getTop()+.5,this.getWidth()-1,this.getHeight()-1);break}}}},{key:"highlight",value:function(t){this._highlightedArea=null;var e,a,r=this._areas.length;for(a=0;a<r;a++)(e=this._areas[a])===t?(a&=-2,(e=this._areas[a]).highlight(e),this._highlightedArea=e,a++,(e=this._areas[a]).highlight(null),e.highlight(e)):e.highlight(null);return null!==this._highlightedArea?this:null}},{key:"select",value:function(t){this._selectedArea=null;var e,a,r=this._areas.length;for(a=0;a<r;a++)(e=this._areas[a])===t?(a&=-2,(e=this._areas[a]).select(e),this._selectedArea=e,a++,(e=this._areas[a]).select(e)):e.select(null);return null!==this._selectedArea?this:null}},{key:"onMouseMove",value:function(t,e){if(this._focusedRowIndex>=0){var a=this._areas[this._focusedRowIndex],r=this._areas[this._focusedRowIndex+2],i=e-this._oldY;if(0===i)return this;var s=this._oldUpperBottom+i,o=this._oldLowerTop+i;return s-a.getTop()>=60&&r.getBottom()-o>=60&&(a.setBottom(s),r.setTop(o)),this}var l,u=this._areas.length-2;for(l=0;l<u;l+=2){var h=this._areas[l].getBottom();if(e>=h-4&&e<h+4)return n.ChartManager.instance.showCursor("n-resize"),this}return null}},{key:"onMouseLeave",value:function(t,e){this._focusedRowIndex=-1}},{key:"onMouseDown",value:function(t,e){var a,r=this._areas.length-2;for(a=0;a<r;a+=2){var n=this._areas[a].getBottom();if(e>=n-4&&e<n+4)return this._focusedRowIndex=a,this._oldY=e,this._oldUpperBottom=n,this._oldLowerTop=this._areas[a+2].getTop(),this}return null}},{key:"onMouseUp",value:function(t,e){if(this._focusedRowIndex>=0){this._focusedRowIndex=-1;var a,r=this._areas.length,n=[];for(a=0;a<r;a+=2)n.push(this._areas[a].getHeight());s.ChartSettings.get().charts.areaHeight=n,s.ChartSettings.save()}return this}}]),e}();e.TableLayout=m;var v=function(t){function e(t){return u(this,e),d(this,g(e).call(this,t))}return _(e,r.ChartAreaGroup),c(e,[{key:"measure",value:function(t,a,n){for(var i in f(g(e.prototype),"measure",this).call(this,t,a,n),a=this.getMeasuredWidth(),n=this.getMeasuredHeight(),this._areas){var s=this._areas[i];switch(s.measure(t,a,n),s.getDockStyle()){case r.ChartArea.DockStyle.left:case r.ChartArea.DockStyle.Right:a-=s.getMeasuredWidth();break;case r.ChartArea.DockStyle.Top:case r.ChartArea.DockStyle.Bottom:n-=s.getMeasuredHeight();break;case r.ChartArea.DockStyle.Fill:a=0,n=0}}}},{key:"layout",value:function(t,a,n,i,s){var o,l;for(var u in f(g(e.prototype),"layout",this).call(this,t,a,n,i,s),t=this.getLeft(),a=this.getTop(),n=this.getRight(),i=this.getBottom(),s||(s=this.isChanged()),this._areas){var h=this._areas[u];switch(h.getDockStyle()){case r.ChartArea.DockStyle.left:o=h.getMeasuredWidth(),h.layout(t,a,t+o,i,s),t+=o;break;case r.ChartArea.DockStyle.Top:l=h.getMeasuredHeight(),h.layout(t,a,n,a+l,s),a+=l;break;case r.ChartArea.DockStyle.Right:o=h.getMeasuredWidth(),h.layout(n-o,a,n,i,s),n-=o;break;case r.ChartArea.DockStyle.Bottom:l=h.getMeasuredHeight(),h.layout(t,i-l,n,i,s),i-=l;break;case r.ChartArea.DockStyle.Fill:h.layout(t,a,n,i,s),t=n,a=i}}this.setChanged(!1)}},{key:"drawGrid",value:function(t){var e=n.ChartManager.instance.getTheme(this.getFrameName()),a=this.getLeft(),i=this.getTop(),s=this.getRight(),o=this.getBottom();for(var l in t.fillStyle=e.getColor(this._gridColor),this._areas){var u=this._areas[l];switch(u.getDockStyle()){case r.ChartArea.DockStyle.Left:t.fillRect(u.getRight(),i,1,o-i),a+=u.getWidth();break;case r.ChartArea.DockStyle.Top:t.fillRect(a,u.getBottom(),s-a,1),i+=u.getHeight();break;case r.ChartArea.DockStyle.Right:t.fillRect(u.getLeft(),i,1,o-i),s-=u.getWidth();break;case r.ChartArea.DockStyle.Bottom:t.fillRect(a,u.getTop(),s-a,1),o-=u.getHeight()}}}}]),e}();e.DockableLayout=v},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STOCHRSIIndicator=e.PSYIndicator=e.BOLLIndicator=e.MTMIndicator=e.ROCIndicator=e.KDJIndicator=e.SARIndicator=e.WRIndicator=e.RSIIndicator=e.EMVIndicator=e.OBVIndicator=e.VRIndicator=e.BRARIndicator=e.TRIXIndicator=e.DMAIndicator=e.DMIIndicator=e.MACDIndicator=e.VOLUMEIndicator=e.EMAIndicator=e.MAIndicator=e.HLCIndicator=e.Indicator=void 0;var r=i(a(16)),n=i(a(6));function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,a):{};r.get||r.set?Object.defineProperty(e,a,r):e[a]=t[a]}return e.default=t,e}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,a){return e&&d(t.prototype,e),a&&d(t,a),t}var g=function(){function t(){c(this,t),this._exprEnv=new r.ExprEnv,this._rid=0,this._params=[],this._assigns=[],this._outputs=[]}return f(t,[{key:"addParameter",value:function(t){this._params.push(t)}},{key:"addAssign",value:function(t){this._assigns.push(t)}},{key:"addOutput",value:function(t){this._outputs.push(t)}},{key:"getParameterCount",value:function(){return this._params.length}},{key:"getParameterAt",value:function(t){return this._params[t]}},{key:"getOutputCount",value:function(){return this._outputs.length}},{key:"getOutputAt",value:function(t){return this._outputs[t]}},{key:"clear",value:function(){var t,e;for(this._exprEnv.setFirstIndex(-1),e=this._assigns.length,t=0;t<e;t++)this._assigns[t].clear();for(e=this._outputs.length,t=0;t<e;t++)this._outputs[t].clear()}},{key:"reserve",value:function(t){var e,a;for(this._rid++,a=this._assigns.length,e=0;e<a;e++)this._assigns[e].reserve(this._rid,t);for(a=this._outputs.length,e=0;e<a;e++)this._outputs[e].reserve(this._rid,t)}},{key:"execute",value:function(t,e){if(!(e<0)){this._exprEnv.setDataSource(t),r.ExprEnv.set(this._exprEnv);try{var a,n;for(n=this._assigns.length,a=0;a<n;a++)this._assigns[a].assign(e);for(n=this._outputs.length,a=0;a<n;a++)this._outputs[a].assign(e);this._exprEnv.getFirstIndex()<0&&this._exprEnv.setFirstIndex(e)}catch(t){if(this._exprEnv.getFirstIndex()>=0)throw alert(t),t}}}},{key:"getParameters",value:function(){var t,e=[],a=this._params.length;for(t=0;t<a;t++)e.push(this._params[t].getValue());return e}},{key:"setParameters",value:function(t){if(t instanceof Array&&t.length===this._params.length)for(var e in this._params)this._params[e].setValue(t[e])}}]),t}();e.Indicator=g;var _=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("M1",2,1e3,60);return t.addParameter(a),t.addOutput(new r.OutputExpr("HIGH",new r.HighExpr,r.OutputExpr.outputStyle.None)),t.addOutput(new r.OutputExpr("LOW",new r.LowExpr,r.OutputExpr.outputStyle.None)),t.addOutput(new r.OutputExpr("CLOSE",new r.CloseExpr,r.OutputExpr.outputStyle.Line,n.Theme.Color.Indicator0)),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,a),r.OutputExpr.outputStyle.Line,n.Theme.Color.Indicator1)),t}return u(e,g),f(e,[{key:"getName",value:function(){return"CLOSE"}}]),e}();e.HLCIndicator=_;var p=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("M1",2,1e3,7),n=new r.ParameterExpr("M2",2,1e3,30),i=new r.ParameterExpr("M3",2,1e3,0),s=new r.ParameterExpr("M4",2,1e3,0),u=new r.ParameterExpr("M5",2,1e3,0),h=new r.ParameterExpr("M6",2,1e3,0);return t.addParameter(a),t.addParameter(n),t.addParameter(i),t.addParameter(s),t.addParameter(u),t.addParameter(h),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,a))),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,n))),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,i))),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,s))),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,u))),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(new r.CloseExpr,h))),t}return u(e,g),f(e,[{key:"getName",value:function(){return"MA"}}]),e}();e.MAIndicator=p;var m=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("M1",2,1e3,7),n=new r.ParameterExpr("M2",2,1e3,30),i=new r.ParameterExpr("M3",2,1e3,0),s=new r.ParameterExpr("M4",2,1e3,0),u=new r.ParameterExpr("M5",2,1e3,0),h=new r.ParameterExpr("M6",2,1e3,0);return t.addParameter(a),t.addParameter(n),t.addParameter(i),t.addParameter(s),t.addParameter(u),t.addParameter(h),t.addOutput(new r.RangeOutputExpr("EMA",new r.EmaExpr(new r.CloseExpr,a))),t.addOutput(new r.RangeOutputExpr("EMA",new r.EmaExpr(new r.CloseExpr,n))),t.addOutput(new r.RangeOutputExpr("EMA",new r.EmaExpr(new r.CloseExpr,i))),t.addOutput(new r.RangeOutputExpr("EMA",new r.EmaExpr(new r.CloseExpr,s))),t.addOutput(new r.RangeOutputExpr("EMA",new r.EmaExpr(new r.CloseExpr,u))),t.addOutput(new r.RangeOutputExpr("EMA",new r.EmaExpr(new r.CloseExpr,h))),t}return u(e,g),f(e,[{key:"getName",value:function(){return"EMA"}}]),e}();e.EMAIndicator=m;var v=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("M1",2,500,5),i=new r.ParameterExpr("M2",2,500,10);t.addParameter(a),t.addParameter(i);var s=new r.OutputExpr("VOLUME",new r.VolumeExpr,r.OutputExpr.outputStyle.VolumeStick,n.Theme.Color.Text4);return t.addOutput(s),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(s,a),r.OutputExpr.outputStyle.Line,n.Theme.Color.Indicator0)),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(s,i),r.OutputExpr.outputStyle.Line,n.Theme.Color.Indicator1)),t}return u(e,g),f(e,[{key:"getName",value:function(){return"VOLUME"}}]),e}();e.VOLUMEIndicator=v;var y=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("SHORT",2,200,12),n=new r.ParameterExpr("LONG",2,200,26),i=new r.ParameterExpr("MID",2,200,9);t.addParameter(a),t.addParameter(n),t.addParameter(i);var s=new r.OutputExpr("DIF",new r.SubExpr(new r.EmaExpr(new r.CloseExpr,a),new r.EmaExpr(new r.CloseExpr,n)));t.addOutput(s);var u=new r.OutputExpr("DEA",new r.EmaExpr(s,i));t.addOutput(u);var h=new r.OutputExpr("MACD",new r.MulExpr(new r.SubExpr(s,u),new r.ConstExpr(2)),r.OutputExpr.outputStyle.MACDStick);return t.addOutput(h),t}return u(e,g),f(e,[{key:"getName",value:function(){return"MACD"}}]),e}();e.MACDIndicator=y;var w=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,90,14),n=new r.ParameterExpr("MM",2,60,6);t.addParameter(a),t.addParameter(n);var i=new r.AssignExpr("MTR",new r.ExpmemaExpr(new r.MaxExpr(new r.MaxExpr(new r.SubExpr(new r.HighExpr,new r.LowExpr),new r.AbsExpr(new r.SubExpr(new r.HighExpr,new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1))))),new r.AbsExpr(new r.SubExpr(new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1)),new r.LowExpr))),a));t.addAssign(i);var s=new r.AssignExpr("HD",new r.SubExpr(new r.HighExpr,new r.RefExpr(new r.HighExpr,new r.ConstExpr(1))));t.addAssign(s);var u=new r.AssignExpr("LD",new r.SubExpr(new r.RefExpr(new r.LowExpr,new r.ConstExpr(1)),new r.LowExpr));t.addAssign(u);var h=new r.AssignExpr("DMP",new r.ExpmemaExpr(new r.IfExpr(new r.AndExpr(new r.GtExpr(s,new r.ConstExpr(0)),new r.GtExpr(s,u)),s,new r.ConstExpr(0)),a));t.addAssign(h);var d=new r.AssignExpr("DMM",new r.ExpmemaExpr(new r.IfExpr(new r.AndExpr(new r.GtExpr(u,new r.ConstExpr(0)),new r.GtExpr(u,s)),u,new r.ConstExpr(0)),a));t.addAssign(d);var f=new r.OutputExpr("PDI",new r.MulExpr(new r.DivExpr(h,i),new r.ConstExpr(100)));t.addOutput(f);var g=new r.OutputExpr("MDI",new r.MulExpr(new r.DivExpr(d,i),new r.ConstExpr(100)));t.addOutput(g);var _=new r.OutputExpr("ADX",new r.ExpmemaExpr(new r.MulExpr(new r.DivExpr(new r.AbsExpr(new r.SubExpr(g,f)),new r.AddExpr(g,f)),new r.ConstExpr(100)),n));t.addOutput(_);var p=new r.OutputExpr("ADXR",new r.ExpmemaExpr(_,n));return t.addOutput(p),t}return u(e,g),f(e,[{key:"getName",value:function(){return"DMI"}}]),e}();e.DMIIndicator=w;var x=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N1",2,60,10),n=new r.ParameterExpr("N2",2,250,50),i=new r.ParameterExpr("M",2,100,10);t.addParameter(a),t.addParameter(n),t.addParameter(i);var s=new r.OutputExpr("DIF",new r.SubExpr(new r.MaExpr(new r.CloseExpr,a),new r.MaExpr(new r.CloseExpr,n)));t.addOutput(s);var u=new r.OutputExpr("DIFMA",new r.MaExpr(s,i));return t.addOutput(u),t}return u(e,g),f(e,[{key:"getName",value:function(){return"DMA"}}]),e}();e.DMAIndicator=x;var C=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,100,12),n=new r.ParameterExpr("M",2,100,9);t.addParameter(a),t.addParameter(n);var i=new r.AssignExpr("MTR",new r.EmaExpr(new r.EmaExpr(new r.EmaExpr(new r.CloseExpr,a),a),a));t.addAssign(i);var s=new r.OutputExpr("TRIX",new r.MulExpr(new r.DivExpr(new r.SubExpr(i,new r.RefExpr(i,new r.ConstExpr(1))),new r.RefExpr(i,new r.ConstExpr(1))),new r.ConstExpr(100)));t.addOutput(s);var u=new r.OutputExpr("MATRIX",new r.MaExpr(s,n));return t.addOutput(u),t}return u(e,g),f(e,[{key:"getName",value:function(){return"TRIX"}}]),e}();e.TRIXIndicator=C;var b=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,120,26);t.addParameter(a);var n=new r.AssignExpr("REF_CLOSE_1",new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1)));t.addAssign(n);var i=new r.OutputExpr("BR",new r.MulExpr(new r.DivExpr(new r.SumExpr(new r.MaxExpr(new r.ConstExpr(0),new r.SubExpr(new r.HighExpr,n)),a),new r.SumExpr(new r.MaxExpr(new r.ConstExpr(0),new r.SubExpr(n,new r.LowExpr)),a)),new r.ConstExpr(100)));t.addOutput(i);var s=new r.OutputExpr("AR",new r.MulExpr(new r.DivExpr(new r.SumExpr(new r.SubExpr(new r.HighExpr,new r.OpenExpr),a),new r.SumExpr(new r.SubExpr(new r.OpenExpr,new r.LowExpr),a)),new r.ConstExpr(100)));return t.addOutput(s),t}return u(e,g),f(e,[{key:"getName",value:function(){return"BRAR"}}]),e}();e.BRARIndicator=b;var P=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,100,26),n=new r.ParameterExpr("M",2,100,6);t.addParameter(a),t.addParameter(n);var i=new r.AssignExpr("REF_CLOSE_1",new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1)));t.addAssign(i);var s=new r.AssignExpr("TH",new r.SumExpr(new r.IfExpr(new r.GtExpr(new r.CloseExpr,i),new r.VolumeExpr,new r.ConstExpr(0)),a));t.addAssign(s);var u=new r.AssignExpr("TL",new r.SumExpr(new r.IfExpr(new r.LtExpr(new r.CloseExpr,i),new r.VolumeExpr,new r.ConstExpr(0)),a));t.addAssign(u);var h=new r.AssignExpr("TQ",new r.SumExpr(new r.IfExpr(new r.EqExpr(new r.CloseExpr,i),new r.VolumeExpr,new r.ConstExpr(0)),a));t.addAssign(h);var d=new r.OutputExpr("VR",new r.MulExpr(new r.DivExpr(new r.AddExpr(new r.MulExpr(s,new r.ConstExpr(2)),h),new r.AddExpr(new r.MulExpr(u,new r.ConstExpr(2)),h)),new r.ConstExpr(100)));t.addOutput(d);var f=new r.OutputExpr("MAVR",new r.MaExpr(d,n));return t.addOutput(f),t}return u(e,g),f(e,[{key:"getName",value:function(){return"VR"}}]),e}();e.VRIndicator=P;var k=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("M",2,100,30);t.addParameter(a);var n=new r.AssignExpr("REF_CLOSE_1",new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1)));t.addAssign(n);var i=new r.AssignExpr("VA",new r.IfExpr(new r.GtExpr(new r.CloseExpr,n),new r.VolumeExpr,new r.NegExpr(new r.VolumeExpr)));t.addAssign(i);var s=new r.OutputExpr("OBV",new r.SumExpr(new r.IfExpr(new r.EqExpr(new r.CloseExpr,n),new r.ConstExpr(0),i),new r.ConstExpr(0)));t.addOutput(s);var u=new r.OutputExpr("MAOBV",new r.MaExpr(s,a));return t.addOutput(u),t}return u(e,g),f(e,[{key:"getName",value:function(){return"OBV"}}]),e}();e.OBVIndicator=k;var M=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,90,14),n=new r.ParameterExpr("M",2,60,9);t.addParameter(a),t.addParameter(n);var i=new r.AssignExpr("VOLUME",new r.DivExpr(new r.MaExpr(new r.VolumeExpr,a),new r.VolumeExpr));t.addAssign(i);var s=new r.AssignExpr("MID",new r.MulExpr(new r.DivExpr(new r.SubExpr(new r.AddExpr(new r.HighExpr,new r.LowExpr),new r.RefExpr(new r.AddExpr(new r.HighExpr,new r.LowExpr),new r.ConstExpr(1))),new r.AddExpr(new r.HighExpr,new r.LowExpr)),new r.ConstExpr(100)));t.addAssign(s);var u=new r.OutputExpr("EMV",new r.MaExpr(new r.DivExpr(new r.MulExpr(s,new r.MulExpr(i,new r.SubExpr(new r.HighExpr,new r.LowExpr))),new r.MaExpr(new r.SubExpr(new r.HighExpr,new r.LowExpr),a)),a));t.addOutput(u);var h=new r.OutputExpr("MAEMV",new r.MaExpr(u,n));return t.addOutput(h),t}return u(e,g),f(e,[{key:"getName",value:function(){return"EMV"}}]),e}();e.EMVIndicator=M;var S=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N1",2,120,6),n=new r.ParameterExpr("N2",2,250,12),i=new r.ParameterExpr("N3",2,500,24);t.addParameter(a),t.addParameter(n),t.addParameter(i);var s=new r.AssignExpr("LC",new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1)));t.addAssign(s);var u=new r.AssignExpr("CLOSE_LC",new r.SubExpr(new r.CloseExpr,s));return t.addAssign(u),t.addOutput(new r.OutputExpr("RSI1",new r.MulExpr(new r.DivExpr(new r.SmaExpr(new r.MaxExpr(u,new r.ConstExpr(0)),a,new r.ConstExpr(1)),new r.SmaExpr(new r.AbsExpr(u),a,new r.ConstExpr(1))),new r.ConstExpr(100)))),t.addOutput(new r.OutputExpr("RSI2",new r.MulExpr(new r.DivExpr(new r.SmaExpr(new r.MaxExpr(u,new r.ConstExpr(0)),n,new r.ConstExpr(1)),new r.SmaExpr(new r.AbsExpr(u),n,new r.ConstExpr(1))),new r.ConstExpr(100)))),t.addOutput(new r.OutputExpr("RSI3",new r.MulExpr(new r.DivExpr(new r.SmaExpr(new r.MaxExpr(u,new r.ConstExpr(0)),i,new r.ConstExpr(1)),new r.SmaExpr(new r.AbsExpr(u),i,new r.ConstExpr(1))),new r.ConstExpr(100)))),t}return u(e,g),f(e,[{key:"getName",value:function(){return"RSI"}}]),e}();e.RSIIndicator=S;var E=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,100,10),n=new r.ParameterExpr("N1",2,100,6);t.addParameter(a),t.addParameter(n);var i=new r.AssignExpr("HHV",new r.HhvExpr(new r.HighExpr,a));t.addAssign(i);var s=new r.AssignExpr("HHV1",new r.HhvExpr(new r.HighExpr,n));t.addAssign(s);var u=new r.AssignExpr("LLV",new r.LlvExpr(new r.LowExpr,a));t.addAssign(u);var h=new r.AssignExpr("LLV1",new r.LlvExpr(new r.LowExpr,n));t.addAssign(h);var d=new r.OutputExpr("WR1",new r.MulExpr(new r.DivExpr(new r.SubExpr(i,new r.CloseExpr),new r.SubExpr(i,u)),new r.ConstExpr(100)));t.addOutput(d);var f=new r.OutputExpr("WR2",new r.MulExpr(new r.DivExpr(new r.SubExpr(s,new r.CloseExpr),new r.SubExpr(s,h)),new r.ConstExpr(100)));return t.addOutput(f),t}return u(e,g),f(e,[{key:"getName",value:function(){return"WR"}}]),e}();e.WRIndicator=E;var O=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ConstExpr(4),n=new r.ConstExpr(2),i=new r.ConstExpr(2),s=new r.ConstExpr(20);return t.addOutput(new r.OutputExpr("SAR",new r.SarExpr(a,n,i,s),r.OutputExpr.outputStyle.SARPoint)),t}return u(e,g),f(e,[{key:"getName",value:function(){return"SAR"}}]),e}();e.SARIndicator=O;var D=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,90,9),n=new r.ParameterExpr("M1",2,30,3),i=new r.ParameterExpr("M2",2,30,3);t.addParameter(a),t.addParameter(n),t.addParameter(i);var s=new r.AssignExpr("HHV",new r.HhvExpr(new r.HighExpr,a));t.addAssign(s);var u=new r.AssignExpr("LLV",new r.LlvExpr(new r.LowExpr,a));t.addAssign(u);var h=new r.AssignExpr("RSV",new r.MulExpr(new r.DivExpr(new r.SubExpr(new r.CloseExpr,u),new r.SubExpr(s,u)),new r.ConstExpr(100)));t.addAssign(h);var d=new r.OutputExpr("K",new r.SmaExpr(h,n,new r.ConstExpr(1)));t.addOutput(d);var f=new r.OutputExpr("D",new r.SmaExpr(d,i,new r.ConstExpr(1)));t.addOutput(f);var g=new r.OutputExpr("J",new r.SubExpr(new r.MulExpr(d,new r.ConstExpr(3)),new r.MulExpr(f,new r.ConstExpr(2))));return t.addOutput(g),t}return u(e,g),f(e,[{key:"getName",value:function(){return"KDJ"}}]),e}();e.KDJIndicator=D;var A=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,120,12),n=new r.ParameterExpr("M",2,60,6);t.addParameter(a),t.addParameter(n);var i=new r.AssignExpr("REF_CLOSE_N",new r.RefExpr(new r.CloseExpr,a));t.addAssign(i);var s=new r.OutputExpr("ROC",new r.MulExpr(new r.DivExpr(new r.SubExpr(new r.CloseExpr,i),i),new r.ConstExpr(100)));t.addOutput(s);var u=new r.OutputExpr("MAROC",new r.MaExpr(s,n));return t.addOutput(u),t}return u(e,g),f(e,[{key:"getName",value:function(){return"ROC"}}]),e}();e.ROCIndicator=A;var T=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,120,12),n=new r.ParameterExpr("M",2,60,6);t.addParameter(a),t.addParameter(n);var i=new r.OutputExpr("MTM",new r.SubExpr(new r.CloseExpr,new r.RefExpr(new r.CloseExpr,a)));t.addOutput(i);var s=new r.OutputExpr("MTMMA",new r.MaExpr(i,n));return t.addOutput(s),t}return u(e,g),f(e,[{key:"getName",value:function(){return"MTM"}}]),e}();e.MTMIndicator=T;var I=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,120,20);t.addParameter(a);var n=new r.AssignExpr("STD_CLOSE_N",new r.StdExpr(new r.CloseExpr,a));t.addAssign(n);var i=new r.OutputExpr("BOLL",new r.MaExpr(new r.CloseExpr,a));t.addOutput(i);var s=new r.OutputExpr("UB",new r.AddExpr(i,new r.MulExpr(new r.ConstExpr(2),n)));t.addOutput(s);var u=new r.OutputExpr("LB",new r.SubExpr(i,new r.MulExpr(new r.ConstExpr(2),n)));return t.addOutput(u),t}return u(e,g),f(e,[{key:"getName",value:function(){return"BOLL"}}]),e}();e.BOLLIndicator=I;var R=function(t){function e(){var t;c(this,e),t=o(this,l(e).call(this));var a=new r.ParameterExpr("N",2,100,12),n=new r.ParameterExpr("M",2,100,6);t.addParameter(a),t.addParameter(n);var i=new r.OutputExpr("PSY",new r.MulExpr(new r.DivExpr(new r.CountExpr(new r.GtExpr(new r.CloseExpr,new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1))),a),a),new r.ConstExpr(100)));t.addOutput(i);var s=new r.OutputExpr("PSYMA",new r.MaExpr(i,n));return t.addOutput(s),t}return u(e,g),f(e,[{key:"getName",value:function(){return"PSY"}}]),e}();e.PSYIndicator=R;var j=function(t){function e(){var t;c(this,e),(t=o(this,l(e).call(this))).getName=function(){return"StochRSI"};var a=new r.ParameterExpr("N",3,100,14),n=new r.ParameterExpr("M",3,100,14),i=new r.ParameterExpr("P1",2,50,3),s=new r.ParameterExpr("P2",2,50,3);t.addParameter(a),t.addParameter(n),t.addParameter(i),t.addParameter(s);var u=new r.AssignExpr("LC",new r.RefExpr(new r.CloseExpr,new r.ConstExpr(1)));t.addAssign(u);var h=new r.AssignExpr("CLOSE_LC",new r.SubExpr(new r.CloseExpr,u));t.addAssign(h);var d=new r.AssignExpr("RSI",new r.MulExpr(new r.DivExpr(new r.SmaExpr(new r.MaxExpr(h,new r.ConstExpr(0)),a,new r.ConstExpr(1)),new r.SmaExpr(new r.AbsExpr(h),a,new r.ConstExpr(1))),new r.ConstExpr(100)));t.addAssign(d);var f=new r.OutputExpr("STOCHRSI",new r.MulExpr(new r.DivExpr(new r.MaExpr(new r.SubExpr(d,new r.LlvExpr(d,n)),i),new r.MaExpr(new r.SubExpr(new r.HhvExpr(d,n),new r.LlvExpr(d,n)),i)),new r.ConstExpr(100)));return t.addOutput(f),t.addOutput(new r.RangeOutputExpr("MA",new r.MaExpr(f,s))),t}return u(e,g),e}();e.STOCHRSIIndicator=j},function(t,e){t.exports='<div class="trade_container dark hide">\n    <div class="m_cent">\n        <div class="m_guadan">\n            <div class="symbol-title">\n                <a class="dark"></a>\n            </div>\n            <div id="orderbook">\n                <div id="asks">\n                    <div class="table"></div>\n                </div>\n                <div id="gasks">\n                    <div class="table"></div>\n                </div>\n                <div id="price" class="green"></div>\n                <div id="bids">\n                    <div class="table"></div>\n                </div>\n                <div id="gbids">\n                    <div class="table"></div>\n                </div>\n            </div>\n            <div id="trades" class="trades">\n                <div class="trades_list"></div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="chart_container dark">\n    <div id="chart_dom_elem_cache"></div>\n    \x3c!-- ToolBar --\x3e\n    <div id="chart_toolbar">\n        <div class="chart_toolbar_minisep"></div>\n        \x3c!-- Periods --\x3e\n        <div class="chart_dropdown" id="chart_toolbar_periods_vert">\n            <div class="chart_dropdown_t"><a class="chart_str_period">周期</a></div>\n            <div class="chart_dropdown_data" style="margin-left: -58px;">\n                <table>\n                    <tbody>\n                    <tr>\n                        <td>\n                            <ul>\n                                <li id="chart_period_1w_v" style="display:none;" name="1w">\n                                    <a class="chart_str_period_1w">周线</a>\n                                </li>\n                                <li id="chart_period_3d_v" style="display:none;" name="3d">\n                                    <a class="chart_str_period_3d">3日</a>\n                                </li>\n                                <li id="chart_period_1d_v" style="display:none;" name="1d">\n                                    <a class="chart_str_period_1d">日线</a>\n                                </li>\n                                <li id="chart_period_12h_v" style="display:none;" name="12h">\n                                    <a class="chart_str_period_12h">12小时</a>\n                                </li>\n                                <li id="chart_period_6h_v" style="display:none;" name="6h">\n                                    <a class="chart_str_period_6h">6小时</a>\n                                </li>\n                                <li id="chart_period_4h_v" style="display:none;" name="4h">\n                                    <a class="chart_str_period_4h">4小时</a>\n                                </li>\n                                <li id="chart_period_2h_v" style="display:none;" name="2h">\n                                    <a class="chart_str_period_2h">2小时</a>\n                                </li>\n                                <li id="chart_period_1h_v" style="display:none;" name="1h">\n                                    <a class="chart_str_period_1h">1小时</a>\n                                </li>\n                            </ul>\n                        </td>\n\n                    </tr>\n\n                    <tr>\n                        <td>\n                            <ul>\n                                <li id="chart_period_30m_v" style="display:none;" name="30m">\n                                    <a class="chart_str_period_30m">30分钟</a>\n                                </li>\n                                <li id="chart_period_15m_v" style="display:none;" name="15m">\n                                    <a class="chart_str_period_15m">15分钟</a>\n                                </li>\n                                <li id="chart_period_5m_v" style="display:none;" name="5m">\n                                    <a class="chart_str_period_5m">5分钟</a>\n                                </li>\n                                <li id="chart_period_3m_v" style="display:none;" name="3m">\n                                    <a class="chart_str_period_3m">3分钟</a>\n                                </li>\n                                <li id="chart_period_1m_v" style="display:none;" name="1m">\n                                    <a class="chart_str_period_1m selected">1分钟</a>\n                                </li>\n                                <li id="chart_period_line_v" style="display:none;" name="line">\n                                    <a class="chart_str_period_line">分时</a>\n                                </li>\n                            </ul>\n                        </td>\n                    </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        <div id="chart_toolbar_periods_horz">\n            <ul class="chart_toolbar_tabgroup" style="padding-left:5px; padding-right:11px;">\n                <li id="chart_period_1w_h" name="1w" style="display: none;">\n                    <a class="chart_str_period_1w">周线</a>\n                </li>\n                <li id="chart_period_3d_h" name="3d" style="display: none;">\n                    <a class="chart_str_period_3d">3日</a>\n                </li>\n                <li id="chart_period_1d_h" name="1d" style="display: none;">\n                    <a class="chart_str_period_1d">日线</a>\n                </li>\n                <li id="chart_period_12h_h" name="12h" style="display: none;">\n                    <a class="chart_str_period_12h">12小时</a>\n                </li>\n                <li id="chart_period_6h_h" name="6h" style="display: none;">\n                    <a class="chart_str_period_6h">6小时</a>\n                </li>\n                <li id="chart_period_4h_h" name="4h" style="display: none;">\n                    <a class="chart_str_period_4h">4小时</a>\n                </li>\n                <li id="chart_period_2h_h" name="2h" style="display: none;">\n                    <a class="chart_str_period_2h">2小时</a>\n                </li>\n                <li id="chart_period_1h_h" name="1h" style="display: none;">\n                    <a class="chart_str_period_1h">1小时</a>\n                </li>\n                <li id="chart_period_30m_h" name="30m" style="display: none;">\n                    <a class="chart_str_period_30m">30分钟</a>\n                </li>\n                <li id="chart_period_15m_h" name="15m" style="display: none;">\n                    <a class="chart_str_period_15m">15分钟</a>\n                </li>\n                <li id="chart_period_5m_h" name="5m" style="display: none;">\n                    <a class="chart_str_period_5m">5分钟</a>\n                </li>\n                <li id="chart_period_3m_h" name="3m" style="display: none;">\n                    <a class="chart_str_period_3m">3分钟</a>\n                </li>\n                <li id="chart_period_1m_h" name="1m" style="display: none;">\n                    <a class="chart_str_period_1m selected">1分钟</a>\n                </li>\n                <li id="chart_period_line_h" name="line" style="display: none;">\n                    <a class="chart_str_period_line">分时</a>\n                </li>\n            </ul>\n        </div>\n        <div id="chart_show_indicator" class="chart_toolbar_button chart_str_indicator_cap selected">技术指标</div>\n        <div id="chart_show_tools" class="chart_toolbar_button chart_str_tools_cap">画线工具</div>\n        <div id="chart_toolbar_theme">\n            <div class="chart_toolbar_label chart_str_theme_cap">\n                主题选择\n            </div>\n            <a name="dark" class="chart_icon chart_icon_theme_dark selected"></a>\n            <a name="light" class="chart_icon chart_icon_theme_light"></a>\n        </div>\n        <div class="chart_dropdown" id="chart_dropdown_settings">\n            <div class="chart_dropdown_t"><a class="chart_str_settings">更多</a></div>\n\n            <div class="chart_dropdown_data" style="margin-left: -142px;">\n                <table>\n                    <tbody>\n                    <tr id="chart_select_main_indicator">\n                        <td class="chart_str_main_indicator">主指标</td>\n                        <td>\n                            <ul>\n                                <li><a name="MA" class="selected">MA</a></li>\n                                <li><a name="EMA" class="">EMA</a></li>\n                                <li><a name="BOLL" class="">BOLL</a></li>\n                                <li><a name="SAR" class="">SAR</a></li>\n                                <li><a name="NONE" class="">None</a></li>\n                            </ul>\n                        </td>\n                    </tr>\n\n                    <tr id="chart_select_chart_style">\n                        <td class="chart_str_chart_style">主图样式</td>\n                        <td>\n                            <ul>\n                                <li><a class="selected">CandleStick</a></li>\n                                <li><a>CandleStickHLC</a></li>\n                                <li><a class="">OHLC</a></li>\n                            </ul>\n                        </td>\n                    </tr>\n\n                    <tr id="chart_select_theme" style="display: none;">\n                        <td class="chart_str_theme">主题选择</td>\n                        <td>\n                            <ul>\n                                <li>\n                                    <a name="dark" class="chart_icon chart_icon_theme_dark selected"></a>\n                                </li>\n\n                                <li>\n                                    <a name="light" class="chart_icon chart_icon_theme_light"></a>\n                                </li>\n                            </ul>\n                        </td>\n                    </tr>\n                    <tr id="chart_enable_tools" style="display: none;">\n                        <td class="chart_str_tools">画线工具</td>\n                        <td>\n                            <ul>\n                                <li><a name="on" class="chart_str_on">开启</a></li>\n                                <li><a name="off" class="chart_str_off selected">关闭</a></li>\n\n                            </ul>\n\n                        </td>\n                    </tr>\n                    <tr id="chart_enable_indicator" style="display: none;">\n                        <td class="chart_str_indicator">技术指标</td>\n                        <td>\n                            <ul>\n                                <li><a name="on" class="chart_str_on selected">开启</a></li>\n                                <li><a name="off" class="chart_str_off">关闭</a></li>\n                            </ul>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>\n                            <ul>\n                                <li>\n                                    <a id="chart_btn_parameter_settings" class="chart_str_indicator_parameters">指标参数设置</a>\n                                </li>\n                            </ul>\n                        </td>\n                    </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n\n        <div class="chart_dropdown" id="chart_language_setting_div" style="padding-left: 5px;">\n            <div class="chart_dropdown_t">\n                <a class="chart_language_setting">语言(LANG)</a>\n            </div>\n            <div class="chart_dropdown_data" style="padding-top: 15px; margin-left: -12px;">\n                <ul>\n                    <li style="height: 25px;">\n                        <a name="zh-cn" class="selected">简体中文(zh-CN)</a>\n                    </li>\n                    <li style="height: 25px;">\n                        <a name="en-us">English(en-US)</a>\n                    </li>\n                    <li style="height: 25px;">\n                        <a name="zh-tw">繁體中文(zh-HK)</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        <div id="chart_updated_time">\n            <div id="sizeIcon" class="chart_BoxSize"></div>\n\n        </div>\n    </div>\n               \x3c!-- ToolPanel --\x3e\n    <div id="chart_toolpanel">\n        <div class="chart_toolpanel_separator"></div>\n\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_Cursor" name="Cursor"></div>\n            <div class="chart_toolpanel_tip chart_str_cursor">\n                光标\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_CrossCursor" name="CrossCursor"></div>\n            <div class="chart_toolpanel_tip chart_str_cross_cursor">\n                十字光标\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_SegLine" name="SegLine"></div>\n            <div class="chart_toolpanel_tip chart_str_seg_line">\n                线段\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_StraightLine" name="StraightLine"></div>\n            <div class="chart_toolpanel_tip chart_str_straight_line">\n                直线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_RayLine" name="RayLine"></div>\n            <div class="chart_toolpanel_tip chart_str_ray_line">\n                射线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_ArrowLine" name="ArrowLine"></div>\n            <div class="chart_toolpanel_tip chart_str_arrow_line">\n                箭头\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_HoriSegLine" name="HoriSegLine"></div>\n            <div class="chart_toolpanel_tip chart_str_horz_seg_line">\n                水平线段\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_HoriStraightLine" name="HoriStraightLine"></div>\n            <div class="chart_toolpanel_tip chart_str_horz_straight_line">\n                水平直线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_HoriRayLine" name="HoriRayLine"></div>\n            <div class="chart_toolpanel_tip chart_str_horz_ray_line">\n                水平射线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_VertiStraightLine" name="VertiStraightLine"></div>\n            <div class="chart_toolpanel_tip chart_str_vert_straight_line">\n                垂直直线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_PriceLine" name="PriceLine"></div>\n            <div class="chart_toolpanel_tip chart_str_price_line">\n                价格线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_TriParallelLine" name="TriParallelLine"></div>\n            <div class="chart_toolpanel_tip chart_str_tri_parallel_line">\n                价格通道线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_BiParallelLine" name="BiParallelLine"></div>\n            <div class="chart_toolpanel_tip chart_str_bi_parallel_line">\n                平行直线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_BiParallelRayLine" name="BiParallelRayLine"></div>\n            <div class="chart_toolpanel_tip chart_str_bi_parallel_ray">\n                平行射线\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_DrawFibRetrace" name="DrawFibRetrace"></div>\n            <div class="chart_toolpanel_tip chart_str_fib_retrace">\n                斐波纳契回调\n            </div>\n        </div>\n        <div class="chart_toolpanel_button">\n            <div class="chart_toolpanel_icon" id="chart_DrawFibFans" name="DrawFibFans"></div>\n            <div class="chart_toolpanel_tip chart_str_fib_fans">\n                斐波纳契扇形\n            </div>\n        </div>\n        <div style="padding-left: 3px;padding-top: 10px;">\n            <button style="color: red;" id="clearCanvas" title="Clear All">X</button>\n        </div>\n    </div>\n    <div id="chart_canvasGroup" class="temp">\n        <canvas class="chart_canvas" id="chart_mainCanvas" style="cursor: default;"></canvas>\n        <canvas class="chart_canvas" id="chart_overlayCanvas" style="cursor: default;"></canvas>\n    </div>\n    <div id="chart_tabbar">\n        <ul>\n            <li><a name="MACD" class="">MACD</a></li>\n\n            <li><a name="KDJ" class="">KDJ</a></li>\n\n            <li><a name="StochRSI" class="">StochRSI</a></li>\n\n            <li><a name="RSI" class="">RSI</a></li>\n\n            <li><a name="DMI" class="">DMI</a></li>\n\n            <li><a name="OBV" class="">OBV</a></li>\n\n            <li><a name="BOLL" class="">BOLL</a></li>\n\n            <li><a name="SAR" class="">SAR</a></li>\n\n            <li><a name="DMA" class="">DMA</a></li>\n\n            <li><a name="TRIX" class="">TRIX</a></li>\n\n            <li><a name="BRAR" class="">BRAR</a></li>\n\n            <li><a name="VR" class="">VR</a></li>\n\n            <li><a name="EMV" class="">EMV</a></li>\n\n            <li><a name="WR" class="">WR</a></li>\n\n            <li><a name="ROC" class="">ROC</a></li>\n\n            <li><a name="MTM" class="">MTM</a></li>\n\n            <li><a name="PSY">PSY</a></li>\n\n        </ul>\n\n    </div>\n    <div id="chart_parameter_settings">\n        <h2 class="chart_str_indicator_parameters">指标参数设置</h2>\n        <table>\n            <tbody>\n            <tr>\n                <th>MA</th>\n                <td><input name="MA"><input name="MA"><input name="MA"><input name="MA"><br><input\n                        name="MA"><input\n                        name="MA">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n                <th>DMA</th>\n                <td><input name="DMA"><input name="DMA"><input name="DMA"></td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>EMA</th>\n                <td>\n                    <input name="EMA"><input name="EMA"><input name="EMA"><input name="EMA"><br>\n                    <input name="EMA"><input name="EMA">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>TRIX</th>\n                <td><input name="TRIX"><input name="TRIX"></td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n\n            <tr>\n                <th>VOLUME</th>\n                <td><input name="VOLUME"><input name="VOLUME"></td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>BRAR</th>\n                <td><input name="BRAR"></td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>MACD</th>\n                <td>\n                    <input name="MACD"><input name="MACD"><input name="MACD">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>VR</th>\n                <td><input name="VR"><input name="VR"></td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>KDJ</th>\n                <td>\n                    <input name="KDJ"><input name="KDJ"><input name="KDJ">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>EMV</th>\n                <td>\n                    <input name="EMV"><input name="EMV">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>StochRSI</th>\n                <td>\n                    <input name="StochRSI"><input name="StochRSI"><input name="StochRSI"><input name="StochRSI">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>WR</th>\n                <td>\n                    <input name="WR"><input name="WR">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>RSI</th>\n                <td>\n                    <input name="RSI"><input name="RSI"><input name="RSI">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>ROC</th>\n                <td>\n                    <input name="ROC"><input name="ROC">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>DMI</th>\n                <td>\n                    <input name="DMI"><input name="DMI">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>MTM</th>\n                <td>\n                    <input name="MTM"><input name="MTM">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>OBV</th>\n                <td>\n                    <input name="OBV">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n\n                <th>PSY</th>\n                <td>\n                    <input name="PSY"><input name="PSY">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            <tr>\n                <th>BOLL</th>\n                <td>\n                    <input name="BOLL">\n                </td>\n                <td>\n                    <button class="chart_str_default">默认值</button>\n                </td>\n            </tr>\n            </tbody>\n        </table>\n        <div id="close_settings"><a class="chart_str_close">关闭</a></div>\n    </div>\n    \x3c!-- Loading --\x3e\n    <div id="chart_loading" class="chart_str_loading">正在读取数据...</div>\n</div>\n<div style="display: none" id="chart_language_switch_tmp">\n    <span name="chart_str_period" zh_tw="週期" zh_cn="周期" en_us="TIME"></span>\n    <span name="chart_str_period_line" zh_tw="分時" zh_cn="分时" en_us="Line"></span>\n    <span name="chart_str_period_1m" zh_tw="1分鐘" zh_cn="1分钟" en_us="1m"></span>\n    <span name="chart_str_period_3m" zh_tw="3分鐘" zh_cn="3分钟" en_us="3m"></span>\n    <span name="chart_str_period_5m" zh_tw="5分鐘" zh_cn="5分钟" en_us="5m"></span>\n    <span name="chart_str_period_15m" zh_tw="15分鐘" zh_cn="15分钟" en_us="15m"></span>\n    <span name="chart_str_period_30m" zh_tw="30分鐘" zh_cn="30分钟" en_us="30m"></span>\n    <span name="chart_str_period_1h" zh_tw="1小時" zh_cn="1小时" en_us="1h"></span>\n    <span name="chart_str_period_2h" zh_tw="2小時" zh_cn="2小时" en_us="2h"></span>\n    <span name="chart_str_period_4h" zh_tw="4小時" zh_cn="4小时" en_us="4h"></span>\n    <span name="chart_str_period_6h" zh_tw="6小時" zh_cn="6小时" en_us="6h"></span>\n    <span name="chart_str_period_12h" zh_tw="12小時" zh_cn="12小时" en_us="12h"></span>\n    <span name="chart_str_period_1d" zh_tw="日線" zh_cn="日线" en_us="1d"></span>\n    <span name="chart_str_period_3d" zh_tw="3日" zh_cn="3日" en_us="3d"></span>\n    <span name="chart_str_period_1w" zh_tw="周線" zh_cn="周线" en_us="1w"></span>\n    <span name="chart_str_settings" zh_tw="更多" zh_cn="更多" en_us="MORE"></span>\n    <span name="chart_setting_main_indicator" zh_tw="均線設置" zh_cn="均线设置" en_us="Main Indicator"></span>\n    <span name="chart_setting_main_indicator_none" zh_tw="關閉均線" zh_cn="关闭均线" en_us="None"></span>\n    <span name="chart_setting_indicator_parameters" zh_tw="指標參數設置" zh_cn="指标参数设置" en_us="Indicator Parameters"></span>\n    <span name="chart_str_chart_style" zh_tw="主圖樣式" zh_cn="主图样式" en_us="Chart Style"></span>\n    <span name="chart_str_main_indicator" zh_tw="主指標" zh_cn="主指标" en_us="Main Indicator"></span>\n    <span name="chart_str_indicator" zh_tw="技術指標" zh_cn="技术指标" en_us="Indicator"></span>\n    <span name="chart_str_indicator_cap" zh_tw="技術指標" zh_cn="技术指标" en_us="INDICATOR"></span>\n    <span name="chart_str_tools" zh_tw="畫線工具" zh_cn="画线工具" en_us="Tools"></span>\n    <span name="chart_str_tools_cap" zh_tw="畫線工具" zh_cn="画线工具" en_us="TOOLS"></span>\n    <span name="chart_str_theme" zh_tw="主題選擇" zh_cn="主题选择" en_us="Theme"></span>\n    <span name="chart_str_theme_cap" zh_tw="主題選擇" zh_cn="主题选择" en_us="THEME"></span>\n    <span name="chart_language_setting" zh_tw="語言(LANG)" zh_cn="语言(LANG)" en_us="LANGUAGE"></span>\n    <span name="chart_exchanges_setting" zh_tw="更多市場" zh_cn="更多市场" en_us="MORE MARKETS"></span>\n    <span name="chart_othercoin_setting" zh_tw="其它市場" zh_cn="其它市场" en_us="OTHER MARKETS"></span>\n\n    <span name="chart_str_none" zh_tw="關閉" zh_cn="关闭" en_us="None"></span>\n    <span name="chart_str_theme_dark" zh_tw="深色主題" zh_cn="深色主题" en_us="Dark"></span>\n    <span name="chart_str_theme_light" zh_tw="淺色主題" zh_cn="浅色主题" en_us="Light"></span>\n    <span name="chart_str_on" zh_tw="開啟" zh_cn="开启" en_us="On"></span>\n    <span name="chart_str_off" zh_tw="關閉" zh_cn="关闭" en_us="Off"></span>\n    <span name="chart_str_close" zh_tw="關閉" zh_cn="关闭" en_us="CLOSE"></span>\n    <span name="chart_str_default" zh_tw="默認值" zh_cn="默认值" en_us="default"></span>\n    <span name="chart_str_loading" zh_tw="正在讀取數據..." zh_cn="正在读取数据..." en_us="Loading..."></span>\n    <span name="chart_str_indicator_parameters" zh_tw="指標參數設置" zh_cn="指标参数设置" en_us="Indicator Parameters"></span>\n    <span name="chart_str_cursor" zh_tw="光標" zh_cn="光标" en_us="Cursor"></span>\n    <span name="chart_str_cross_cursor" zh_tw="十字光標" zh_cn="十字光标" en_us="Cross Cursor"></span>\n    <span name="chart_str_seg_line" zh_tw="線段" zh_cn="线段" en_us="Trend Line"></span>\n    <span name="chart_str_straight_line" zh_tw="直線" zh_cn="直线" en_us="Extended"></span>\n    <span name="chart_str_ray_line" zh_tw="射線" zh_cn="射线" en_us="Ray"></span>\n    <span name="chart_str_arrow_line" zh_tw="箭頭" zh_cn="箭头" en_us="Arrow"></span>\n    <span name="chart_str_horz_seg_line" zh_tw="水平線段" zh_cn="水平线段" en_us="Horizontal Line"></span>\n    <span name="chart_str_horz_straight_line" zh_tw="水平直線" zh_cn="水平直线" en_us="Horizontal Extended"></span>\n    <span name="chart_str_horz_ray_line" zh_tw="水平射線" zh_cn="水平射线" en_us="Horizontal Ray"></span>\n    <span name="chart_str_vert_straight_line" zh_tw="垂直直線" zh_cn="垂直直线" en_us="Vertical Extended"></span>\n    <span name="chart_str_price_line" zh_tw="價格線" zh_cn="价格线" en_us="Price Line"></span>\n    <span name="chart_str_tri_parallel_line" zh_tw="價格通道線" zh_cn="价格通道线" en_us="Parallel Channel"></span>\n    <span name="chart_str_bi_parallel_line" zh_tw="平行直線" zh_cn="平行直线" en_us="Parallel Lines"></span>\n    <span name="chart_str_bi_parallel_ray" zh_tw="平行射線" zh_cn="平行射线" en_us="Parallel Rays"></span>\n    <span name="chart_str_fib_retrace" zh_tw="斐波納契回調" zh_cn="斐波纳契回调" en_us="Fibonacci Retracements"></span>\n    <span name="chart_str_fib_fans" zh_tw="斐波納契扇形" zh_cn="斐波纳契扇形" en_us="Fibonacci Fans"></span>\n    <span name="chart_str_updated" zh_tw="更新於" zh_cn="更新于" en_us="Updated"></span>\n    <span name="chart_str_ago" zh_tw="前" zh_cn="前" en_us="ago"></span>\n</div>\n'}])});